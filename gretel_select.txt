SELECT salesperson_id, name, SUM(volume) as total_volume FROM timber_sales JOIN salesperson ON timber_sales.salesperson_id = salesperson.salesperson_id GROUP BY salesperson_id, name ORDER BY total_volume DESC;
SELECT equipment_type, SUM(maintenance_frequency) AS total_maintenance_frequency FROM equipment_maintenance GROUP BY equipment_type;
SELECT COUNT(*) FROM marine_species WHERE location = 'Southern Ocean';
SELECT trader_id, stock, SUM(price * quantity) as total_trade_value, AVG(price) as avg_price FROM trade_history GROUP BY trader_id, stock;
SELECT type, cost FROM (SELECT type, cost, ROW_NUMBER() OVER (ORDER BY cost DESC) as rn FROM upgrades) sub WHERE rn = 1;
SELECT SUM(spending) FROM defense.eu_humanitarian_assistance WHERE year BETWEEN 2019 AND 2021;
SELECT SpeciesName, AVG(WaterTemp) as AvgTemp FROM SpeciesWaterTemp INNER JOIN FishSpecies ON SpeciesWaterTemp.SpeciesID = FishSpecies.SpeciesID WHERE MONTH(Date) = 2 GROUP BY SpeciesName;
SELECT SUM(fare) FROM bus_routes WHERE route_name = 'Green Line';
SELECT AVG(Property_Size) FROM Inclusive_Housing WHERE Inclusive = 'Yes';
SELECT d.name, AVG(f.income) FROM farmers_india f JOIN districts_india d ON f.district_id = d.id GROUP BY d.name;
SELECT AVG(temperature) FROM (SELECT temperature FROM Ocean WHERE region = 'Pacific' GROUP BY temperature, YEAR(STR_TO_DATE(region, '%Y'))) AS PacificAverage;
SELECT region, MAX(sustainability_metrics.carbon_footprint) as max_carbon_footprint, MAX(sustainability_metrics.water_usage) as max_water_usage, MAX(sustainability_metrics.waste_generation) as max_waste_generation FROM sustainability_metrics JOIN products ON sustainability_metrics.product_id = products.product_id GROUP BY region;
SELECT animal_group, conservation_status, year, COUNT(*) FROM combined GROUP BY animal_group, conservation_status, year;
SELECT base_name, base_type FROM Armed_Forces WHERE base_location = 'California';
SELECT a.name, SUM(av.valuation) AS total_valuation FROM artist a JOIN artists_valuation av ON a.id = av.artist_id GROUP BY a.id, a.name;
SELECT s.name FROM startups s JOIN funding f ON s.id = f.startup_id WHERE s.domain = 'Biosensors' AND f.purpose = 'Biosensor Development';
SELECT SUM(Amount) AS TotalAssistance, Country FROM HumanitarianAssistance WHERE Organization NOT IN ('Government', 'Military') AND Year BETWEEN 2016 AND 2020 GROUP BY Country;
SELECT incident, status FROM incident_responses WHERE status != 'In Progress' GROUP BY incident, status;
SELECT YEAR(start_date) AS year, MAX(COUNT(*)) AS projects_count FROM genetic.projects GROUP BY year;
SELECT YEAR(start_date) AS year, MONTH(start_date) AS month, COUNT(*) AS projects FROM project_timeline WHERE end_date IS NOT NULL GROUP BY year, month;
SELECT AVG(hourlyRate * hoursWorked * 5) AS AverageLaborCost FROM LaborStatistics;
SELECT org_name, num_projects FROM food_justice_orgs WHERE country = 'Africa';
SELECT name, species FROM animals WHERE weight > 500;
SELECT hotel_name, q1_2022_views FROM virtual_tour_stats WHERE region = 'APAC' ORDER BY q1_2022_views DESC LIMIT 5;
SELECT policy FROM PolicyAnalysis GROUP BY policy HAVING COUNT(DISTINCT department) = (SELECT COUNT(DISTINCT department) FROM PolicyAnalysis);
SELECT COUNT(*) FROM companies WHERE city='San Francisco' AND state='CA' AND founder_gender='female';
SELECT SUM(value) FROM socially_responsible_loans WHERE client_gender = 'female' AND date BETWEEN '2021-07-01' AND '2021-12-31';
SELECT country_of_origin, MAX(avg_distance) FROM satellites GROUP BY country_of_origin;
SELECT SUM(data_usage) FROM mobile_usage WHERE city = 'Toronto' AND year = 2022;
SELECT max_cargo_weight FROM vessels WHERE name = 'VesselC';
SELECT worker_id, MIN(score) FROM worker_scores;
SELECT * FROM defense_diplomacy WHERE participant_country IN ('China', 'India');
SELECT SUM(personnel) FROM us_military_personnel WHERE year IN (2018, 2019, 2020);
SELECT name, age FROM prison ORDER BY age LIMIT 1;
SELECT AVG(stars) FROM hotel_ratings WHERE country IN ('Japan', 'South Korea');
SELECT language, DATE_TRUNC('week', publish_date) as week, SUM(word_count) as total_word_count FROM Articles GROUP BY language, week ORDER BY week;
SELECT v.county, AVG(p.age) as avg_age FROM vaccinations v INNER JOIN patients p ON v.patient_id = p.patient_id WHERE vaccine = 'Flu' AND county = 'California' GROUP BY v.county;
SELECT make, model, MAX(horsepower) FROM geneva_motor_show WHERE year = 2021;
SELECT category, start_year, COUNT(*), SUM(budget) FROM economic_diversification WHERE start_year >= 2019 GROUP BY category, start_year;
SELECT Model FROM VehicleModels WHERE SafetyRating > 4.5;
SELECT COUNT(*) FROM space_missions WHERE leader IN (SELECT name FROM astronauts WHERE gender = 'Female');
SELECT AVG(response_time) FROM boston_emergency_response WHERE incident_type = 'Fire';
SELECT (COUNT(*) * 100.0 / (SELECT COUNT(*) FROM products)) as percentage FROM products WHERE is_recycled = TRUE;
SELECT CoOwners.CoOwnerID, Properties.City FROM CoOwners INNER JOIN Properties ON CoOwners.PropertyID = Properties.PropertyID WHERE Properties.City = 'New York City' AND Properties.Accessibility = 'No';
SELECT SUM(revenue) FROM BrandRevenue WHERE circular_model = TRUE AND year = 2020;
SELECT vehicle_name, safety_rating FROM (SELECT vehicle_name, safety_rating, RANK() OVER (ORDER BY safety_rating DESC) as safety_rank FROM auto_show WHERE vehicle_name LIKE '%Autonomous%') AS auton_ranks WHERE safety_rank = 1;
SELECT AVG(I.InspectionScore) as AvgInspectionScore FROM Restaurants R INNER JOIN Inspections I ON R.RestaurantID = I.RestaurantID WHERE R.Region = 'Westwood';
SELECT State, COUNT(*) FROM Hospitals GROUP BY State;
SELECT a.name, h.name FROM Animals a INNER JOIN AnimalEducation ae ON a.id = ae.animal_id INNER JOIN EducationPrograms e ON ae.program_id = e.id INNER JOIN Coordinators c ON e.coordinator_id = c.id INNER JOIN Habitat h ON a.habitat_id = h.id WHERE c.region = 'Americas';
SELECT project_name, risk_level FROM DefenseProjects WHERE start_date >= '2019-01-01' AND start_date <= '2019-12-31' AND risk_level IS NOT NULL;
SELECT country, SUM(amount) as total_textile_waste FROM textile_waste WHERE year = 2021 GROUP BY country;
SELECT COUNT(*) FROM maintenance_requests WHERE date BETWEEN '2020-01-01' AND '2020-01-31' AND type = 'equipment';
SELECT Region, SUM(AmountDonated) as TotalDonated FROM Donors GROUP BY Region;
SELECT name FROM satellites WHERE launch_date < '2010-01-01';
SELECT COUNT(DISTINCT user_id) FROM user_activity WHERE EXTRACT(MONTH FROM activity_date) = 1;
SELECT AVG(Age) FROM Players JOIN VRUsers ON Players.PlayerID = VRUsers.PlayerID WHERE Country = 'France';
SELECT SUM(animal_populations.population) FROM conservation_programs INNER JOIN animal_populations ON conservation_programs.id = animal_populations.program_id WHERE conservation_programs.location = 'USA' OR conservation_programs.location = 'Canada';
SELECT COUNT(DISTINCT species) FROM trees JOIN biomes ON trees.biome_id = biomes.biome_id WHERE trees.dbh > 50.0 AND biomes.name = 'Temperate Rainforest';
SELECT SUM(quantity) FROM cotton_source WHERE country = 'USA' AND brand IN (SELECT brand FROM fair_labor WHERE commitment = 'yes');
SELECT title, genre FROM (SELECT title, genre, studio, rating, ROW_NUMBER() OVER (PARTITION BY studio ORDER BY rating DESC) as rank FROM movies WHERE studio LIKE '%Italy%') subquery WHERE rank <= 3 ORDER BY rating DESC;
SELECT name, growth_rate FROM (SELECT name, growth_rate, ROW_NUMBER() OVER (ORDER BY growth_rate DESC) rn FROM marine_species) t WHERE rn <= 3;
SELECT MIN(energy_production) FROM wind_turbines WHERE installation_year > 2016 AND country = 'China';
SELECT SUM(DonationAmount) FROM Donors WHERE Age >= 40;
SELECT COUNT(*) FROM recalls WHERE product LIKE 'Organic Chicken%' AND date BETWEEN '2020-01-01' AND '2022-12-31';
SELECT SUM(Personnel) FROM MilitaryCyberOps WHERE Region = 'Asia';
SELECT resource_type, SUM(quantity) as total_quantity, extraction_date FROM resource_extraction WHERE resource_type IN ('gold', 'silver') GROUP BY resource_type, extraction_date;
SELECT name, height, num_stories FROM Buildings WHERE city = 'New York' AND num_stories > 50;
SELECT COUNT(*) FROM factories WHERE sector = 'renewable energy' HAVING employee_count > 50;
SELECT COUNT(*) FROM sports_events WHERE year = 2019 AND tickets_sold > 50000;
SELECT SUM(fr.funding_amount) FROM companies c INNER JOIN funding_rounds fr ON c.company_id = fr.company_id WHERE c.founder_gender = 'Female';
SELECT name FROM SafetyOrgs WHERE country IN ('UK', 'France');
SELECT COUNT(*) FROM properties WHERE city = 'New York' AND listing_price > 800000 AND wheelchair_accessible = true;
SELECT MIN(serving_size) FROM MealTypes WHERE meal_type = 'Gluten-free' AND store_type = 'Convenience Store';
SELECT SustainablePractices.PracticeName FROM SustainablePractices WHERE SustainablePractices.Department = 'Structural Engineering' AND SustainablePractices.Cost > 10000.00;
SELECT AVG(fare) FROM red_line WHERE route_id = 102 AND EXTRACT(DAY FROM date) BETWEEN 2 AND 6 AND EXTRACT(MONTH FROM date) = 2;
SELECT AVG(production_budget) FROM movies WHERE genre IN ('Action', 'Drama') AND release_year BETWEEN 2000 AND 2010;
SELECT MAX(capacity) FROM Production WHERE location = 'Eastern';
SELECT f.field_id, f.field_name, fp.production_rate FROM fields f LEFT JOIN fields_production fp ON f.field_id = fp.field_id;
SELECT name FROM menu_items WHERE restaurant_id = 3 AND available_time < '17:00:00' GROUP BY name HAVING SUM(available) = 0;
SELECT DISTINCT REE FROM production WHERE country = 'Australia' AND year = 2020;
SELECT CulturalCompetencyTraining.TrainingID, CulturalCompetencyTraining.MHW_ID, CulturalCompetencyTraining.TrainingName, CulturalCompetencyTraining.TrainingDate, CommunityHealthWorker.Name FROM CulturalCompetencyTraining INNER JOIN CommunityHealthWorker ON CulturalCompetencyTraining.MHW_ID = CommunityHealthWorker.WorkerID;
SELECT state, (COUNT(*)::FLOAT / (SELECT COUNT(*) FROM contract_states)) * 100 AS percentage FROM contract_states GROUP BY state;
SELECT AVG(speed) FROM vehicle_speed WHERE type = 'electric' AND city IN ('New York', 'London');
SELECT a.name, COUNT(*) as artworks_count FROM Artists a JOIN Artworks aw ON a.id = aw.artist_id GROUP BY a.name ORDER BY artworks_count DESC LIMIT 10;
SELECT SUM(water_consumption) FROM industrial_customers WHERE location IN ('Texas', 'Oklahoma');
SELECT Program, Budget FROM Programs WHERE Type = 'Mobility';
SELECT mission_name FROM SpaceMissions WHERE astronaut_nationality IN ('US', 'Canada') GROUP BY mission_name HAVING COUNT(DISTINCT astronaut_nationality) = 2;
SELECT AVG(avg_depth) FROM marine_protected_areas;
SELECT type, SUM(quantity) as total_production FROM production WHERE region = 'Southern' GROUP BY type;
SELECT SUM(num_vehicles) FROM electric_vehicles WHERE country IN ('China', 'Japan');
SELECT state, MAX(cnt) FROM (SELECT state, COUNT(*) AS cnt FROM green_buildings_us WHERE construction_year < 2015 GROUP BY state) AS subquery;
SELECT CityName, InitiativeName, StartDate FROM SmartCities WHERE CityName = 'City G' AND StartDate > '2018-12-31';
SELECT cuisine, MIN(cooking_time) as min_cooking_time, MAX(cooking_time) as max_cooking_time FROM Dishes WHERE cuisine = 'Indian' GROUP BY cuisine;
SELECT SUM(budget) FROM african_region_table;
SELECT num_owners, COUNT(*) as num_properties FROM co_ownership GROUP BY num_owners;
SELECT country, COUNT(*) AS launched_satellites FROM satellites GROUP BY country;
SELECT SUM(price) FROM quick_service.menu_items WHERE category = 'Vegan Burger' OR category = 'Fruit Bowl';
SELECT region, adoption_percentage FROM ai_adoption WHERE adoption_date = '2022-01-01';
SELECT waste_quantity FROM waste_generation_city_v2 WHERE sector = 'residential' AND city = 'New York City';
SELECT DISTINCT Country FROM Humanitarian_Assistance WHERE Quarter = 3 AND Year = 2022;
SELECT SUM(capacity) FROM projects WHERE implementation_date >= DATEADD(year, -1, GETDATE());
SELECT AVG(attendance) FROM CulturalEvents WHERE city = 'New York';
SELECT ArtistID, Age, Gender, Nationality FROM (SELECT ArtistID, Age, Gender, Nationality, ROW_NUMBER() OVER (ORDER BY Age DESC) AS Rank FROM ArtistsDemographics) AS Subquery WHERE Rank <= 2;
SELECT SUM(sale_price) FROM EquipmentSales WHERE country = 'Canada';
SELECT COUNT(*) FROM IntelligenceSatellites WHERE Operational = true;
SELECT organizations.org_name, volunteers.volunteer_name, SUM(volunteers.hours_contributed) as total_hours FROM volunteers INNER JOIN organizations ON volunteers.org_id = organizations.org_id GROUP BY organizations.org_name, volunteers.volunteer_name;
SELECT MAX(production_rate) FROM wells WHERE region = 'Gulf of Mexico';
SELECT ocean_floor_mapping.location, MAX(ocean_floor_mapping.depth), COUNT(marine_life_research_stations.id) FROM ocean_floor_mapping INNER JOIN marine_life_research_stations ON ocean_floor_mapping.location = marine_life_research_stations.location GROUP BY ocean_floor_mapping.location;
SELECT h.name habitat, SUM(t.biomass) total_biomass FROM trees t JOIN tree_habitat_associations tha ON t.id = tha.tree_id JOIN wildlife_habitats h ON tha.habitat_id = h.id JOIN tree_types tt ON t.tree_type_id = tt.id WHERE tt.name = 'Deciduous' GROUP BY h.name;
SELECT material, SUM(quantity) as total_quantity FROM fair_trade_suppliers WHERE name IN ('Fair Trade Farms', 'Green Earth') GROUP BY material ORDER BY total_quantity DESC LIMIT 2;
SELECT MIN(SustainabilityRating) FROM ProduceSupplier WHERE UnitsPerWeek > 600;
SELECT SUM(revenue) FROM Restaurants WHERE seating_capacity > 100;
SELECT gender, COUNT(*) FROM vaccinations GROUP BY gender;
SELECT menu_item FROM menu_items WHERE location = 'Location1' INTERSECT SELECT menu_item FROM menu_items WHERE location = 'Location2' EXCEPT SELECT menu_item FROM menu_items WHERE location = 'Location3';
SELECT p.product_name FROM purchase p JOIN product pr ON p.product_id = pr.product_id WHERE pr.is_cruelty_free = true AND p.purchase_date >= '2022-02-01' AND p.region = 'US';
SELECT MAX(founding_date) FROM startups WHERE industry = 'Energy' AND founder_veteran = TRUE;
SELECT sales_channel, AVG(price) FROM sales GROUP BY sales_channel;
SELECT AVG(grant_avg) FROM (SELECT department, AVG(amount) AS grant_avg FROM research_grants GROUP BY department HAVING COUNT(*) >= 3) AS subquery;
SELECT COUNT(*) FROM company WHERE founder_count = 1 AND industry = 'biotech';
SELECT region, AVG(age) as avg_age FROM healthcare_workers GROUP BY region;
SELECT project_name FROM Project_Timelines WHERE is_sustainable = TRUE AND timeline > 120;
SELECT EXTRACT(MONTH FROM date) AS month, AVG(temperature) AS avg_temperature FROM ocean_temperature WHERE location = 'Pacific Ocean' GROUP BY month;
SELECT donations.donation_id, donations.donation_amount, donations.donation_date, campaigns.campaign_name FROM donations INNER JOIN campaigns ON donations.donation_date BETWEEN campaigns.start_date AND campaigns.end_date;
SELECT MIN(rating) FROM Safety_Testing WHERE make = 'Italian';
SELECT r.name FROM Researchers r JOIN ClimateResearch cr ON r.id = cr.researcher_id WHERE cr.location = 'Antarctic';
SELECT COUNT(*) FROM patients WHERE condition = 'depression' AND therapy_sessions > 0;
SELECT SUM(mass) FROM spacecraft WHERE manufacturer = 'SpaceX';
SELECT Name FROM HeritageSites WHERE Category = 'Natural' AND Status = 'Vulnerable' AND Region = 'Africa';
SELECT AVG(acidity) FROM ocean_acidification;
SELECT SUM(number_thousands) FROM electric_vehicles WHERE country = 'China' AND year = 2021;
SELECT C.Outcome, SUM(B.Amount) as TotalBilling FROM Cases C JOIN Billing B ON C.BillingID = B.BillingID GROUP BY C.Outcome;
SELECT COUNT(*) * 100.0 / (SELECT COUNT(*) FROM social_good_education) AS percentage FROM social_good_education WHERE project_education = 'yes';
SELECT COUNT(*) FROM financial_capability WHERE financially_capable = TRUE AND country LIKE 'Asia%';
SELECT category, SUM(sales) FROM menu GROUP BY category;
SELECT state, COUNT(*) FROM community_health_centers GROUP BY state;
SELECT name, total_citations FROM biosensor.patents WHERE location = 'UK' GROUP BY name ORDER BY total_citations DESC LIMIT 3;
SELECT category, SUM(count) OVER (PARTITION BY category) FROM crimes;
SELECT COUNT(*) as recall_count FROM recall_reports WHERE report LIKE '%recalled%';
SELECT contributor FROM Digital_Divide WHERE year = 2020 ORDER BY impact DESC LIMIT 2;
SELECT correlation(fish_stock.fish_population, acidification_data.acidification_level) FROM fish_stock INNER JOIN acidification_data ON fish_stock.date = acidification_data.date AND fish_stock.ocean = acidification_data.ocean WHERE fish_stock.ocean = 'Atlantic';
SELECT manufacturer_id, COUNT(*) FROM aircraft GROUP BY manufacturer_id;
SELECT SUM(sale_price) FROM Sales WHERE is_sustainable = true AND sale_date >= DATEADD(year, -1, GETDATE());
SELECT Gender, SUM(DonationAmount) FROM Donors GROUP BY Gender;
SELECT SUM(CASE WHEN is_commercial = TRUE AND is_compliant = FALSE THEN 1 ELSE 0 END) FROM indian_ocean_fishingvessels;
SELECT AVG(ArtifactAge) FROM ArtifactAnalysis;
SELECT region, COUNT(DISTINCT condition_id) FROM treatments WHERE medication = TRUE GROUP BY region;
SELECT Year, Attendees FROM AutoShows WHERE Country = 'US';
SELECT project_type, year, AVG(cost) as avg_cost FROM projects_pakistan WHERE province = 'Punjab' GROUP BY project_type, year;
SELECT COUNT(*) FROM MusicEvents;
SELECT COUNT(*) FROM Donors INNER JOIN CountryIncome ON Donors.Country = CountryIncome.Country WHERE CountryIncome.IncomeLevel = 'Low-income';
SELECT COUNT(*) AS total_initiatives, SUM(leader = 'Greenpeace' OR leader = 'World Wildlife Fund') AS ngo_led_initiatives FROM marine_conservation WHERE ocean = 'Atlantic Ocean';
SELECT Company.name, SUM(Investment.investment_amount) as total_investment FROM Company JOIN Investment ON Company.id = Investment.company_id WHERE YEAR(Investment.investment_date) = 2019 GROUP BY Company.name;
SELECT worker_id, COUNT(DISTINCT metric_id) FROM health_equity_metrics WHERE state = 'TX' GROUP BY worker_id;
SELECT player_id, AVG(kills/deaths) as K_D_ratio FROM players INNER JOIN games ON players.id = games.player_id WHERE country = 'Japan' GROUP BY player_id;
SELECT AVG(word_count) OVER (PARTITION BY EXTRACT(YEAR_QUARTER FROM publish_date)) AS avg_word_count FROM articles WHERE category = 'social_justice' AND location = 'USA' AND YEAR(publish_date) BETWEEN 2021 AND 2022;
SELECT COUNT(*) FROM RecyclingCenters WHERE area = 'Urban' AND capacity > 5000;
SELECT COUNT(*) FROM main_belt_asteroids;
SELECT A.type, SUM(TT.trips) as Total_Trips FROM Transportation_Trips TT JOIN Areas A ON TT.area_id = A.id WHERE TT.year = 2020 GROUP BY A.type;
SELECT supplier, SUM(num_workers) FROM labor_practices GROUP BY supplier;
SELECT country, COUNT(*) FROM deep_sea_expeditions WHERE ocean IN ('Atlantic', 'Indian') GROUP BY country;
SELECT AVG(Rainfall) as AvgAnnualRainfall, SUM(MaintenanceCost) as TotalAnnualMaintenanceCost  FROM BridgeRainfall  WHERE Region = 'Northwest' AND Year >= YEAR(CURRENT_DATE) - 5 GROUP BY Year;
SELECT Council_ID FROM Policy_Feedback WHERE Policy_Area = 'Housing';
SELECT community_education_programs.program_name, animal_populations.animal_type, animal_populations.population FROM community_education_programs INNER JOIN animal_populations ON community_education_programs.id = animal_populations.program_id WHERE community_education_programs.location = 'Africa';
SELECT AVG(score) FROM (SELECT score FROM game_scores WHERE user_id = 7 ORDER BY score LIMIT 2 OFFSET 2) AS median_scores;
SELECT machines.machine_id, machines.type, machines.schedule FROM machines INNER JOIN factories ON machines.factory_id = factories.factory_id WHERE factories.practices = 'unethical';
SELECT COUNT(*) FROM sessions WHERE duration > 60 AND region = 'West';
SELECT COUNT(*) FROM FairTradeCertification WHERE certification = 'Fair Trade';
SELECT AVG(incident_count) FROM incidents_by_month WHERE incident_region = 'Africa';
SELECT COUNT(*) FROM projects WHERE budget < 10000000.00;
SELECT Cause, AVG(Amount) as AverageDonation FROM DonationsByCause GROUP BY Cause ORDER BY AverageDonation DESC;
SELECT person.name, SUM(property.sqft) FROM person INNER JOIN property ON person.id = property.owner_id GROUP BY person.name;
SELECT MAX(CountPerDept) FROM (SELECT Department, COUNT(*) AS CountPerDept FROM Employees GROUP BY Department) AS Subquery;
SELECT 'Africa' AS continent, COUNT(DISTINCT p.player_id) AS num_players FROM players p JOIN vr_tech v ON p.player_id = v.player_id WHERE p.region = 'Africa' UNION ALL SELECT 'South America' AS continent, COUNT(DISTINCT p.player_id) AS num_players FROM players p JOIN vr_tech v ON p.player_id = v.player_id WHERE p.region = 'South America';
SELECT Vehicle FROM AutonomousDriving WHERE Test = 'High-Speed Autopilot' AND Result = 'Passed';
SELECT country, COUNT(DISTINCT student_id) FROM students_enrollment WHERE enrollment_date >= DATEADD(year, -1, GETDATE()) GROUP BY country;
SELECT COUNT(*) FROM Artworks UNION ALL SELECT COUNT(*) FROM Exhibitions;
SELECT SUM(energy_stored) FROM battery_storage WHERE country IN ('Japan', 'South Korea') AND year = 2020;
SELECT Name FROM ArtPieces WHERE YearAdded > 2000;
SELECT SUM(count) FROM whale_sharks WHERE species = 'Rhincodon typus' AND region = 'Indo-Pacific';
SELECT SUM(quantity) FROM YtterbiumProduction WHERE country = 'Russia' AND year = 2016;
SELECT SUM(donation_amount) FROM donors WHERE donor_name NOT IN (SELECT donor_name FROM donors WHERE donation_date < '2021-01-01' OR donation_date > '2021-12-31') AND donation_date BETWEEN '2021-01-01' AND '2021-12-31' AND donor_country = 'USA';
SELECT SUM(workout_duration) FROM Workout WHERE country = 'Australia';
SELECT cities.name, cities.population FROM cities WHERE cities.continent = 'Africa' AND cities.population > 5000000;
SELECT AVG(rating) FROM Hotels WHERE city = 'Paris';
SELECT R.Cuisine, SUM(M.Sales) as TotalRevenue, COUNT(DISTINCT R.RestaurantID) as RestaurantCount FROM Restaurants R INNER JOIN MenuItems M ON R.RestaurantID = M.RestaurantID GROUP BY R.Cuisine;
SELECT SUM(total_funding) FROM Funding WHERE funding_source = 'California Arts Council' AND region = 'California' AND YEAR(event_date) = 2022
SELECT ProgramName FROM EducationPrograms WHERE ProgramName NOT IN (SELECT ProgramName FROM LawPrograms);
SELECT L.language, CP.practice FROM Languages L INNER JOIN CulturalPractices CP ON L.id = CP.language_id WHERE L.status = 'At Risk';
SELECT SUM(billing_amount) FROM family_cases WHERE case_type = 'family';
SELECT r.preferred_category, COUNT(*) FROM readers r JOIN readership re ON r.id = re.reader_id WHERE re.gender = 'Male' AND re.country = 'UK' GROUP BY r.preferred_category ORDER BY COUNT(*) DESC LIMIT 5
SELECT SUM(horsepower) FROM green_vehicles WHERE make = 'Tesla' OR make = 'Rivian';
SELECT country, COUNT(DISTINCT mobile_customers_global.customer_id) + COUNT(DISTINCT broadband_customers_global.customer_id) FROM mobile_customers_global FULL OUTER JOIN broadband_customers_global ON mobile_customers_global.country = broadband_customers_global.country GROUP BY country;
SELECT product_subcategory, COUNT(*) FROM makeup_products GROUP BY product_subcategory;
SELECT artist_id, name, creation_date FROM (SELECT artist_id, name, creation_date, ROW_NUMBER() OVER (PARTITION BY artist_id ORDER BY creation_date ASC) as rn FROM Artworks) t WHERE rn <= 5;
SELECT threat_actors.type, COUNT(*) as incident_count FROM threat_actors JOIN incidents ON threat_actors.date = incidents.date WHERE threat_actors.location = 'North America' AND incidents.date >= (CURRENT_DATE - INTERVAL '30' DAY) GROUP BY threat_actors.type;
SELECT SUM(Budget) FROM Programs WHERE FocusArea = 'Disaster Relief' AND StartDate <= GETDATE() AND EndDate >= DATEADD(year, -2, GETDATE());
SELECT state, SUM(total_data_usage) FROM (SELECT state, total_data_usage FROM state_usage WHERE state IN (SELECT state FROM state_usage WHERE total_data_usage = (SELECT MIN(total_data_usage) FROM state_usage) ORDER BY RAND() LIMIT 2) ORDER BY total_data_usage DESC) subquery GROUP BY state;
SELECT Title, MAX(TicketSales) FROM TicketSales WHERE Genre = 'Rock' AND Country = 'Asia' AND Year = 2019;
SELECT SUM(investment) FROM economic_diversification WHERE country = 'Nigeria' AND year = 2019;
SELECT AVG(patients.age) FROM patients JOIN recovery_program ON patients.patient_id = recovery_program.patient_id WHERE patients.condition = 'Depression' AND patients.country = 'Canada';
SELECT DISTINCT Type FROM Hospitals WHERE Type != 'Mobile Clinic';
SELECT MAX(billing_rate) FROM attorneys WHERE department = 'corporate';
SELECT dam_type, reservoir_capacity, MAX(water_flow_rate) FROM Dams WHERE state = 'CA' GROUP BY dam_type, reservoir_capacity;
SELECT COUNT(*) FROM Satellite_Launches WHERE Country = 'Japan';
SELECT c.city, AVG(claim_amount) FROM claims c JOIN policies p ON c.policy_id = p.policy_id WHERE policy_type = 'health' GROUP BY c.city ORDER BY AVG(claim_amount) DESC LIMIT 3;
SELECT MIN(salinity) FROM ocean_salinity WHERE location = 'Arctic Ocean';
SELECT MIN(ReverseLogisticsTransactions.TransactionDate) AS EarliestTransactionDate FROM ReverseLogisticsTransactions JOIN Vendors ON ReverseLogisticsTransactions.VendorID = Vendors.VendorID WHERE Vendors.VendorName = 'VendorW';
SELECT SUM(Funding_Received) FROM Agricultural_Projects WHERE Led_By = 'Women' AND Year = 2020 AND Location = 'Kenya';
SELECT MAX(Salary) FROM Employees WHERE VeteranStatus = 'Veteran';
SELECT COUNT(*) FROM sponsor_trials WHERE sponsor_name = 'CompanyZ' AND trial_year BETWEEN 2017 AND 2019;
SELECT Material, SUM(Quantity) as TotalQuantity FROM Materials WHERE Material NOT IN ('Organic Cotton', 'Recycled Polyester') GROUP BY Material ORDER BY TotalQuantity DESC;
SELECT vulnerability, COUNT(*) as count FROM vulnerabilities WHERE sector = 'finance' GROUP BY vulnerability ORDER BY count DESC LIMIT 5;
SELECT AVG(production_cost) FROM materials WHERE material_name IN ('Organic Cotton', 'Recycled Polyester', 'Hemp');
SELECT AVG(price) FROM eu_ets WHERE date BETWEEN '2020-01-01' AND '2020-12-31';
SELECT country1, country2, primary_objective, COUNT(*) as num_personnel FROM joint_operations GROUP BY country1, country2, primary_objective;
SELECT SUM(revenue) FROM Organic_Cosmetics WHERE category = 'Lipsticks';
SELECT name, completion_date FROM pollution_control_initiatives;
SELECT SUM(amount) FROM transactions WHERE country IN ('India', 'Brazil');
SELECT member_id, AVG(heart_rate) FROM wearable_metrics GROUP BY member_id;
SELECT Routes.id, Routes.region FROM Routes WHERE Routes.region = 'north' AND Routes.wheelchair_accessible = true;
SELECT city, SUM(installed_capacity) FROM renewable_energy_projects GROUP BY city;
SELECT artists.name, artists.nationality FROM artists INNER JOIN artwork_styles ON artists.id = (SELECT artist_id FROM artworks WHERE artwork_styles.id = artwork_id AND style = 'Cubism' LIMIT 1) WHERE artwork_styles.style = 'Cubism';
SELECT c.country, b.brand, COUNT(DISTINCT c.partner_id) AS partner_count FROM CircularSupplyChain c JOIN Brands b ON c.brand_id = b.id GROUP BY c.country, b.brand;
SELECT AVG(num_bikes) FROM bike_stations WHERE urban = 'Yes';
SELECT State, COUNT(*) as ComplaintCount FROM MentalHealthParity WHERE YEAR(FilingDate) = 2020 GROUP BY State;
SELECT * FROM transaction WHERE transaction_date = '2022-01-01' AND customer_id IN (SELECT id FROM customer WHERE address LIKE 'New York%');
SELECT region_id, AVG(dissolved_oxygen) FROM measurement GROUP BY region_id;
SELECT route_id, MIN(DATEDIFF('day', LAG(clean_date) OVER (PARTITION BY route_id ORDER BY clean_date), clean_date)) FROM buses GROUP BY route_id;
SELECT AVG(s.safety_score) AS avg_safety_score, AVG(l.members) AS avg_members FROM labor_unions l JOIN safety_records s ON l.id = s.union_id WHERE l.union_name LIKE 'C%';
SELECT SUM(price) as total_revenue FROM sales WHERE is_fair_trade = true AND YEAR(sale_date) >= 2019 AND location = 'Africa';
SELECT MAX(speed) FROM vessel_performance WHERE location = 'Mediterranean Sea' AND timestamp BETWEEN '2021-09-01' AND '2021-09-30';
SELECT AVG(Artworks.price) FROM Artworks INNER JOIN Exhibitions ON Artworks.artwork_id = Exhibitions.artwork_id WHERE Exhibitions.start_date BETWEEN '1900-01-01' AND '1999-12-31';
SELECT SUM(production_cost) FROM companies WHERE num_sustainable_materials > 5;
SELECT nationality, COUNT(*) AS missions_count FROM Astronauts GROUP BY nationality ORDER BY missions_count DESC LIMIT 3;
SELECT MAX(tons_produced) FROM SeafoodSouthAfricaKenya WHERE country IN ('South Africa', 'Kenya') AND year = 2020;
SELECT resource_id, MAX(rating) as highest_rating FROM open_pedagogy GROUP BY resource_id ORDER BY highest_rating DESC LIMIT 1;
SELECT DISTINCT department FROM Employees;
SELECT year, SUM(production) as total_production FROM crops_year GROUP BY year;
SELECT SUM(carbon_offset_tons) FROM CarbonOffsetInitiatives WHERE location = 'RegionC';
SELECT f.name FROM factories f LEFT JOIN workers w ON f.factory_id = w.factory_id WHERE w.program IS NULL;
SELECT country, MIN(employee_count), MAX(employee_count) FROM SupplyChainEmployees WHERE year = 2020 GROUP BY country;
SELECT COUNT(DISTINCT ports.port_code) as port_count FROM ports;
SELECT COUNT(*) FROM human_resources WHERE department = 'Engineering';
SELECT MIN(creation_year) FROM Artworks WHERE movement = 'Rococo';
SELECT member_id FROM member_details WHERE membership = 'Platinum';
SELECT SUM(donation_amount) FROM donors WHERE state = 'New York' AND donation_amount > 100;
SELECT AVG(offset_quantity) FROM carbon_offset_programs WHERE state = 'California' AND start_year >= 2015;
SELECT MIN(waste_generation_kg_per_capita) FROM WasteGeneration WHERE region = 'Africa';
SELECT dish_type, MAX(food_cost) FROM menu_items WHERE dish_type = 'Vegan';
SELECT age_group, AVG(price) as avg_price FROM tickets GROUP BY age_group;
SELECT practice, description FROM sustainable_practices;
SELECT category, (SUM(revenue) / (SELECT SUM(revenue) FROM category_revenue WHERE sale_date BETWEEN '2022-01-01' AND '2022-12-31')) * 100 FROM category_revenue WHERE sale_date BETWEEN '2022-01-01' AND '2022-12-31' GROUP BY category;
SELECT sensor_type FROM IoT_Sensors WHERE location IN ('India', 'Germany');
SELECT AVG(amount) FROM climate_finance WHERE country IN ('Brazil', 'Colombia', 'Peru', 'Argentina', 'Mexico') AND year = 2021 AND adaptation = true;
SELECT name FROM Aquaculture_farms WHERE country = 'Canada';
SELECT country, download_speed FROM network_infrastructure ORDER BY download_speed DESC LIMIT 3;
SELECT EXTRACT(QUARTER FROM registration_date) as quarter, COUNT(DISTINCT name) as volunteers_joined FROM volunteer_registration WHERE registration_date BETWEEN '2023-01-01' AND '2023-06-30' GROUP BY quarter HAVING quarter IN (1, 3);
SELECT SUM(length) FROM Videos WHERE content_creator_region = 'Southeast Asia';
SELECT SUM(Amount) FROM Budget WHERE Year = 2020 AND Category = 'Infrastructure';
SELECT country, SUM(posts) as total_posts FROM user GROUP BY country ORDER BY total_posts DESC LIMIT 3;
SELECT name, efficiency FROM wind_farms WHERE region = 'East' UNION SELECT name, efficiency FROM solar_farms WHERE region = 'East' HAVING efficiency > 0.3;
SELECT f.name, MAX(m.dissolved_oxygen) FROM Farm f JOIN Measurement m ON f.id = m.farm_id GROUP BY f.name;
SELECT SUM(game_sales.revenue) AS total_revenue, SUM(game_sales.quantity) AS num_games_sold FROM game_sales WHERE game_sales.genre = 'Adventure' AND game_sales.sale_date >= DATEADD(month, -3, GETDATE()) AND (game_sales.country = 'Australia' OR game_sales.country = 'New Zealand');
SELECT users.membership_type, AVG(workouts.duration) AS avg_duration FROM users JOIN workouts ON users.id = workouts.user_id WHERE users.state = 'NY' GROUP BY users.membership_type;
SELECT DISTINCT supplier_name FROM inventory INNER JOIN suppliers ON TRUE WHERE category = 'Fruits' AND is_organic IS NOT NULL;
SELECT capacity_cubic_meters FROM landfill_capacity WHERE state = 'New York' AND year = 2022;
SELECT Plant, SUM(Wastewater) FROM WastewaterTreatment WHERE Date = '2021-10-01' GROUP BY Plant HAVING SUM(Wastewater) > 1600;
SELECT SUM(production_budget) FROM MovieBudgets INNER JOIN Movies ON MovieBudgets.movie_id = Movies.movie_id WHERE release_date >= '2018-01-01' AND release_date < '2019-01-01' AND rating >= 8;
SELECT customers.name, customers.country FROM customers JOIN purchases ON customers.id = purchases.customer_id JOIN products ON purchases.product_id = products.id WHERE products.organic = TRUE GROUP BY customers.id ORDER BY SUM(purchases.quantity) DESC LIMIT 3;
SELECT COUNT(*) FROM fans WHERE gender = 'Male' AND age > 40;
SELECT experiment_name, temperature_delta FROM genetics.experiments WHERE temperature_delta > (SELECT AVG(temperature_delta) FROM genetics.experiments);
SELECT store_id, store_name, SUM(quantity_sold) as total_sold FROM Sales JOIN Stores ON Sales.store_id = Stores.store_id WHERE product_name = 'Eco-Friendly Denim Jacket' GROUP BY store_id, store_name ORDER BY total_sold DESC;
SELECT AVG(f.emissions) FROM factories f WHERE f.location = 'Texas';
SELECT rg.student_id, COUNT(DISTINCT rg.grant_id) AS num_grants, SUM(rg.amount) AS total_amount FROM research_grants rg GROUP BY rg.student_id ORDER BY total_amount DESC;
SELECT v.ID, v.Name, v.Type FROM Vessels v LEFT JOIN SafetyIncidents si ON v.ID = si.VesselID WHERE si.ID IS NULL;
SELECT AVG(provider_parity_score) as avg_parity_score FROM Providers p JOIN Areas a ON p.area_id = a.area_id WHERE a.area_type = 'urban';
SELECT economic_impact FROM local_impact_japan WHERE location = 'Tokyo' AND year = 2022;
SELECT 100.0 * COUNT(DISTINCT CASE WHEN outcomes.follow_up_date < patients.start_date + INTERVAL '6 month' AND outcomes.improvement THEN patients.id END) / COUNT(DISTINCT patients.id) AS percentage FROM patients JOIN treatments ON patients.id = treatments.patient_id JOIN outcomes ON treatments.id = outcomes.treatment_id WHERE patients.country = 'Japan' AND treatments.type = 'psychotherapy';
SELECT incident_type as event_type FROM emergency_incidents WHERE incident_type NOT IN ('Medical Emergency') UNION ALL SELECT report_type FROM crime_reports WHERE report_type NOT IN ('Theft');
SELECT AVG(num_staff) AS avg_rural_hospitals_per_province, COUNT(*) FILTER (WHERE num_staff > 20) AS provinces_with_more_than_20_hospitals FROM ( SELECT province, COUNT(*) AS num_staff FROM rural_hospitals GROUP BY province ) subquery;
SELECT r.route_name, SUM(f.fare_amount) as total_revenue FROM routes r JOIN fares f ON r.route_id = f.route_id GROUP BY r.route_name;
SELECT AVG(budget) FROM healthcare_system WHERE type = 'Public';
SELECT MAX(otas.bookings) FROM otas INNER JOIN hotels ON otas.hotel_id = hotels.hotel_id WHERE hotels.category = 'City';
SELECT name, medical_status FROM Astronauts WHERE medical_checkup_date >= '2020-01-01' AND medical_checkup_date < '2021-01-01';
SELECT prod_date, production_rate, LAG(production_rate, 1) OVER (ORDER BY prod_date) AS previous_month_rate FROM production WHERE well_id = 1;
SELECT FoodName FROM Food INNER JOIN Deliveries ON Food.ProduceID = Deliveries.ProduceID WHERE Food.Calories > 300 AND Deliveries.StoreID = 1;
SELECT r.clinic_id, COUNT(d.doctor_id) AS general_practitioners_count FROM doctors d JOIN rural_clinics r ON d.clinic_id = r.clinic_id WHERE r.state = 'Oregon' AND specialty = 'General Practitioner' GROUP BY r.clinic_id;
SELECT football_teams.team_name, football_matches.total_points, basketball_players.name FROM football_teams INNER JOIN football_matches ON football_teams.team_id = football_matches.team_id INNER JOIN basketball_players ON basketball_players.player_id = football_matches.player_id ORDER BY football_matches.total_points DESC;
SELECT COUNT(*) * 100.0 / (SELECT COUNT(*) FROM systems WHERE last_updated >= DATEADD(day, -60, GETDATE())) AS pct_above_avg FROM systems s WHERE risk_score > (SELECT AVG(risk_score) FROM systems WHERE last_updated >= DATEADD(day, -60, GETDATE()));
SELECT COUNT(*) FROM Missions INNER JOIN Astronauts ON Missions.Astronaut = Astronauts.Name WHERE Region = 'Asia' AND Year = 2023;
SELECT Building_Permits.Permit_ID, Building_Type, Issue_Date, Worker_Count, Year FROM Building_Permits INNER JOIN Residential_Buildings ON Building_Permits.Building_Type = Residential_Buildings.Building_Type INNER JOIN Labor_Statistics ON Building_Permits.Permit_ID = Labor_Statistics.Permit_ID WHERE Issue_Date BETWEEN '2018-01-01' AND '2020-12-31';
SELECT COUNT(VolunteerID) FROM Volunteers WHERE Community IN ('Women in Tech', 'Minorities in STEM') AND Year = 2019;
SELECT AVG(delivery_time) FROM deliveries WHERE route_id = 'R02';
SELECT * FROM algorithmic_fairness_incidents WHERE incident_date >= '2020-01-01' AND region = 'Asia-Pacific';
SELECT MAX(value) FROM Artworks INNER JOIN Artists ON Artworks.artist_id = Artists.id WHERE Artists.nationality = 'France';
SELECT t.team_name, AVG(p.age) as avg_age FROM players p JOIN teams t ON p.team_id = t.team_id GROUP BY t.team_name;
SELECT COUNT(*) FROM world_heritage_sites WHERE country = 'India' AND is_unesco_site = true;
SELECT s.species_name, COUNT(a.animal_id) AS total_admitted FROM animal_species s JOIN animal_rehab a ON s.species_id = a.species_id WHERE YEAR(a.rehab_date) = 2021 GROUP BY s.species_name;
SELECT a.Agency, COUNT(a.Satellite_Name) AS Number_Of_Satellites, DATEDIFF(day, MIN(m.Start_Date), MAX(m.End_Date)) * 1.0 / 30 AS Total_Mission_Duration_Months FROM Agency_Satellites a INNER JOIN Missions m ON a.Agency = m.Agency GROUP BY a.Agency HAVING COUNT(a.Satellite_Name) > 5;
SELECT type, MAX(donation_amount) FROM Donors GROUP BY type;
SELECT SUM(price * quantity) FROM RetailerG WHERE item = 'Accessories';
SELECT AVG(DATEDIFF(end_date, start_date)) as avg_duration_days FROM project_timeline WHERE project_id IN (SELECT id FROM projects WHERE state = 'New York');
SELECT InspectionData.Type, InspectionData.Manufacturer, AVG(DATEDIFF(day, InspectionData.LastInspection, InspectionData.NextInspection)) as AvgTimeBetweenInspections FROM InspectionData GROUP BY InspectionData.Type, InspectionData.Manufacturer;
SELECT region, year, AVG(num_projects) OVER (PARTITION BY region ORDER BY year ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS rolling_average FROM rural_projects WHERE region IN ('North', 'South', 'East', 'West');
SELECT AVG(age) FROM individual i WHERE i.city = 'NYC' AND i.vaccination_status = 'unvaccinated';
SELECT COUNT(*) FROM field5 WHERE moisture > 80;
SELECT AVG(Vehicle.city_traffic_speed) FROM Vehicle INNER JOIN SafetyTesting ON Vehicle.id = SafetyTesting.vehicle_id WHERE Vehicle.is_autonomous = false;
SELECT h.SiteName, a.ArtType FROM HeritageSites h JOIN ArtsHeritage a ON h.SiteName = a.SiteName;
SELECT location, AVG(trees_absorbed) FROM carbon_sequestration WHERE year BETWEEN 2019 AND 2021 AND location LIKE '%Pacific Northwest%' GROUP BY location;
SELECT Sector, SUM(Amount) OVER (PARTITION BY Sector ORDER BY SUM(Amount) DESC) AS TotalAmount, RANK() OVER (ORDER BY SUM(Amount) DESC) AS Rank FROM Grants GROUP BY Sector ORDER BY Rank;
SELECT well_name, MAX(gas_production_2020) as max_gas_production FROM well WHERE shale_play = 'Eagle Ford' GROUP BY well_name;
SELECT * FROM media_database WHERE (type = 'article' OR type = 'podcast') AND source = 'NPR';
SELECT university_type, COUNT(DISTINCT student_id) FROM students_disabilities GROUP BY university_type;
SELECT SUM(CASE WHEN country = 'Djibouti' THEN 1 ELSE 0 END) as total_bases, STRING_AGG(name, ', ') as base_names, STRING_AGG(location, ', ') as base_locations, base_type FROM MilitaryBases WHERE country = 'Djibouti' GROUP BY base_type;
SELECT district_name, enrollment FROM district_enrollment;
SELECT location, COUNT(*) as US_viewers FROM Concerts WHERE location LIKE '%United States%' GROUP BY location;
SELECT label, COUNT(*) as song_count FROM songs WHERE YEAR(release_date) = 2021 GROUP BY label;
SELECT AVG(r.no_of_beds) as avg_beds FROM (SELECT state, no_of_beds, ROW_NUMBER() OVER (PARTITION BY state ORDER BY no_of_beds DESC) as clinic_rank FROM rural_clinics) r WHERE r.clinic_rank = 1;
SELECT excavation_site, MAX(age) OVER (PARTITION BY culture_id) as oldest_artifact_age FROM ancient_artifacts JOIN ancient_cultures ON ancient_artifacts.culture_id = ancient_cultures.id GROUP BY excavation_site, culture_id;
SELECT SUM(funding_amount) FROM investments JOIN companies ON investments.company_id = companies.id WHERE companies.founder_gender = 'female';
SELECT state, SUM(school_type = 'Public') as public_schools, SUM(school_type = 'Private') as private_schools FROM schools GROUP BY state;
SELECT supplier_name, SUM(total_supply) FROM suppliers JOIN circular_supply_chain_products ON suppliers.id = circular_supply_chain_products.supplier_id GROUP BY supplier_name ORDER BY SUM(total_supply) DESC;
SELECT SUM(artworks) FROM artworks WHERE collection LIKE '%Europe%' AND gender = 'Male';
SELECT ship_agent.name, SUM(container.weight) FROM ship_agent JOIN port ON ship_agent.port_id = port.port_id JOIN container ON ship_agent.ship_agent_id = container.ship_agent_id WHERE port.name = 'Rotterdam' GROUP BY ship_agent.name, DATE(container.created_at);
SELECT r.RegionName, p.ProductName, SUM(p.QuantitySold) as TotalQuantitySold FROM Regions r JOIN Products p ON r.RegionID = 1 GROUP BY r.RegionName, p.ProductName HAVING p.Meat = true;
SELECT SUM(oil_volume) FROM oil_production WHERE year = 2020;
SELECT AVG(Passengers) FROM Routes JOIN Trips ON Routes.RouteID = Trips.RouteID JOIN PeakHours ON Trips.TripDateTime BETWEEN PeakHours.StartTime AND PeakHours.EndTime WHERE Routes.RouteName = 'Red Line' AND NOT (PeakHours.StartTime BETWEEN '06:00' AND '09:00' OR PeakHours.StartTime BETWEEN '16:00' AND '19:00');
SELECT country, SUM(cost) AS total_cost FROM space_programs GROUP BY country;
SELECT MAX(quantity) FROM inventory;
SELECT AVG(m.water_consumption) as avg_water_consumption FROM mines m;
SELECT year, AVG(production) as avg_production FROM crops_year GROUP BY year;
SELECT app_name FROM Creative_AI WHERE explainability_score > (SELECT AVG(explainability_score) FROM Creative_AI);
SELECT genre, quarter, SUM(budget) FROM MarketingBudget GROUP BY genre, quarter;
SELECT Genre, COUNT(*) as PlayerCount FROM PlayerScores INNER JOIN GameGenres ON PlayerScores.GameID = GameGenres.GameID WHERE HighScore >= (SELECT AVG(HighScore) FROM PlayerScores) GROUP BY Genre;
SELECT COUNT(*) FROM west_providers UNION ALL SELECT COUNT(*) FROM southeast_providers;
SELECT type, COUNT(*) FROM CyberSecurityIncidents GROUP BY type HAVING COUNT(*) > 1 ORDER BY COUNT(*) DESC;
SELECT DISTINCT Genre FROM Events;
SELECT continent, AVG(area) FROM carbon_sequestration GROUP BY continent;
SELECT COUNT(*) FROM carbon_offsets WHERE offset_amount IS NOT NULL;
SELECT SUM(amount_donated) FROM donors WHERE country = 'US';
SELECT region, AVG(productivity) FROM labor_productivity WHERE mine_type = 'Coal' GROUP BY region;
SELECT SUM(funding) FROM companies WHERE founders_lgbtq = true AND industry = 'biotech';
SELECT continent, AVG(donation_amount) FROM Donors GROUP BY continent;
SELECT department, SUM(amount) as total_budget FROM Budget WHERE YEAR(budget_date) = 2019 GROUP BY department;
SELECT COUNT(*) FROM Hospitals WHERE State = 'Texas';
SELECT MIN(donation_amount) FROM donors WHERE YEAR(donation_date) = 2021 AND donor_id IN (SELECT donor_id FROM donors GROUP BY donor_id HAVING COUNT(*) > 2);
SELECT MAX(billing_amount) FROM cases WHERE category = 'civil';
SELECT MAX(visitors) FROM Exhibitions WHERE city = 'Tokyo' AND exhibition_type = 'temporary';
SELECT CASE WHEN DATEPART(dw, publication) IN (1,7) THEN 'Weekend' ELSE 'Weekday' END AS DayType, COUNT(*) FROM DP_Articles WHERE publication BETWEEN '2022-07-01' AND '2022-07-31' AND DATEPART(dw, publication) NOT IN (1,7) GROUP BY CASE WHEN DATEPART(dw, publication) IN (1,7) THEN 'Weekend' ELSE 'Weekday' END UNION ALL SELECT CASE WHEN DATEPART(dw, publication) IN (1,7) THEN 'Weekend' ELSE 'Weekday' END AS DayType, COUNT(*) FROM SFC_Articles WHERE publication BETWEEN '2022-07-01' AND '2022-07-31' AND DATEPART(dw, publication) NOT IN (1,7) GROUP BY CASE WHEN DATEPART(dw, publication) IN (1,7) THEN 'Weekend' ELSE 'Weekday' END;
SELECT home_team_three_point, away_team_three_point, (home_team_three_point + away_team_three_point) as total_three_point FROM games WHERE home_team_id = (SELECT team_id FROM teams WHERE team_name = 'Celtics') OR away_team_id = (SELECT team_id FROM teams WHERE team_name = 'Celtics') ORDER BY total_three_point DESC LIMIT 1;
SELECT approach, COUNT(*) as count FROM treatments JOIN conditions ON treatments.approach = conditions.name WHERE conditions.id = 1 GROUP BY approach ORDER BY count DESC LIMIT 1;
SELECT country, SUM(amount) as total_financing FROM shariah_financing WHERE country IN (SELECT country FROM (SELECT country, ROW_NUMBER() OVER (ORDER BY SUM(amount) DESC) as rank FROM shariah_financing GROUP BY country) WHERE rank <= 3) GROUP BY country;
SELECT COUNT(*) FROM articles_es WHERE publication_date BETWEEN '2019-01-01' AND '2020-12-31' AND publisher = 'El PaÃ­s' AND language = 'Spanish';
SELECT COUNT(*) FROM TV_Shows WHERE country = 'Canada' AND seasons > 10;
SELECT * FROM (SELECT * FROM project_info WHERE category = 'Dam Construction' ORDER BY cost DESC) subquery LIMIT 5;
SELECT SUM(daily_distance) FROM london_buses WHERE date = '2022-03-01';
SELECT Platform, COUNT(DISTINCT PlayerID) as PlayersLastWeek FROM PlayerGameHistory WHERE PlayDate >= '2022-02-01' GROUP BY Platform
SELECT a.system_name, SUM(fr.issue_count) as total_issues FROM ai_systems a JOIN fairness_reports fr ON a.system_id = fr.system_id WHERE a.country = 'USA' GROUP BY a.system_name ORDER BY total_issues DESC;
SELECT COUNT(species_name) FROM CaribbeanSea WHERE species_name != 'Coral';
SELECT initiative_name FROM community_development WHERE number_of_participants = (SELECT MAX(number_of_participants) FROM community_development);
SELECT language, COUNT(*) as count FROM community_health_workers GROUP BY language;
SELECT COUNT(*) FROM students WHERE underrepresented_community = 1 AND enrollment_date >= '2018-01-01' AND program_id IN (SELECT program_id FROM programs WHERE program_type = 'Lifelong Learning');
SELECT Countries.country_name, AVG(Meals.caloric_content) as avg_caloric_content FROM Meals INNER JOIN Countries ON Meals.country_id = Countries.country_id GROUP BY Countries.country_name ORDER BY avg_caloric_content DESC;
SELECT region, COUNT(*) FROM employee_demographics GROUP BY region;
SELECT Type, SUM(Records) FROM Feedback WHERE Year = 2022 GROUP BY Type;
SELECT MAX(load_capacity_tonnes) FROM design_standards WHERE structure_type = 'Building';
SELECT FabricType, SUM(Quantity) as TotalQuantity FROM FabricInventory JOIN ClothingItems ON FabricInventory.ItemID = ClothingItems.ItemID WHERE ProductionDate BETWEEN '2021-01-01' AND '2021-12-31' AND Sustainable = true GROUP BY FabricType;
SELECT AVG(price) FROM products WHERE country_of_origin = 'USA';
SELECT Company FROM (SELECT Company, Production, ROW_NUMBER() OVER (PARTITION BY Company ORDER BY Year) as rn, LAG(Production) OVER (PARTITION BY Company ORDER BY Year) as prev_prod FROM DysprosiumProduction) t WHERE rn > 1 AND prev_prod < Production GROUP BY Company HAVING COUNT(*) = 3;
SELECT name FROM research WHERE budget > 8000000;
SELECT AVG(salinity) FROM mediterranean_salinity WHERE year BETWEEN (SELECT EXTRACT(YEAR FROM NOW()) - 10) AND EXTRACT(YEAR FROM NOW());
SELECT CityName, WasteGeneration FROM Cities WHERE WasteGeneration > (SELECT AVG(Cities.WasteGeneration) FROM Cities INNER JOIN RecyclingProgram ON Cities.CityID = RecyclingProgram.CityID);
SELECT Destination, SUM(SustainabilityRating) AS TotalRating FROM SustainabilityRatings WHERE Country = 'United Arab Emirates' OR Country = 'Israel' OR Country = 'Turkey' AND SustainabilityRating < 5 GROUP BY Destination ORDER BY TotalRating ASC;
SELECT MAX(budget) FROM rural_infrastructure WHERE type = 'Agricultural Innovation';
SELECT country, AVG(visitor_count) FROM exhibitions GROUP BY country;
SELECT continent, AVG(explainability_score) AS avg_explainability_score FROM creative_ai_algorithm_explainability_scores GROUP BY continent;
SELECT SUM(precipitation) FROM iot_sensors WHERE location = 'Germany' AND reading_time BETWEEN DATE_FORMAT(NOW(), '%Y-%m-01') AND LAST_DAY(NOW());
SELECT country, farm_type, AVG(dissolved_oxygen) AS avg_dissolved_oxygen FROM aquaculture_sites GROUP BY country, farm_type;
SELECT supporter, amount, SUM(amount) OVER (ORDER BY supporter) AS running_total FROM donations;
SELECT country, AVG(military_personnel) FROM HumanitarianAssistanceOperations GROUP BY country HAVING COUNT(*) > 200;
SELECT name, SUM(co2_emissions) FROM conservation_projects GROUP BY name;
SELECT MAX(workout_duration) FROM Workout WHERE country = 'Brazil';
SELECT COUNT(e.employee_id) as total_employees FROM employee e WHERE e.ethnicity IN ('African American', 'Hispanic', 'Native American');
SELECT SUM(Sales) FROM PharmaSales WHERE DrugName = 'DrugC' AND Year = 2016;
SELECT day_of_week, MAX(call_count) FROM call_volume GROUP BY day_of_week;
SELECT state, COUNT(*) FROM wastewater_plants WHERE state != 'California' AND year BETWEEN 2000 AND 2010 GROUP BY state;
SELECT MAX(cost) FROM labor_costs WHERE state = 'Oregon'
SELECT title FROM movie WHERE genre = 'Animation' ORDER BY viewers DESC LIMIT 3;
SELECT MAX(depth) FROM SouthChinaSea.wells;
SELECT cause_id, COUNT(DISTINCT donor_id) AS unique_donors FROM unique_donors GROUP BY cause_id;
SELECT v.name FROM vessel_capacity vc JOIN vessel v ON vc.vessel_id = v.id WHERE vc.capacity < 50000;
SELECT AVG(score) as avg_score FROM global_tournament WHERE country = 'Japan';
SELECT AVG(num_tracks) FROM albums WHERE genre = 'Pop' GROUP BY artist_id;
SELECT MAX(quantity) FROM products WHERE certification IN ('recycled', 'fair_trade') GROUP BY certification HAVING COUNT(DISTINCT certification) = 2
SELECT Donors.DonorType, SUM(Donations.DonationAmount) FROM Donors INNER JOIN Donations ON Donors.DonorID = Donations.DonorID WHERE Donations.DonationDate >= DATEADD(quarter, -1, GETDATE()) GROUP BY Donors.DonorType;
SELECT coowner_name FROM EcoHousing JOIN Property ON EcoHousing.property_id = Property.property_id WHERE development_name = 'EcoHousing';
SELECT innovation FROM agricultural_innovations WHERE country = 'Guatemala' AND implementation_year BETWEEN 2016 AND 2019;
SELECT mission_name FROM missions WHERE country1 != country2;
SELECT COUNT(*) FROM fans WHERE country = 'Canada';
SELECT * FROM cybersecurity_incidents WHERE YEAR(incident_date) = 2019 AND severity > 7 ORDER BY incident_date;
SELECT SUM(cost) FROM Ingredients WHERE dish_id IN (SELECT dish_id FROM Dishes WHERE dish_name = 'Falafel Wrap') AND ingredient_name NOT IN ('Hummus', 'Pita Bread');
SELECT SUM(co2_emission) as total_emission FROM (SELECT country, co2_emission FROM Co2Emissions WHERE year = 2020 ORDER BY co2_emission DESC LIMIT 3) t;
SELECT SUM(Population) FROM Endangered_Species WHERE Status = 'Critically Endangered';
SELECT type, SUM(capacity) as total_capacity FROM storage GROUP BY type ORDER BY total_capacity DESC;
SELECT program_name, program_expenses FROM (SELECT program_name, program_expenses, ROW_NUMBER() OVER (ORDER BY program_expenses DESC) AS high_expense, ROW_NUMBER() OVER (ORDER BY program_expenses ASC) AS low_expense FROM programs WHERE EXTRACT(YEAR FROM program_date) = 2021 AND EXTRACT(MONTH FROM program_date) BETWEEN 1 AND 6) AS subquery WHERE high_expense = 1 OR low_expense = 1;
SELECT Category, AVG(Playtime) OVER(PARTITION BY Category) as AvgPlaytime FROM GameStats;
SELECT AVG(users.age) FROM users INNER JOIN likes ON users.id = likes.user_id WHERE likes.article_id = 123;
SELECT state, SUM(revenue) as total_revenue FROM States GROUP BY state ORDER BY total_revenue DESC LIMIT 5;
SELECT country, COUNT(*) AS factory_count FROM factories WHERE certified = TRUE GROUP BY country ORDER BY factory_count DESC LIMIT 1;
SELECT * FROM Indigenous_Food_Systems WHERE Country IN ('Spain', 'France') AND Farming_Method = 'Permaculture';
SELECT gender, MIN(health_equity_metric_score) FROM patients GROUP BY gender;
SELECT project_name, budget FROM social_good_projects ORDER BY budget DESC LIMIT 2;
SELECT product_name, description  FROM shariah_compliant_products;
SELECT AVG(word_count) AS avg_word_count FROM news_reporting WHERE category = 'Sports';
SELECT menu_name, SUM(quantity_sold) as total_quantity FROM order_details o JOIN orders ON o.order_id = orders.order_id JOIN menu m ON o.menu_id = m.menu_id WHERE region = 'South' AND menu_category = 'Dessert' GROUP BY menu_name ORDER BY total_quantity DESC LIMIT 5;
SELECT name FROM factories WHERE region = 'Americas' AND industry_4_0 = TRUE;
SELECT sensor_id, AVG(precip) FROM Field4_Precip WHERE sensor_reading BETWEEN '2021-08-16' AND '2021-08-31' GROUP BY sensor_id;
SELECT Country, SUM(TotalDonation) FROM Donors GROUP BY Country;
SELECT product_id, ingredient FROM IngredientsVeganCrueltyFree WHERE ingredient = 'lavender' AND is_vegan = true AND is_cruelty_free = true;
SELECT AVG(g.count) FROM (SELECT COUNT(grants.id) AS count FROM grants GROUP BY grants.department_id) AS g;
SELECT city, COUNT(*) FROM co_ownerships WHERE co_ownership = true GROUP BY city HAVING COUNT(*) > 10;
SELECT SUM(capacity) FROM wind_projects WHERE city = 'Seattle';
SELECT location, species, SUM(biomass) biomass FROM fish_biomass WHERE year BETWEEN 2011 AND 2021 GROUP BY location, species;
SELECT MIN(temperature) FROM temperature_data WHERE region = 'Arctic' AND year = 2020;
SELECT SUM(cost) FROM SupportPrograms;
SELECT CustomerName, TotalFreightCharges, Region FROM (SELECT CustomerName, TotalFreightCharges, Region, ROW_NUMBER() OVER (PARTITION BY Region ORDER BY TotalFreightCharges DESC) AS Ranking FROM CustomersRegion) AS Subquery WHERE Ranking <= 3;
SELECT plan_type, state, SUM(data_usage)/1024/1024/1024 FROM mobile_usage WHERE state = 'Florida' GROUP BY plan_type;
SELECT MIN(data_usage) FROM mobile_subscribers WHERE state = 'California' AND subscription_type = 'postpaid';
SELECT COUNT(*) FROM Volunteers WHERE State = 'California' AND LastEngagementDate >= DATEADD(month, -6, GETDATE());
SELECT name FROM dapps WHERE category = 'Gaming';
SELECT AVG(budget) FROM biotech_startups WHERE region = 'Asia Pacific';
SELECT p.portfolio_id, MAX(p.shariah_compliant_investment_amount) as max_amount, MIN(p.shariah_compliant_investment_amount) as min_amount FROM portfolios p INNER JOIN shariah_compliant_portfolios scp ON p.portfolio_id = scp.portfolio_id GROUP BY p.portfolio_id;
SELECT department, MAX(COUNT(*)) FROM publications GROUP BY department HAVING department = 'Arts and Humanities';
SELECT programName, COUNT(*) as enrollment_count FROM SupportPrograms GROUP BY programName ORDER BY enrollment_count DESC LIMIT 3;
SELECT MAX(price) FROM hair_care_sales WHERE is_natural = true AND country = 'France';
SELECT AVG(hours) as avg_hours_per_volunteer FROM Volunteer_Hours JOIN Volunteers ON Volunteer_Hours.volunteer_id = Volunteers.id;
SELECT SUM(assets) FROM (SELECT client_id, assets FROM client_assets WHERE client_id IN (SELECT client_id FROM clients WHERE last_transaction_date >= '2021-10-01' AND last_transaction_date <= '2021-12-31')) clients_assets_q4
SELECT COUNT(*) FROM model_fairness WHERE fairness_score < 0.7;
SELECT AVG(technology_adoption_score) FROM smart_cities;
SELECT COUNT(*) FROM hospitals WHERE state = 'California';
SELECT AVG(price) FROM elements_price WHERE element_id IN (SELECT id FROM elements WHERE symbol LIKE 'E%');
SELECT ProductCategory, SUM(Amount) AS TotalRevenue FROM Sales JOIN Revenue ON Sales.SaleID = Revenue.SaleID WHERE SaleDate >= DATEADD(MONTH, -1, GETDATE()) GROUP BY ProductCategory;
SELECT region, SUM(violation_count) FROM mental_health_parity GROUP BY region;
SELECT Region, SUM(Amount) FROM Expenditure WHERE Quarter = 1 AND Year = 2023 GROUP BY Region;
SELECT MAX(quantity) FROM tickets JOIN games ON tickets.game_id = games.id WHERE games.team = 'Eagles' AND YEAR(games.date) = 2021;
SELECT SUM(WasteGeneration) FROM (SELECT Country, WasteGeneration FROM WasteData WHERE Continent = 'Africa' AND RecyclingRate < (SELECT AVG(RecyclingRate) FROM WasteData WHERE Continent = 'Africa') GROUP BY Country ORDER BY WasteGeneration DESC FETCH FIRST 2 ROWS ONLY) tmp;
SELECT consumption FROM total_consumption WHERE year IN (2015, 2016)
SELECT COUNT(*) FROM MilitaryInnovations WHERE country = 'China' AND year BETWEEN 2012 AND 2017;
SELECT AVG(revenue) FROM hotels WHERE country IN ('Brazil', 'Argentina') AND hotel_name LIKE '%eco%';
SELECT item_name, COUNT(*) as order_count FROM menu_items WHERE is_vegetarian = true GROUP BY item_name ORDER BY order_count DESC LIMIT 2;
SELECT size, COUNT(*) as popularity FROM orders GROUP BY size ORDER BY popularity DESC LIMIT 5;
SELECT department, AVG(num_publications) as avg_publications FROM graduate_students GROUP BY department;
SELECT COUNT(patient_id) FROM patient WHERE diagnosis = 'Diabetes' AND state = 'Texas' AND gender = 'Male' AND location LIKE '%rural%';
SELECT MAX(trips_on_day) FROM public.trips_by_day_train WHERE train_type = 'autonomous_train' AND city = 'Beijing';
SELECT s.supplier_name FROM suppliers s INNER JOIN electronics_factories ef ON s.id = ef.supplier_id WHERE s.industry = 'Electronics';
SELECT MIN(price) FROM SkincareProducts WHERE is_vegan = TRUE AND country = 'United Kingdom';
SELECT species_name, year, AVG(volume) as avg_volume FROM timber_production tp JOIN species s ON tp.species_id = s.species_id GROUP BY species_name, year;
SELECT state, COUNT(*) FROM clients GROUP BY state;
SELECT DISTINCT artifact_type FROM artifacts WHERE site_id = 1;
SELECT MIN(biomass) FROM shark_biomass WHERE ocean = 'Atlantic';
SELECT * FROM low_value_contracts WHERE contract_value = (SELECT MIN(contract_value) FROM low_value_contracts);
SELECT COUNT(union_member_id) FROM Retail_Workers_Union WHERE safety_rating > 8 AND salary > 40000;
SELECT COUNT(*) FROM waste_types;
SELECT ContractNegotiations.country1, ContractNegotiations.country2, ContractNegotiations.date, RiskAssessments.risk_score FROM ContractNegotiations INNER JOIN RiskAssessments ON (ContractNegotiations.country1 = RiskAssessments.country OR ContractNegotiations.country2 = RiskAssessments.country) WHERE (ContractNegotiations.country1 = 'US' OR ContractNegotiations.country2 = 'US') ORDER BY ContractNegotiations.date DESC;
SELECT AVG(energy_star_rating) FROM building_stats WHERE year_built < 2000;
SELECT a.name, SUM(s.minutes) AS total_minutes FROM Artists a JOIN Streams s ON a.id = s.artist_id WHERE s.year = 2021 GROUP BY a.name ORDER BY total_minutes DESC LIMIT 5;
SELECT AVG(bookings) FROM virtual_tours WHERE location = 'New York' GROUP BY DATE(booking_date);
SELECT company_name, revenue FROM (SELECT company_name, revenue, revenue_date, RANK() OVER (ORDER BY revenue DESC) as rnk FROM mining_company_revenue WHERE revenue_date >= DATEADD(year, -1, CURRENT_DATE)) t WHERE rnk <= 10;
SELECT city, COUNT(*), AVG(age) FROM Volunteers WHERE city = 'CityJ' GROUP BY city;
SELECT id, pH, production_date FROM ChemicalBatches WHERE pH > 9 AND production_date >= '2021-01-01';
SELECT artist_name, num_pieces FROM (SELECT artist_name, category, num_pieces, RANK() OVER (PARTITION BY category ORDER BY num_pieces DESC) AS rank FROM Artist_Data) tmp WHERE rank <= 3 AND category = 'Post-Impressionism';
SELECT AVG(GrantAmount) FROM ResearchGrants JOIN Faculty ON Faculty.FacultyID = ResearchGrants.GranteeID WHERE Faculty.Department = 'Computer Science' AND Faculty.Gender = 'Female';
SELECT SUM(size) FROM public_buildings WHERE state IN ('New York', 'Illinois');
SELECT COUNT(*) FROM professionals WHERE state = 'Alaska' AND location = 'urban';
SELECT s.state_name, mp.profession_count FROM states s JOIN medical_professionals mp ON s.state_id = mp.state_id;
SELECT country, AVG(waste_generation_grams / population) as avg_waste_generation_per_capita FROM waste_generation WHERE year = 2020 GROUP BY country ORDER BY avg_waste_generation_per_capita DESC;
SELECT MIN(age) FROM rural_clinics WHERE country = 'Mexico';
SELECT EXTRACT(MONTH FROM OrderDate) as Month, SUM(Quantity * Price) as TotalSales FROM Orders JOIN Dishes ON Orders.DishID = Dishes.DishID WHERE IsVegetarian = 1 GROUP BY Month;
SELECT vendors.region, SUM(sales.revenue) FROM vendors INNER JOIN sales ON vendors.vendor_id = sales.vendor_id GROUP BY vendors.region;
SELECT MAX(temperature) FROM AquaticFarm WHERE MONTH(date) = 2 AND YEAR(date) = 2022;
SELECT COUNT(DISTINCT species) FROM arctic_marine_species WHERE region = 'Arctic';
SELECT name, total_labor_cost FROM Contractor_Labor_Costs JOIN Contractors ON Contractor_Labor_Costs.contractor_id = Contractors.id WHERE state = 'Florida' ORDER BY total_labor_cost DESC LIMIT 3;
SELECT COUNT(*) FROM flu_shots f INNER JOIN patients p ON f.patient_id = p.patient_id WHERE p.age > 65 AND f.state = 'Texas';
SELECT WasteType, SUM(Quantity) FROM WasteGeneration WHERE City = 'Mumbai' AND Year = 2020 GROUP BY WasteType;
SELECT AVG(p.budget) FROM project p JOIN location l ON p.location = l.name JOIN continent c ON l.continent_id = c.continent_id WHERE c.name = 'Asia' AND l.name = 'Southeast Asia';
SELECT country, SUM(capacity) FROM landfill_capacity_north_america WHERE year = 2021 GROUP BY country;
SELECT * FROM startups WHERE founded_year = 2016;
SELECT countries.country_name, AVG(life_expectancy) AS avg_life_expectancy FROM countries INNER JOIN life_expectancy ON countries.country_id = life_expectancy.country_id GROUP BY countries.country_name;
SELECT hotel_id, hotel_name, SUM(views) FROM apac_hotel_views GROUP BY hotel_id, hotel_name;
SELECT (SUM(CASE WHEN Service = 'Education' THEN Budget ELSE 0 END) / SUM(Budget)) * 100 FROM Budget WHERE Year IN (2020, 2021);
SELECT FundingAgency, FundingDate FROM Funding f JOIN ExcavationSites e ON f.SiteID = e.SiteID WHERE e.SiteName = 'Palenque';
SELECT SUM(trip_count) FROM public_transportation WHERE trip_date BETWEEN '2023-01-01' AND '2023-01-31';
SELECT SUM(runtime) FROM episodes WHERE tv_show_id = 1;
SELECT subscription_plan, AVG(data_usage) as avg_data_usage FROM (SELECT subscription_plan, data_usage, last_update, ROW_NUMBER() OVER (PARTITION BY subscription_plan, YEAR(last_update) - MONTH(last_update) / 12 ORDER BY last_update DESC) as rn FROM mobile_subscribers WHERE last_update >= DATEADD(year, -1, GETDATE())) x WHERE rn = 1 GROUP BY subscription_plan;
SELECT SUM(juvenile) FROM diversion_programs WHERE region = 'Southern';
SELECT team_name, matches_played FROM english_premier_league;
SELECT organization_id FROM grants GROUP BY organization_id HAVING COUNT(DISTINCT initiative_type) = (SELECT COUNT(*) FROM initiative_types);
SELECT COUNT(DISTINCT region) FROM rare_earth_companies;
SELECT AVG(number_of_grants) FROM (SELECT faculty.gender, COUNT(grants.id) AS number_of_grants FROM faculty JOIN grants ON faculty.id = grants.faculty_id WHERE faculty.department = 'Physics' AND faculty.gender = 'Non-binary' GROUP BY faculty.id) AS subquery;
SELECT * FROM older_farmers;
SELECT name FROM africa_schema.african_mines WHERE production_value > 1000000;
SELECT Accessible_Tech_Categories.category, SUM(Accessible_Tech_Categories.initiatives) FROM Accessible_Tech_Categories WHERE Accessible_Tech_Categories.country IN (SELECT Accessible_Tech_Categories.country FROM Accessible_Tech_Categories GROUP BY Accessible_Tech_Categories.country ORDER BY COUNT(Accessible_Tech_Categories.country) DESC LIMIT 3) GROUP BY Accessible_Tech_Categories.category;
SELECT funding_source_type, SUM(amount_funded) FROM funding_sources WHERE event_name IN (SELECT event_name FROM events WHERE event_category = 'visual arts') GROUP BY funding_source_type;
SELECT COUNT(*) FROM sites_me WHERE region = 'Middle East';
SELECT MAX(gas_fee) AS max_fee, MIN(gas_fee) AS min_fee FROM solana_transactions WHERE transaction_date >= DATEADD(month, -1, GETDATE());
SELECT Department, AVG(Salary) as Avg_Salary FROM Employees WHERE Gender = 'Male' GROUP BY Department;
SELECT state, COUNT(*) as parity_law_count FROM mental_health_parity WHERE parity_law = 'yes' GROUP BY state HAVING COUNT(*) > 3;
SELECT SUM(installed_capacity) FROM wind_energy_projects WHERE state = 'California' AND year = 2020;
SELECT Age, AVG(DonationAmount) as AverageDonationAmount FROM Donors WHERE DonationAmount >= 10 AND YEAR(DonationDate) = 2021 GROUP BY Age;
SELECT r.resource_name, COUNT(s.access_date) FROM student_access s INNER JOIN open_pedagogy_resources r ON s.resource_id = r.resource_id GROUP BY r.resource_name;
SELECT MAX(Score) FROM ClassicGame;
SELECT country, COUNT(*) as smart_contract_count FROM smart_contracts GROUP BY country ORDER BY smart_contract_count DESC LIMIT 3;
SELECT supplier_id, SUM(total_shipped) as total_organic_shipments FROM shipments WHERE organic = true AND year = 2021 GROUP BY supplier_id ORDER BY total_organic_shipments DESC FETCH FIRST 1 ROW ONLY;
SELECT severity, COUNT(*) as total_vulnerabilities FROM NetworkDevices GROUP BY severity;
SELECT vessel_name, MAX(visit_date) FROM visits JOIN vessels ON visits.vessel_id = vessels.vessel_id WHERE port_id = (SELECT port_id FROM ports WHERE port_name = 'Singapore') AND visit_date >= '2021-01-01' GROUP BY vessel_name ORDER BY MAX(visit_date) DESC;
SELECT SUM(contract_value) FROM military_contracts WHERE country = 'India' AND company_gender = 'Women-Owned Business' ORDER BY contract_value DESC;
SELECT COUNT(AgreementID) FROM DefenseAgreements WHERE Country IN (SELECT Country FROM Countries WHERE Region = 'APAC') AND AgreementType = 'Defense Agreement';
SELECT AVG(population) FROM ArcticOcean WHERE seal_species IS NOT NULL;
SELECT AVG(e.salary) FROM Employees e JOIN Plants p ON e.department = p.name WHERE p.name = 'Manufacturing';
SELECT AVG(explainability_score) FROM european_healthcare;
SELECT SUM(num_tickets_sold) AS total_tickets_sold FROM events WHERE event_type = 'Outdoor Concert';
SELECT name, certification FROM green_buildings;
SELECT Year, Status, COUNT(Request) FROM LegalAidRequests GROUP BY Year, Status;
SELECT name FROM SafetyOrgs WHERE country IN ('UK', 'France', 'Germany') GROUP BY name HAVING COUNT(DISTINCT country) = 3;
SELECT Employees.JobLevel, Employees.Manager, Employees.Ethnicity, AVG(Employees.Tenure) as Avg_Tenure FROM Employees GROUP BY Employees.JobLevel, Employees.Manager, Employees.Ethnicity;
SELECT COUNT(*) as total_initiatives FROM sustainability_initiatives WHERE location LIKE '%Asia%' AND year = 2021;
SELECT MAX(impact_score) FROM investment JOIN investor ON investment.investor_id = investor.investor_id WHERE investor.country = 'India' AND strategy LIKE '%Healthcare%';
SELECT Region, PERCENTAGE(SUM(OnTime) OVER (PARTITION BY Region) / COUNT(*) OVER (PARTITION BY Region)) as PercentageOnTime FROM ProjectTimelineByBudget WHERE Region = 'Pacific' AND Half = 2 AND Budget > 10000000;
SELECT COUNT(*) FROM Events WHERE EventAttendance < 50 AND EventDate < '2022-07-01';
SELECT AVG(price/size) FROM paris_real_estate WHERE city = 'Paris' AND wheelchair_accessible = true;
SELECT SUM(revenue) FROM Hotels WHERE eco_certified = TRUE AND country IN ('Americas') AND rooms > 100 AND YEAR(date) = 2022;
SELECT name FROM indigenous_food_systems WHERE region = 'North America' AND community_members = (SELECT community_members FROM indigenous_food_systems WHERE name = 'Green Corn Ceremony');
SELECT COUNT(ct.id) as total_completed_trials FROM clinical_trials ct JOIN drugs d ON ct.drug_id = d.id WHERE d.approval_date > '2017-01-01';
SELECT mission_name, launch_date, mission_status FROM space_missions WHERE launch_date < '1990-01-01';
SELECT EXTRACT(MONTH FROM incident_date) as month, COUNT(*) as incidents_per_month FROM security_incidents WHERE region = 'EMEA' AND incident_date BETWEEN '2021-01-01' AND '2021-12-31' GROUP BY month;
SELECT player FROM rebounds WHERE league = 'NBA' AND rebounds = (SELECT MAX(rebounds) FROM rebounds WHERE league = 'NBA');
SELECT AVG(score) FROM performance_scores WHERE region = 'SA';
SELECT SUM(MappingLength) FROM MappingLengths;
SELECT COUNT(*) FROM art_exhibit_attendance WHERE num_attendees > 30 AND exhibit_location = 'Paris';
SELECT SUM(amount) as total_donation FROM donations WHERE donor IN ('Sophia Lee', 'Ali Al-Khaleej') AND YEAR(donation_date) = 2022;
SELECT org_id, COUNT(*) as total_donations FROM org_donation GROUP BY org_id;
SELECT node_id, COUNT(*) FROM stellar_transactions WHERE timestamp BETWEEN UNIX_TIMESTAMP() - 604800 AND UNIX_TIMESTAMP() GROUP BY node_id;
SELECT SUM(population) FROM City WHERE YEAR(founded) < 1800;
SELECT district, SUM(votes) AS total_votes, (SUM(votes) / MAX(total_voters)) * 100 AS turnout_percentage FROM elections GROUP BY district;
SELECT MAX(violation_count) FROM (SELECT COUNT(*) as violation_count, EXTRACT(MONTH FROM sv.violation_date) as violation_month FROM safety_violations sv INNER JOIN unions u ON sv.union_id = u.union_id WHERE u.focus = 'manufacturing' GROUP BY violation_month) as subquery;
SELECT location, COUNT(*) FROM farmers GROUP BY location;
SELECT revenue FROM shipments WHERE shipment_id = 123;
SELECT SUM(amount) FROM investments;
SELECT artist_name, COUNT(*) as artwork_count FROM Artworks GROUP BY artist_name ORDER BY artwork_count DESC LIMIT 3;
SELECT drug_name, COUNT(*) as approval_count FROM drug_approvals WHERE approval_country IN ('USA', 'Canada') GROUP BY drug_name ORDER BY drug_name;
SELECT E.EventCountry, EXTRACT(MONTH FROM E.EventDate) AS Month, COUNT(DISTINCT EP.PlayerID) AS PlayersJoined, COUNT(DISTINCT VR.VRDevice) AS VRDevices, COUNT(DISTINCT G.GameID) AS UniqueGames FROM Players P JOIN EventParticipation EP ON P.PlayerID = EP.PlayerID JOIN EventDates E ON EP.EventID = E.EventID JOIN GamePlay G ON P.PlayerID = G.PlayerID JOIN VRAdoption VR ON P.PlayerID = VR.PlayerID GROUP BY E.EventCountry, EXTRACT(MONTH FROM E.EventDate)
SELECT AVG(SustainabilityRating) FROM Skincare_Ingredients WHERE IsVegan = 1;
SELECT Department, ROUND(COUNT(CASE WHEN Gender = 'Female' THEN 1 END) * 100.0 / COUNT(*), 1) AS FemalePercentage, ROUND(COUNT(CASE WHEN Gender = 'Male' THEN 1 END) * 100.0 / COUNT(*), 1) AS MalePercentage, ROUND(COUNT(CASE WHEN Gender = 'Non-binary' THEN 1 END) * 100.0 / COUNT(*), 1) AS NonBinaryPercentage FROM EmployeeDemographics GROUP BY Department;
SELECT restaurant_id, COUNT(*) as critical_violations FROM inspections WHERE result = 'critical violation' GROUP BY restaurant_id;
SELECT States.StateName, COUNT(Cities.CityID) AS CityCount FROM States JOIN Cities ON States.StateID = Cities.StateID GROUP BY States.StateName HAVING SUM(Cities.Population) > 500000;
SELECT AVG(cost) FROM meat_menu_items;
SELECT department, COUNT(*) FROM hr.employees GROUP BY department;
SELECT AVG(annual_revenue) FROM TourismProviders JOIN Revenue ON TourismProviders.provider_id = Revenue.provider_id WHERE country = 'Australia' AND sustainability_focus = 'Sustainable Tourism';
SELECT region, SUM(personnel) FROM military_personnel GROUP BY region ORDER BY SUM(personnel) DESC
SELECT MAX(range) FROM ev_suvs;
SELECT MAX(size_ha) FROM plots WHERE type = 'Agroforestry';
SELECT SUM(*) FROM cases WHERE year IN (2019, 2020);
SELECT AVG(depth) FROM lead_mines;
SELECT COUNT(*), AVG(cost) FROM projects WHERE country = 'Cambodia';
SELECT * FROM genetic_research WHERE community = 'Indigenous';
SELECT SUM(total_cost) FROM nasa_mars_program WHERE name = 'Mars Exploration Program';
SELECT COUNT(*) FROM tv_shows WHERE name LIKE '%news%';
SELECT EXTRACT(MONTH FROM trip_start_time) AS month, COUNT(*) AS num_trips
SELECT center_name, DATE_FORMAT(case_date, '%Y-%m') AS case_month, COUNT(*) AS cases_per_month FROM restorative_justice_center GROUP BY center_name, case_month;
SELECT (COUNT(CASE WHEN gender = 'female' THEN 1 END) * 100.0 / COUNT(*)) as female_percentage   FROM users;
SELECT artist, SUM(tickets_sold) AS total_tickets_sold FROM concert_sales WHERE date BETWEEN '2022-11-01' AND '2022-11-30' GROUP BY artist ORDER BY total_tickets_sold DESC LIMIT 1;
SELECT MAX(e.salary) FROM employees e JOIN departments d ON d.id = e.dept_id WHERE d.name = 'technical_ops';
SELECT city, COUNT(DISTINCT visitor_count) FROM exhibitions GROUP BY city;
SELECT AVG(amount) FROM org_climate_finance WHERE org_size IN ('medium', 'large');
SELECT salesperson, SUM(revenue) FROM sales WHERE revenue IS NOT NULL AND salesperson IS NOT NULL AND STR_TO_DATE(CONCAT('01-', MONTH(NOW())), '%d-%m-%Y') = STR_TO_DATE('01-2022', '%d-%m-%Y') GROUP BY salesperson;
SELECT AVG(pieces) FROM exhibitions WHERE visitors > 1500;
SELECT AVG(pub_count) FROM (SELECT author_id, COUNT(*) as pub_count FROM higher_ed.publications GROUP BY author_id) p JOIN higher_ed.students s ON p.author_id = s.id WHERE s.department = 'English';
SELECT COUNT(*) FROM Cybersecurity_Incidents WHERE region = 'APAC' AND QUARTER(incident_date) = 3 AND incident_date >= '2021-07-01' AND incident_date <= '2021-09-30';
SELECT COUNT(*) FROM Volunteers
SELECT artwork_name, artist_id FROM Artwork WHERE artist_gender = 'Female';
SELECT DATE_TRUNC('month', detection_date) AS month, COUNT(*) FROM disinformation_detection WHERE is_false = TRUE GROUP BY month;
SELECT COUNT(*) FROM mining_sites WHERE state = 'Utah';
SELECT departments.name, COUNT(*) AS num_employees FROM hr.departments JOIN hr.employees ON departments.id = employees.department_id GROUP BY departments.name ORDER BY num_employees DESC;
SELECT SUM(recycling_rate) AS total_recycling_rate FROM recycling_rates_state WHERE state = 'Texas' AND year = 2015;
SELECT Genre, SUM(Revenue) as TotalRevenue FROM GameSales GROUP BY Genre;
SELECT user_name FROM user_genre GROUP BY user_name HAVING COUNT(DISTINCT genre) > 1;
SELECT DATE(transaction_date) as transaction_day, COUNT(transaction_id) as number_of_transactions FROM transactions WHERE transaction_date BETWEEN '2022-01-01' AND '2022-01-31' GROUP BY transaction_day;
SELECT country, renewable_energy_production/population AS production_per_capita FROM energy_production WHERE population >= 10000000 GROUP BY country ORDER BY production_per_capita DESC LIMIT 2;
SELECT name FROM Levees WHERE location = 'Louisiana' AND built < '2000-01-01';
SELECT MIN(heart_rate) FROM heart_rate_data WHERE shoe_brand = 'Yeezy';
SELECT * FROM sustainable_practices_2 WHERE state = 'OR';
SELECT location, incident_date, COUNT(*) as daily_crimes FROM crimes JOIN dates ON crimes.incident_date = dates.date GROUP BY location, incident_date;
SELECT AVG( mental_health_score ) as avg_open, 'Open' as course_type FROM student_courses WHERE course_type = 'Open' UNION ALL SELECT AVG( mental_health_score ) as avg_traditional, 'Traditional' as course_type FROM student_courses WHERE course_type = 'Traditional';
SELECT Name, Type, Engine_Capacity FROM Vessels WHERE Type = 'Cargo Ship' AND Engine_Capacity BETWEEN 3000 AND 5000;
SELECT MAX(um.age) FROM union_members um INNER JOIN unions u ON um.union_id = u.union_id WHERE u.focus = 'education';
SELECT Cultivators.CultivatorName, SUM(Production.Quantity) AS TotalQuantity FROM Cultivators INNER JOIN Production ON Cultivators.CultivatorID = Production.CultivatorID WHERE Cultivators.State = 'California' GROUP BY Cultivators.CultivatorName HAVING TotalQuantity > 1000;
SELECT SUM(quantity * purchase_price) as total_inventory_value FROM HealthyDelights;
SELECT projects.name, funding_sources.source, SUM(funding_sources.amount), projects.start_date FROM biosensors.projects INNER JOIN biosensors.funding_sources ON projects.id = funding_sources.project_id WHERE projects.location = 'California' AND funding_sources.source LIKE 'Private%' GROUP BY projects.name, funding_sources.source, projects.start_date;
SELECT COUNT(*) FROM TrainMaintenance WHERE TaskDate >= '2022-01-01' AND TaskDate < '2022-02-01';
SELECT art FROM traditional_arts WHERE country = 'Canada' AND practitioners > 500;
SELECT DISTINCT neighborhood FROM sustainable_urban_properties_2 WHERE city = 'Boston' GROUP BY neighborhood HAVING COUNT(*) > 200;
SELECT MAX(round_number) FROM investments JOIN startups ON investments.startup_id = startups.id WHERE startups.founder_identity = 'LGBTQ+';
SELECT donor_category, p.program_name, SUM(d.donation_amount) as total_donation_amount FROM donations d JOIN donors don ON d.donor_id = don.donor_id JOIN programs p ON don.donor_category = p.program_name WHERE d.donation_date BETWEEN '2022-07-01' AND '2022-09-30' GROUP BY donor_category, p.program_name;
SELECT region, 100.0 * AVG(CASE WHEN organic_purchases = true THEN 1.0 ELSE 0.0 END) AS pct_organic FROM suppliers WHERE region = 'Asia' GROUP BY region;
SELECT COUNT(*) FROM WaterTreatmentPlants WHERE state = 'New York' AND monthly_expenses > monthly_budget;
SELECT SUM(amount) FROM food_assistance fa JOIN displaced_people d ON fa.country = d.country WHERE d.food_assistance_given = TRUE;
SELECT research_station.station_name, oa.level AS min_level FROM ocean_acidification oa JOIN (SELECT location, MIN(level) AS min_level FROM ocean_acidification WHERE region = 'Pacific Ocean' GROUP BY location) oa_min ON oa.level = oa_min.min_level JOIN research_stations research_station ON oa.location = research_station.station_name;
SELECT COUNT(*) FROM renewable_projects WHERE country = 'Canada' AND project_status = 'completed' AND year BETWEEN 2015 AND 2020;
SELECT MAX(price) FROM textile_sourcing WHERE material = 'silk' AND country = 'China';
SELECT MAX(donation_amount) FROM sponsorship_donations WHERE program = 'Sponsorship';
SELECT V.Name, SUM(D.Amount) as TotalDonations FROM Volunteers V JOIN VolunteerPrograms VP ON V.VolunteerID = VP.VolunteerID JOIN Donations D ON VP.ProgramID = D.ProgramID GROUP BY V.Name
SELECT AVG(Movies.IMDbRating) AS Avg_Movie_Rating, AVG(TVShows.IMDbRating) AS Avg_TVShow_Rating, SUM(Movies.ProductionBudget) AS Total_Movie_Budget, SUM(TVShows.ProductionBudget) AS Total_TVShow_Budget FROM Movies INNER JOIN TVShows ON 1=1 WHERE Movies.Country = 'Japan' AND TVShows.Country = 'Japan';
SELECT SUM(DisabilitySupportPrograms.budget) + SUM(DisabilityAdvocacy.budget) FROM DisabilitySupportPrograms, DisabilityAdvocacy WHERE DisabilitySupportPrograms.year = 2022 AND DisabilityAdvocacy.year = 2022;
SELECT SUM(meeting_count) FROM defense.russia_nato_diplomacy WHERE year BETWEEN 2020 AND 2021 AND country IN ('NATO', 'Russia');
SELECT lawyer_name, SUM(cases_heard) AS total_cases_heard FROM lawyers GROUP BY lawyer_name ORDER BY total_cases_heard DESC LIMIT 3;
SELECT job_title, region, AVG(salary) FROM workers WHERE sector = 'Workforce Development' GROUP BY job_title, region;
SELECT COUNT(*) FROM buildings WHERE region = 'Southern' AND year = 2020 AND type = 'Green';
SELECT AVG(price) FROM sustainable_fabrics;
SELECT MAX(fairness_score) FROM algorithmic_fairness WHERE dataset = 'algorithmic_fairness';
SELECT p.port_name, SUM(c.weight) as total_weight FROM Port p JOIN Cargo c ON p.port_id = c.port_id WHERE handling_date >= '2022-01-01' AND handling_date < '2023-01-01' GROUP BY p.port_name ORDER BY total_weight DESC LIMIT 5;
SELECT AVG(budget) AS average_budget FROM departments;
SELECT L.language, AH.heritage_site FROM LanguagesAtRisk L INNER JOIN AssociatedHeritages AH ON L.id = AH.language_id;
SELECT City.name, SUM(Property.price) as total_price FROM City INNER JOIN Property ON City.name = Property.city WHERE City.sustainable_rating > 80 AND City.population > 500000 GROUP BY City.name HAVING SUM(Property.price) > (SELECT AVG(Property.price) FROM Property)
SELECT COUNT(*) FROM students WHERE disability_type = 'Mobility Impairment' AND YEAR(accommodation_date) = 2020 AND accommodation_provided IN ('Wheelchair', 'Mobility Scooter');
SELECT Location, Year, COUNT(*) as NumEvents FROM EsportsEvents GROUP BY Location, Year
SELECT category, DATE_FORMAT(waste_date, '%Y-%m') AS Month, SUM(quantity) FROM waste_data GROUP BY Month, category;
SELECT c.name, MAX(t.transaction_amount) FROM customers c JOIN transactions t ON c.customer_id = t.customer_id WHERE t.transaction_date >= DATEADD(year, -1, GETDATE()) GROUP BY c.name;
SELECT AVG(DATEDIFF(completion_date, issue_date)) FROM building_permits bp JOIN project_timelines pt ON bp.permit_number = pt.project_id WHERE bp.project_state = 'Washington' AND pt.project_type = 'Sustainable';
SELECT r.name, AVG(rfr.cost) as avg_cost, SUM(rfr.length) as total_length FROM rural_feeder_roads rfr INNER JOIN regions r ON rfr.region_id = r.id GROUP BY r.name;
SELECT site_id, material_date, SUM(quantity) OVER (PARTITION BY site_id ORDER BY material_date) as total_quantity FROM materials;
SELECT SUM(revenue) FROM Menu_Item WHERE is_organic = true;
SELECT mining_companies.company_name, SUM(mining_operations.energy_consumption) AS total_energy_consumption FROM mining_companies JOIN mining_operations ON mining_companies.company_id = mining_operations.company_id GROUP BY mining_companies.company_name; SELECT AVG(energy_consumption) AS average_energy_consumption FROM mining_operations;
SELECT h.county, COUNT(h.id) FROM healthcare_providers h JOIN counties c ON h.county = c.county WHERE c.population > 15000 GROUP BY h.county;
SELECT SUM(length) as total_length FROM songs WHERE genre = (SELECT genre FROM genres WHERE genre = 'pop');
SELECT MIN(personnel) FROM military_personnel WHERE division = 'Africa';
SELECT MAX(amount) FROM investments WHERE sector = 'renewable energy';
SELECT MIN(account_balance) FROM midwest_region WHERE account_type = 'Traditional Lending';
SELECT region, COUNT(*) FROM eco_accommodations GROUP BY region;
SELECT country, SUM(CASE WHEN technology = 'Optical' THEN 1 ELSE 0 END) as optical, SUM(CASE WHEN technology = 'Electrochemical' THEN 1 ELSE 0 END) as electrochemical, SUM(CASE WHEN technology = 'Mass Spectrometry' THEN 1 ELSE 0 END) as mass_spectrometry FROM biosensors.patents WHERE country IN ('USA', 'China') GROUP BY country;
SELECT MAX(gas_limit) FROM erc20_transactions WHERE to_address = '0x1234567890123456789012345678901234567890';
SELECT AVG(cargo_handling.waiting_time) as avg_waiting_time FROM cargo_handling WHERE cargo_handling.port_code = 'NY';
SELECT dz.zone, cs.crime_type, cs.frequency FROM disaster_zones dz JOIN crime_stats cs ON dz.id = cs.zone_id;
SELECT SUM(streams.revenue) FROM streams INNER JOIN artists ON streams.artist_id = artists.artist_id WHERE artists.genre = 'Latin';
SELECT Country, SUM(SpendingAmount) as TotalSpending FROM Budget WHERE Year BETWEEN EXTRACT(YEAR FROM CURRENT_DATE)-5 AND EXTRACT(YEAR FROM CURRENT_DATE) GROUP BY Country;
SELECT Title FROM Artworks WHERE ArtworkID = 3;
SELECT s.State, COUNT(DISTINCT f.StationID) as StationCount, COUNT(DISTINCT fi.IncidentID) as IncidentCount FROM States s JOIN FireStations f ON s.StateID = f.StateID LEFT JOIN FireIncidents fi ON f.StationID = fi.StationID WHERE fi.IncidentDate >= DATEADD(year, -1, GETDATE()) GROUP BY s.State;
SELECT team, SUM(tickets_sold) as total_tickets_sold FROM ticket_sales WHERE season = 2022 GROUP BY team;
SELECT incident_category, incident_count FROM SecurityIncidents ORDER BY incident_count DESC;
SELECT state, MIN(avg_weight) FROM (SELECT state, AVG(weight) as avg_weight FROM packages p JOIN warehouses w ON p.warehouse_id = w.id WHERE w.region = 'east' GROUP BY state) sub GROUP BY state;
SELECT EXTRACT(DOW FROM publication_date) AS day_of_week, COUNT(*) AS count FROM articles WHERE EXTRACT(YEAR FROM publication_date) = 2022 GROUP BY day_of_week;
SELECT vendors.vendor_name FROM vendors JOIN products ON vendors.vendor_id = products.vendor_id WHERE vendors.state = 'Illinois' AND products.price = (SELECT MAX(price) FROM products WHERE products.vendor_id = vendors.vendor_id);
SELECT MIN(transaction_date) FROM transactions WHERE account_number = 987654321;
SELECT artist, ROW_NUMBER() OVER(ORDER BY num_activities DESC) as rank FROM CommunityEngagement WHERE rank <= 2;
SELECT SUM(g.amount) FROM grants g INNER JOIN faculty f ON g.faculty_id = f.faculty_id WHERE f.department = 'Physics' AND f.journal_reviewer = TRUE;
SELECT automation_tech.tech_type, COUNT(automation_tech.tech_id) FROM automation_tech GROUP BY automation_tech.tech_type;
SELECT r.name, SUM(i.violation_count) as total_violations FROM inspections i JOIN restaurants r ON i.restaurant_id = r.restaurant_id WHERE r.location = 'Downtown' GROUP BY r.name;
SELECT state, development_type, SUM(num_developments) FROM sustainable_urbanism GROUP BY state, development_type;
SELECT program_category, COUNT(*) FROM programs WHERE funding_sources LIKE '%Private Donation%' AND funding_sources LIKE '%Corporate Sponsorship%' GROUP BY program_category;
SELECT ota_id, SUM(revenue) as total_revenue FROM bookings WHERE region = 'Africa' GROUP BY ota_id;
SELECT player, SUM(goals) FROM scores WHERE year = 2022 GROUP BY player ORDER BY SUM(goals) DESC LIMIT 1;
SELECT user_id FROM (SELECT user_id, meal_date, ROW_NUMBER() OVER (PARTITION BY user_id ORDER BY meal_date) - ROW_NUMBER() OVER (ORDER BY user_id, meal_date) AS grp FROM meals JOIN users ON meals.user_id = users.user_id WHERE users.country = 'Japan') t GROUP BY grp, user_id HAVING COUNT(*) > 1;
SELECT COUNT(DISTINCT Location) FROM DomesticConferences;
SELECT AVG(safety_record) FROM Airbus.FlightSafetyRecords WHERE year = 2019;
SELECT player_name, points FROM nba ORDER BY points DESC;
SELECT SUM(capacity) FROM landfills WHERE country = 'Japan';
SELECT f.name, OF.production FROM farmers f INNER JOIN organic_farms OF ON f.farmer_id = OF.farmer_id WHERE OF.crop = 'Quinoa';
SELECT MAX(duration) FROM virtual_tours WHERE city = 'London' AND country = 'UK';
SELECT * FROM chemicals WHERE production_volume < 400;
SELECT p.name, c.claim_date, c.claim_amount FROM claims c JOIN policyholders p ON c.policyholder_id = p.policyholder_id WHERE c.status = 'Approved';
SELECT name, max_cargo_capacity FROM fleet;
SELECT SUM(Cost) FROM Green_Building_Materials WHERE City = 'Los Angeles' AND Year = 2020 AND Material_Type IN ('Solar Panels', 'Energy-efficient Windows');
SELECT garment, category, quantity, 100.0 * quantity / SUM(quantity) OVER (PARTITION BY category) as percentage FROM sales ORDER BY percentage DESC;
SELECT E.EventCountry, GD.GameName, GD.Genre, SUM(GD.AvgHoursPlayed) AS TotalHoursPlayed, ROW_NUMBER() OVER (PARTITION BY E.EventCountry ORDER BY SUM(GD.AvgHoursPlayed) DESC) AS Rank FROM Players P JOIN EventParticipation EP ON P.PlayerID = EP.PlayerID JOIN EventDates E ON EP.EventID = E.EventID JOIN GameData GD ON P.PlayerID = GD.GameID GROUP BY E.EventCountry, GD.GameName, GD.Genre HAVING COUNT(DISTINCT P.PlayerID) > 1 ORDER BY E.EventCountry, TotalHoursPlayed DESC
SELECT M.MenuCategory, SUM(M.TotalRevenue) as TotalRevenuePerCategory FROM Menus M INNER JOIN Restaurants R ON M.RestaurantID = R.RestaurantID WHERE R.Name = 'H' AND MONTH(M.OrderDate) = 7 AND YEAR(M.OrderDate) = 2021 GROUP BY M.MenuCategory;
SELECT COUNT(*) FROM cases JOIN attorneys ON cases.attorney_id = attorneys.id WHERE attorneys.title = 'Of Counsel';
SELECT MAX(reviews) FROM hotels WHERE country = 'Africa';
SELECT COUNT(*) FROM factories WHERE location = 'Asia' AND fair_trade_certified = true;
SELECT country, COUNT(*) as certifications_count FROM factories_africa WHERE country IN ('Kenya', 'Tanzania', 'Uganda', 'Ethiopia', 'Morocco') GROUP BY country ORDER BY certifications_count DESC LIMIT 3;
SELECT Year, COUNT(SatelliteID) AS TotalSatellites FROM SpaceMissions WHERE Year = 2015 GROUP BY Year;
SELECT AssessmentName, Region, RiskLevel FROM RiskAssessments WHERE Region = 'Middle East' AND AssessmentDate >= DATEADD(month, -6, GETDATE());
SELECT SUM(area_size) FROM marine_protected_areas WHERE location = 'Southern Hemisphere';
SELECT SUM(CASE WHEN country IN ('USA', 'Canada') THEN 1 ELSE 0 END) as total_bases, STRING_AGG(location, ', ') as base_locations FROM MilitaryBases WHERE country IN ('USA', 'Canada');
SELECT (COUNT(*) FILTER (WHERE NOT participated_in_llp)) * 100.0 / COUNT(*) FROM students WHERE district = 'Hillside' AND year = 2021;
SELECT Users.Name, AVG(Workouts.HeartRate) AS AvgWorkoutHeartRate, Users.RestingHeartRate FROM Users JOIN Workouts ON Users.ID = Workouts.UserID WHERE Workouts.Date >= DATEADD(month, -1, GETDATE()) GROUP BY Users.Name, Users.RestingHeartRate;
SELECT AVG(account_balance) FROM customers WHERE region = 'Southeast';
SELECT (COUNT(policies.id) * 100.0 / (SELECT COUNT(*) FROM policies WHERE issue_date BETWEEN '2021-04-01' AND '2021-06-30')) FROM policies JOIN policyholders ON policies.policyholder_id = policyholders.id JOIN zipcodes ON SUBSTRING(policyholders.address FROM 14 FOR 5) = zipcodes.zipcode WHERE zipcodes.area_type = 'Rural' AND policies.issue_date BETWEEN '2021-04-01' AND '2021-06-30';
SELECT AVG(price) FROM item_prices WHERE material = 'Hemp';
SELECT COUNT(*) FROM Visitors WHERE city = 'Beijing' AND repeat_visitor = TRUE AND exhibition_type = 'permanent';
SELECT a.state, m.ei_category, AVG(m.ei_value) AS avg_ei_value FROM australian_states a JOIN mines m ON a.state = m.state GROUP BY a.state, m.ei_category ORDER BY avg_ei_value DESC LIMIT 5;
SELECT AVG(DATEDIFF(exit_strategy.exit_date, company.founding_date)) FROM company JOIN exit_strategy ON company.id = exit_strategy.company_id WHERE company.founder_identity = 'LGBTQ+';
SELECT COUNT(*) FROM arctic_research WHERE budget > 100000;
SELECT COUNT(DISTINCT supplier_id) FROM Ytterbium_Supply WHERE country = 'South Korea' AND year = 2021;
SELECT type, COUNT(*) FROM digital_assets GROUP BY type;
SELECT sector, COUNT(*) FROM climate_finance WHERE location IN ('North America') GROUP BY sector;
SELECT crane.name, MAX(container.weight) FROM crane JOIN port ON crane.port_id = port.port_id JOIN container ON crane.crane_id = container.crane_id WHERE port.name = 'Dubai' GROUP BY crane.name, DATE(container.created_at);
SELECT MAX(landfill_capacity) FROM landfill_capacity WHERE region = 'South Asia' AND year = 2018;
SELECT CityName, Policy, MAX(Impact) FROM PolicyImpact GROUP BY CityName HAVING COUNT(DISTINCT Policy) = 2;
SELECT SUM(NumPieces) FROM ArtSales WHERE GalleryName = 'Metropolitan Art Gallery' AND YEAR(SaleDate) = 2021;
SELECT Region, PERCENTAGE(SUM(OnTime) OVER (PARTITION BY Region) / COUNT(*) OVER (PARTITION BY Region)) as PercentageOnTime FROM ProjectTimeline WHERE Region = 'Central' AND Year = 2021;
SELECT AVG(price) FROM Menu WHERE cuisine = 'Italian' AND type = 'Vegan';
SELECT material, SUM(quantity) FROM product GROUP BY material;
SELECT AVG(hours) as avg_hours FROM Volunteers WHERE age BETWEEN 13 AND 19;
SELECT EmployeeID, FirstName, LastName, (CASE WHEN Position = 'Avionics Engineer' THEN 'Senior Avionics Engineer' ELSE Position END) AS NewPosition, Department FROM Employees WHERE Department = 'Avionics';
SELECT r.name, AVG(fv.vaccinations) FROM flu_vaccinations fv JOIN mexico_regions r ON fv.region_id = r.id GROUP BY r.name;
SELECT AVG(price) FROM Concerts WHERE state = 'California';
SELECT MIN(total_offset) FROM carbon_offset_initiatives WHERE state = 'California';
SELECT SUM(population) FROM City WHERE population_density > 5000;
SELECT COUNT(*) FROM Menu WHERE Restaurant = 'Sushi S' AND Vegan = TRUE;
SELECT AVG(response_time) FROM public.police_calls WHERE city = 'Los Angeles';
SELECT department, state, SUM(amount) as total_spending FROM spending WHERE year = 2021 AND department = 'Education' GROUP BY department, state;
SELECT d.district_name, AVG(s.mental_health_score) as avg_score FROM students s JOIN districts d ON s.district_id = d.district_id GROUP BY s.district_id ORDER BY avg_score DESC;
SELECT location, running_time FROM marathons WHERE country = 'Germany' ORDER BY running_time ASC LIMIT 3;
SELECT line_name, stations AS highest_stations FROM train_lines ORDER BY stations DESC LIMIT 1; SELECT line_name, stations AS lowest_stations FROM train_lines ORDER BY stations ASC LIMIT 1;
SELECT COUNT(*) FROM treatment WHERE treatment_name = 'Cognitive Behavioral Therapy' AND treatment_center = 'clinic_b';
SELECT SmartCityInitiatives.InitiativeName, SUM(SmartCityCosts.Cost) AS TotalCost, SUM(SmartCitySavings.Savings) AS TotalSavings FROM SmartCityInitiatives INNER JOIN SmartCityCosts ON SmartCityInitiatives.InitiativeID = SmartCityCosts.InitiativeID INNER JOIN SmartCitySavings ON SmartCityInitiatives.InitiativeID = SmartCitySavings.InitiativeID GROUP BY SmartCityInitiatives.InitiativeName;
SELECT destination, COUNT(*) as tourist_count FROM cultural_tourists WHERE nationality = 'USA' GROUP BY destination ORDER BY tourist_count DESC LIMIT 3;
SELECT AVG(event_count) FROM participation WHERE region = 'American';
SELECT COUNT(*) FROM Members WHERE ID IN (SELECT MemberID FROM Yoga INTERSECT SELECT MemberID FROM Cycling);
SELECT manufacturer, SUM(quantity) FROM manufacturer_sales WHERE vehicle_type = 'EV' GROUP BY manufacturer;
SELECT capacity FROM landfill_capacity WHERE country = 'India' AND year = 2022;
SELECT MAX(DonationAmount) FROM Donations WHERE MONTH(DonationDate) = 7;
SELECT shipping_mode, COUNT(shipping_mode) AS count FROM shipments WHERE shipment_date BETWEEN '2021-01-01' AND '2021-12-31' GROUP BY shipping_mode ORDER BY count DESC LIMIT 3;
SELECT farm_id, AVG(soil_moisture) AS avg_moisture FROM farm_soil_moisture WHERE timestamp >= NOW() - INTERVAL '1 year' GROUP BY farm_id ORDER BY avg_moisture DESC LIMIT 3;
SELECT SUM(Duration) FROM Workouts WHERE MemberID = 2 AND YEAR(WorkoutDate) = 2020;
SELECT region, SUM(cost) FROM climate_adaptation WHERE year = 2017 AND region = 'Southeast Asia' GROUP BY region;
SELECT SUM(value) FROM ArtPieces WHERE style = 'Impressionism';
SELECT warehouse_id, MAX(delivery_time) - MIN(delivery_time) FROM Shipment GROUP BY warehouse_id;
SELECT project_name FROM green_building_projects WHERE city = 'Toronto';
SELECT * FROM High_Risk_Travel_Advisories WHERE country = 'Canada';
SELECT SUM(s.sale_quantity) as total_sales_of_organic_skincare FROM sales s JOIN products p ON s.product_id = p.product_id WHERE p.category = 'skincare' AND p.is_organic = true AND s.sale_country IN ('FR', 'DE');
SELECT AVG(funding_amount) FROM companies WHERE industry = 'Technology' AND founding_date > '2010-01-01';
SELECT agency, SUM(value) as total_contract_value FROM defense_contracts_v2 WHERE value > 0 GROUP BY agency ORDER BY total_contract_value DESC;
SELECT gender, AVG(weight) as avg_weight, STDDEV(weight) as stddev_weight FROM weights JOIN members ON weights.member_id = members.id WHERE members.gender = 'non-binary' GROUP BY gender;
SELECT SUM(count) FROM vehicle_counts WHERE region = 'south' AND (vehicle_type = 'buses' OR vehicle_type = 'trams');
SELECT COUNT(*) FROM songs WHERE genre_id = (SELECT genre_id FROM genres WHERE genre = 'Rock') AND release_year BETWEEN 1990 AND 2000;
SELECT DefenseSpending.country, DefenseSpending.spending, (DefenseSpending.spending / (SELECT SUM(spending) FROM DefenseSpending WHERE DefenseSpending.year = 2022 AND DefenseSpending.country IN ('USA', 'UK', 'France', 'Germany', 'Italy'))) * 100 as percentage FROM DefenseSpending WHERE DefenseSpending.year = 2022 AND DefenseSpending.country IN ('USA', 'UK', 'France', 'Germany', 'Italy');
SELECT Year, COUNT(*) as NumExhibitions FROM Exhibitions WHERE Region = 'Asia' GROUP BY Year;
SELECT COUNT(*) FROM clinical_trials WHERE category = 'Cardiovascular' AND EXTRACT(MONTH FROM approval_date) BETWEEN 1 AND 6 AND EXTRACT(YEAR FROM approval_date) = 2020;
SELECT SUM(Inventory.quantity) FROM Inventory JOIN Orders ON Inventory.item_id = Orders.item_id WHERE (Orders.customer_country = 'USA' OR Orders.customer_country = 'Canada') AND Inventory.item_size = 16;
SELECT country, year, cost FROM (SELECT country, year, cost, RANK() OVER (PARTITION BY continent ORDER BY cost DESC) as dam_rank FROM Dams WHERE continent = 'Asia') tmp WHERE dam_rank <= 3;
SELECT MAX(revenue) FROM restaurants;
SELECT country, SUM(num_employees) FROM mining_sites GROUP BY country;
SELECT capacity FROM landfill_capacity WHERE region = 'eastern' AND year = 2022;
SELECT MIN(donation_amount) FROM donations WHERE country = 'India' AND YEAR(donation_date) = 2019;
SELECT f.name, p.crop FROM Farmers f INNER JOIN Plots p ON f.id = p.farmer_id INNER JOIN Crops c ON p.crop = c.name WHERE f.location = 'Texas';
SELECT AVG(height) FROM players WHERE position = 'Guard' AND league = 'NBA' AND gender = 'Female';
SELECT hotel_name FROM ai_adoption WHERE region = 'EMEA' AND ai_adoption_date = (SELECT MIN(ai_adoption_date) FROM ai_adoption WHERE region = 'EMEA');
SELECT species, AVG(temperature) FROM ArcticWildlifeReserve GROUP BY species;
SELECT Country, ImmunizationRate FROM ImmunizationRates WHERE Disease = 'Measles' AND Year = 2018;
SELECT medium, SUM(value) as total_value FROM artworks GROUP BY medium;
SELECT SUM(amount) FROM investments JOIN companies ON investments.company_id = companies.id WHERE investments.investment_round = 'Series A' AND companies.founder_gender = 'Female' AND companies.location = 'Latin America';
SELECT SUM(investment_amount) FROM climate_communication_projects WHERE location LIKE 'Central America' AND investment_year IN (2019, 2020);
SELECT product_type, SUM(amount) as total_financing FROM ShariahFinance WHERE bank_name LIKE '%Middle East%' AND YEAR(issue_date) = 2021 GROUP BY product_type HAVING SUM(amount) > 1000000;
SELECT region, ((current_temp - prev_temp) * 100.0 / prev_temp) as pct_change FROM (SELECT region, temperature as current_temp, LAG(temperature) OVER (PARTITION BY region ORDER BY month) as prev_temp FROM monthly_temp) subquery;
SELECT COUNT(*) AS total_properties, AVG(price) AS avg_price FROM Properties WHERE state = 'Washington';
SELECT AVG(rating) as avg_rating FROM MOVIES WHERE production_studio = 'Studio Ghibli';
SELECT NeighborhoodName, COUNT(*) AS InclusivePropertiesCount FROM Properties JOIN Neighborhoods ON Properties.NeighborhoodID = Neighborhoods.NeighborhoodID WHERE InclusiveHousing = 1 GROUP BY NeighborhoodName;
SELECT SUM(revenue) FROM restaurant_revenue WHERE menu_category = 'Desserts' AND order_date >= '2021-04-01' AND order_date <= '2021-06-30';
SELECT b.name, COUNT(l.id) as loan_count FROM bank b JOIN loans l ON b.id = l.bank_id GROUP BY b.name ORDER BY loan_count DESC LIMIT 3;
SELECT SUM(biomass) FROM plankton WHERE ocean = 'Atlantic';
SELECT MAX(capacity) FROM smart_grids;
SELECT archaeologist_name, region, MAX(num_discoveries) FROM Regional_Archaeologists GROUP BY region;
SELECT MAX(articles) FROM daily_articles_by_category WHERE category = 'politics';
SELECT AVG(playtime) FROM player_sessions WHERE uses_vr = true AND game_genre = 'racing';
SELECT AVG(Salary) FROM Employees WHERE Department = 'IT';
SELECT s.name AS state_name, r.cases AS tb_cases FROM states s INNER JOIN tb_reports r ON s.id = r.state_id WHERE r.year = 2020 GROUP BY s.name;
SELECT continent, AVG(life_expectancy) FROM life_expectancy GROUP BY continent;
SELECT MAX(salinity) FROM salinity_readings SR JOIN shrimp_farms SF ON SR.farm_id = SF.id WHERE SF.region = 'Gulf of Mexico';
SELECT community, SUM(attendees) AS total_attendance FROM events WHERE community IN ('Haida', 'Inuit', 'Metis', 'Cree', 'Blackfoot') GROUP BY community;
SELECT SUM(cost) AS total_cost, AVG(cost) AS avg_cost FROM ElectricVehicles WHERE state = 'California' AND type LIKE '%Electric%';
SELECT name, production_metric FROM mines WHERE location = 'California';
SELECT Program, COUNT(*) as NumberOfVolunteers FROM Volunteers GROUP BY Program;
SELECT STDDEV(co2_emission) FROM RecycledNylonGarments;
SELECT AVG(num_patients) AS avg_patients_per_center, COUNT(*) FILTER (WHERE num_patients > 5000) AS centers_with_more_than_5000_patients FROM rural_health_centers WHERE country IN (SELECT name FROM countries WHERE continent = 'Asia');
SELECT City.name, City.state FROM City ORDER BY City.population DESC LIMIT 1;
SELECT MIN(steps) as min_steps_per_day FROM steps JOIN users ON steps.user_id = users.id WHERE country = 'Japan';
SELECT ContractorName FROM Contractors C JOIN Projects P ON C.ContractorID = P.ContractorID WHERE P.EndDate < DATEADD(day, DateDiff(day, P.StartDate, P.EndDate) / 2, P.StartDate);
SELECT DISTINCT company_name FROM Collective_Bargaining WHERE union_agreement_status = 'Active';
SELECT SUM(investment_amount) FROM investments JOIN startups ON investments.startup_id = startups.id WHERE startups.founder_identity = 'Female' AND startups.industry = 'Fintech';
SELECT AVG(CASE WHEN patient_outcomes.outcome = 'Improved' THEN 1.0 ELSE 0.0 END) FROM patient_outcomes INNER JOIN support_groups ON patient_outcomes.group_id = support_groups.group_id WHERE support_groups.location = 'USA';
SELECT MIN(Launch_Date) FROM Satellites;
SELECT COUNT(*) FROM marine_species WHERE location = 'Arctic Ocean';
SELECT SUM(expertise = 'Explainable AI') as explainable_ai_count, SUM(expertise = 'Creative AI') as creative_ai_count FROM researcher;
SELECT attorney_id, AVG(billing_amount) FROM attorneys WHERE firm = 'Smith' GROUP BY attorney_id;
SELECT MAX(order_quantity) FROM inventory WHERE material = 'Recycled Polyester';
SELECT name, MAX(pallets_handled) FROM Warehouse WHERE quarter = 1 AND year = 2022 GROUP BY name;
SELECT 100.0 * COUNT(DISTINCT visitor_id) / (SELECT COUNT(DISTINCT visitor_id) FROM visitors WHERE visit_date BETWEEN '2020-01-01' AND '2020-12-31') AS percentage FROM visits WHERE visit_date BETWEEN '2020-01-01' AND '2020-12-31';
SELECT d.district_name, SUM(CASE WHEN s.school_type = 'Public' THEN 1 ELSE 0 END) AS public_schools, SUM(CASE WHEN s.school_type = 'Private' THEN 1 ELSE 0 END) AS private_schools, AVG(CASE WHEN s.school_type = 'Public' THEN s.passing_rate ELSE 0 END) AS public_passing_rate, AVG(CASE WHEN s.school_type = 'Private' THEN s.passing_rate ELSE 0 END) AS private_passing_rate FROM districts d JOIN schools s ON d.district_id = s.district_id GROUP BY d.district_id;
SELECT s.subject_name, COUNT(DISTINCT t.teacher_id) as num_teachers, COUNT(c.course_id) as total_courses_completed FROM subjects s LEFT JOIN teachers t ON s.subject_id = t.subject_id LEFT JOIN courses c ON t.teacher_id = c.teacher_id GROUP BY s.subject_id;
SELECT p.PlayerName, gd.GameName, gd.GameGraphics FROM Players p INNER JOIN GameDesign gd ON p.GameName = gd.GameName WHERE p.GameName = 'Galactic Conquest';
SELECT location, AVG(dissolved_oxygen) as avg_dissolved_oxygen FROM dissolved_oxygen_readings WHERE year >= (SELECT MAX(year) - 3 FROM dissolved_oxygen_readings) GROUP BY location;
SELECT h.name habitat, AVG(t.age) avg_age FROM trees t JOIN wildlife_habitats h ON t.habitat_id = h.id GROUP BY h.name;
SELECT AVG(inventory.caloric_content) FROM inventory JOIN products ON inventory.product_id = products.product_id JOIN retailers ON inventory.retailer_id = retailers.retailer_id WHERE products.is_organic = TRUE AND retailers.region = 'Northeast';
SELECT COUNT(*) FROM tours WHERE city = 'New York City' AND is_sustainable = true;
SELECT Gender, AVG(TotalSpent) as Avg_Ticket_Spending FROM TicketSpending GROUP BY Gender;
SELECT AVG(num_employees) FROM gold_mines WHERE location = 'Canada';
SELECT AVG(attendance) FROM events WHERE category = 'historical' AND price > 30;
SELECT SUM(amount) FROM climate_finance_re WHERE region = 'Asia' AND source IN ('Wind', 'Solar'); SELECT COUNT(*) FROM climate_adaptation_re WHERE region = 'Asia';
SELECT curator, COUNT(*) as total_exhibitions FROM Exhibitions GROUP BY curator;
SELECT year, AVG(quantity) as avg_quantity FROM production_yearly WHERE element = 'Europium' GROUP BY year
SELECT dispensary_name, sales_quantity FROM dispensaries WHERE sales_channel = 'edibles' AND state IN ('Colorado', 'Washington') ORDER BY sales_quantity DESC LIMIT 2;
SELECT name FROM marine_species WHERE habitat = 'Pacific Ocean';
SELECT treatment_type, COUNT(*) as count FROM treatments WHERE age BETWEEN 40 AND 50 GROUP BY treatment_type ORDER BY count DESC LIMIT 1;
SELECT team_name, player_name, SUM(goals) OVER (PARTITION BY team_name) as total_goals, RANK() OVER (PARTITION BY team_name ORDER BY SUM(goals) DESC) as rank  FROM epl_players  WHERE league = 'EPL'  GROUP BY team_name, player_name  ORDER BY team_name, total_goals DESC, rank;
SELECT (COUNT(*)) / (SELECT COUNT(*) FROM patients WHERE patients.state = 'California') * 100.0 AS percentage FROM patients WHERE patients.state = 'California' AND patients.condition = 'Anxiety';
SELECT v.type, MIN(i.inspection_date) as earliest_date FROM vessels v JOIN inspections i ON v.id = i.vessel_id GROUP BY v.type;
SELECT animal_name, program, added_date FROM animal_population WHERE added_date >= DATEADD(WEEK, -1, GETDATE());
SELECT artifact_type, COUNT(*) AS count FROM artifacts WHERE site_id = (SELECT site_id FROM excavation_sites WHERE site_name = 'site_d') GROUP BY artifact_type ORDER BY count DESC LIMIT 1;
SELECT well_name, gas_production_2020 as gas_production FROM well WHERE shale_play = 'Bakken' ORDER BY gas_production_2020 DESC LIMIT 2;
SELECT COUNT(*) FROM workout_records WHERE workout_date BETWEEN '2022-01-01' AND '2022-12-31';
SELECT SUM(total_distance) FROM public_buses WHERE city = 'London' AND YEAR(start_time) = 2021;
SELECT machines.machine_id, machines.type, machines.schedule FROM machines RIGHT JOIN factories ON machines.factory_id = factories.factory_id WHERE factories.initiative IS NULL;
SELECT DISTINCT category FROM Products INNER JOIN FairTradeCertifications ON Products.product_id = FairTradeCertifications.product_id WHERE FairTradeCertifications.certified = TRUE;
SELECT AVG(potency) FROM strains WHERE strain_type = 'Sativa' AND state = 'Washington';
SELECT SUM(quantity_sold) FROM sales INNER JOIN suppliers ON sales.supplier_id = suppliers.supplier_id WHERE suppliers.follows_ethical_practices = TRUE;
SELECT * FROM Machines WHERE Status != 'Operational';
SELECT region, COUNT(*) as region_projects, (COUNT(*) / (SELECT total_projects FROM total_projects)) as percentage FROM climate_projects WHERE project_type = 'adaptation' GROUP BY region;
SELECT vendor, MAX(price) FROM VendorFabrics WHERE fabric LIKE '%sustainable%' GROUP BY vendor;
SELECT SUM(g.production_cost) FROM garments g WHERE g.certification_id = 3;
SELECT AVG(Citations) as Average_Citations FROM Creative_AI_Applications WHERE Field = 'Arts';
SELECT region, SUM(biomass) FROM salmon_farms GROUP BY region HAVING AVG(temperature) > 15;
SELECT SUM(co2_reduction_tons) AS total_reduction, COUNT(*) FILTER (WHERE co2_reduction_tons > 5000) AS num_programs_over_5000 FROM australia_offset_programs;
SELECT region, SUM(count) FROM transportation_fleet GROUP BY region;
SELECT SUM(budget) FROM city_budgets WHERE city = 'Miami' AND (service = 'Healthcare' OR service = 'Infrastructure') AND year = 2025;
SELECT title FROM tv_shows ORDER BY runtime DESC LIMIT 1;
SELECT SUM(Quantity) FROM (SELECT * FROM ManufacturerMaterials JOIN Manufacturers ON ManufacturerMaterials.ManufacturerID = Manufacturers.ManufacturerID WHERE Spending IN (SELECT MIN(Spending) FROM Manufacturers LIMIT 2)) AS LowSpendingManufacturers JOIN Materials ON ManufacturerMaterials.MaterialID = Materials.MaterialID WHERE Materials.Type = 'Non-Sustainable';
SELECT state, COUNT(*) FROM genetics_stats.research_projects GROUP BY state;
SELECT species, SUM(volume) as total_volume FROM forests WHERE year IN (2018, 2019) GROUP BY species;
SELECT name, location, budget FROM rural_infrastructure WHERE location = 'India' AND budget > 500000;
SELECT AVG(energy_efficiency_rating) FROM buildings WHERE state = 'California' AND building_type = 'Commercial';
SELECT COUNT(*) FROM makeup_sales WHERE is_cruelty_free = true AND sale_date BETWEEN '2021-04-01' AND '2021-06-30';
SELECT mode, SUM(ridership) FROM TOPublicTransportation WHERE date = '2022-03-01' GROUP BY mode;
SELECT i.name, SUM(p.budget) as total_budget FROM infrastructure_projects i INNER JOIN project_budgets p ON i.id = p.project_id GROUP BY i.id;
SELECT o.menu_item_name, COUNT(o.order_id) as total_orders FROM orders o INNER JOIN customers c ON o.customer_id = c.customer_id WHERE c.diet_preference = 'vegetarian' GROUP BY o.menu_item_name ORDER BY total_orders DESC LIMIT 10;
SELECT (SUM(number_of_tourists) - LAG(SUM(number_of_tourists)) OVER (PARTITION BY visitor_country ORDER BY date)) / LAG(SUM(number_of_tourists)) OVER (PARTITION BY visitor_country ORDER BY date) * 100.0 as percentage_change FROM tourism WHERE host_country = 'Australia' AND visitor_country = 'United States';
SELECT animals.status, AVG(habitats.size) AS avg_size FROM animals INNER JOIN habitats ON animals.id = habitats.animal_id WHERE animals.status = 'Endangered' GROUP BY animals.status;
SELECT YEAR(drill_date) AS Year, COUNT(*) AS Number_of_wells FROM indian_ocean_wells GROUP BY YEAR(drill_date);
SELECT StrainName, THCResult FROM (SELECT StrainName, THCResult, ROW_NUMBER() OVER(ORDER BY THCResult DESC) as rn FROM StrainLabResults WHERE Lab IN ('Colorado Lab', 'California Lab')) t WHERE rn <= 5;
SELECT department_name, SUM(budget_allocated) as total_budget FROM Departments GROUP BY department_name;
SELECT establishment_year, COUNT(*) FROM marine_protected_areas GROUP BY establishment_year;
SELECT customer_id, MAX(transaction_value) FROM financial_crimes GROUP BY customer_id;
SELECT operation_name, AVG(budget) as avg_budget FROM military_operations GROUP BY operation_name ORDER BY avg_budget DESC;
SELECT don_id, don_name FROM donor WHERE don_id IN (SELECT don_id FROM (SELECT don_id, COUNT(DISTINCT org_id) as num_orgs FROM donation GROUP BY don_id) WHERE num_orgs > 1);
SELECT COUNT(*) FROM rigs WHERE location = 'North Sea' AND status = 'active' AND start_date <= '2021-02-01' AND end_date >= '2021-02-28';
SELECT item, sodium FROM MenuItems WHERE popularity > 70 ORDER BY sodium DESC;
SELECT DISTINCT method FROM org_comms WHERE org_size IN ('medium', 'extra_large');
SELECT name, budget FROM programs WHERE state = 'California' AND budget > 1000000.0 ORDER BY budget DESC;
SELECT SUM(production) FROM hydro_plants WHERE region = 'SouthAmerica' AND built_year < 2010;
SELECT d.DonationAmount AS MinimumDonationAmount FROM (SELECT DonorID, ROW_NUMBER() OVER (ORDER BY SUM(DonationAmount) DESC) AS Ranking FROM Donations GROUP BY DonorID) r JOIN Donations d ON r.DonorID = d.DonorID WHERE r.Ranking <= 10;
SELECT Museums.name FROM Museums INNER JOIN Exhibitions ON Museums.id = Exhibitions.museum_id WHERE Exhibitions.city IN ('New York', 'Chicago') GROUP BY Museums.name HAVING COUNT(DISTINCT Exhibitions.city) = 2;
SELECT EventLocations.Country, AVG(Events.Attendance) FROM Events INNER JOIN EventLocations ON Events.EventID = EventLocations.EventID GROUP BY EventLocations.Country;
SELECT country, SUM(num_beds) FROM hospital_beds GROUP BY country;
SELECT CASE WHEN GamePreference = 'VR' THEN 'VR' ELSE 'Non-VR' END AS GamePreference, ROUND(COUNT(*) * 100.0 / (SELECT COUNT(*) FROM Players), 1) AS Percentage FROM Players GROUP BY GamePreference;
SELECT COUNT(*) FROM workers WHERE industry = 'Education' AND union_member = true AND salary > 60000;
SELECT AVG(artworks) FROM collections WHERE name LIKE '%Oceania%';
SELECT SUM(amount) FROM investments WHERE investment_date >= '2021-01-01' AND investment_date < '2022-01-01';
SELECT i.name, i.location, i.status FROM intangible_heritage i WHERE i.status = 'Masterpiece';
SELECT brand_id, brand_name, ((products_this_year - products_last_year) * 100.0 / products_last_year) as growth_percentage FROM brands WHERE (products_this_year - products_last_year) > 0.5 * products_last_year ORDER BY growth_percentage DESC;
SELECT company_id, SUM(amount) as total_funding FROM Funding WHERE funding_year = 2017 GROUP BY company_id ORDER BY total_funding DESC;
SELECT COUNT(Publications) FROM GraduateStudents WHERE Department = 'Mathematics' AND PublicationYear = 2020;
SELECT DISTINCT agency FROM spacecraft WHERE YEAR(launch_date) < 2000;
SELECT SUM(amount) FROM climate_finance WHERE year = 2020 AND (donor IN ('USA', 'Germany', 'France') AND recipient IN ('India', 'Brazil', 'Indonesia', 'South Africa') AND category IN ('mitigation', 'adaptation'));
SELECT SUM(Value) FROM ClientInvestments CI JOIN Clients C ON CI.ClientID = C.ClientID WHERE C.State = 'TX' AND InvestmentType = 'Bond';
SELECT AVG(quantity_on_hand) OVER (PARTITION BY product_name ORDER BY quantity_on_hand DESC) FROM inventory;
SELECT * FROM Farm WHERE region = 'Northern' AND crop = 'Corn' AND yield_per_acre >= (SELECT 1.1 * avg_yield FROM Average WHERE crop = 'Corn');
SELECT policy_name, description FROM policy WHERE policy_name LIKE '%Service Animal%';
SELECT platform_name, SUM(oil_production_q4_2021) as total_oil_production FROM platform GROUP BY platform_name;
SELECT * FROM ExcavationArtifacts;
SELECT a.team_name, b.team_name as opponent FROM matches a JOIN teams b ON a.team_id = b.team_id JOIN matches c ON b.team_id = c.opponent_id WHERE a.season = '2019' OR c.season = '2019';
SELECT e.region, AVG(e.price) as avg_region_price FROM energy_prices e WHERE e.region = 'New York' AND e.date BETWEEN '2023-01-01' AND '2023-01-05' GROUP BY e.region;
SELECT COUNT(*) FROM clinics WHERE country IN ('Canada', 'Mexico') AND offers_mental_health = TRUE;
SELECT country, COUNT(*) AS launched_satellites FROM satellites WHERE EXTRACT(YEAR FROM launch_date) = 2010 GROUP BY country ORDER BY launched_satellites DESC LIMIT 1;
SELECT astronaut_name FROM Astronauts WHERE astronaut_country = 'India' ORDER BY total_time_in_space DESC LIMIT 1;
SELECT SUM(CO2_Emission) FROM Fossil_Fuel_Vehicles WHERE Country = 'Canada';
SELECT AVG(depth) FROM ocean_floor_depth WHERE location = 'Pacific Ocean Floor';
SELECT SUM(revenue) FROM sales_data WHERE vegan = true AND region = 'Europe';
SELECT COUNT(*) FROM customers WHERE registration_date BETWEEN '2022-01-01' AND '2022-03-31' INTERSECT SELECT COUNT(*) FROM customers WHERE registration_date BETWEEN '2022-04-01' AND '2022-06-30';
SELECT agency FROM space_agencies_2 WHERE country IN ('India', 'China', 'Japan');
SELECT leader_gender, 100.0 * AVG(CASE WHEN budget = actual_spent AND completion_date <= planned_completion_date THEN 1 ELSE 0 END) as success_rate FROM (SELECT id, leader_gender, budget, completion_date, planned_completion_date, SUM(cost) as actual_spent FROM projects WHERE leader_gender = 'Female' AND date(completion_date) >= date('now','-5 years') GROUP BY id) subquery GROUP BY leader_gender;
SELECT size, COUNT(DISTINCT customer_id) FROM orders o INNER JOIN products p ON o.product_id = p.product_id GROUP BY size;
SELECT accommodation_type, (COUNT(*) * 100.0 / (SELECT COUNT(*) FROM Students)) as percentage FROM Accommodations GROUP BY accommodation_type;
SELECT category, production_cost FROM GARMENTS WHERE production_cost > (SELECT AVG(production_cost) FROM GARMENTS);
SELECT AVG(Budget) FROM CommunityEngagement WHERE Location = 'Oceania';
SELECT material, rate FROM recycling_rates WHERE material IN ('plastic', 'metal') AND region != 'North';
SELECT mission FROM mars_missions;
SELECT archaeologists.name FROM archaeologists LEFT JOIN artifact_analysis ON archaeologists.id = artifact_analysis.archaeologist_id WHERE artifact_analysis.archaeologist_id IS NULL;
SELECT Platform, AVG(ReviewScore) AS AvgReviewScore FROM GameReviews GROUP BY Platform;
SELECT MIN(length) FROM songs WHERE genre = 'Rock' AND YEAR(id) >= 2010;
SELECT country, number_of_employees, COUNT(*) as number_of_factories FROM factories GROUP BY country;
SELECT COUNT(*) FROM pallets WHERE warehouse_id = 4 AND received_date BETWEEN '2021-04-01' AND '2021-04-15' AND shipped_date IS NULL;
SELECT COUNT(*) as num_sustainable_items FROM MenuItems WHERE sustainable_source = TRUE;
SELECT district, SUM(number_of_accidents) FROM (SELECT district, COUNT(*) as number_of_accidents FROM traffic_accidents WHERE district IN ('Downtown', 'Capitol Hill', 'Ballard', 'West Seattle', 'Queen Anne') AND reported_date >= '2020-01-01' AND reported_date < '2021-01-01' GROUP BY district) as accidents_by_district GROUP BY district;
SELECT category, event_count FROM community_engagement_by_category;
SELECT MIN(fare) FROM shared_rides_tokyo;
SELECT c.name FROM consumer c JOIN product_review pr ON c.id = pr.consumer_id JOIN product p ON pr.product_id = p.id WHERE pr.rating = 5 AND p.cruelty_free = FALSE;
SELECT SUM(amount) FROM grants WHERE department = 'Arts and Humanities';
SELECT neighborhood, COUNT(*) as num_inclusive_properties FROM properties WHERE inclusive_housing = TRUE GROUP BY neighborhood;
SELECT attorney_last_name, COUNT(*) as case_count FROM criminal_cases GROUP BY attorney_last_name HAVING COUNT(*) > 50;
SELECT COUNT(*) FROM vessel_registry WHERE YEAR(build_date) < 2010;
SELECT MIN(serving_size) FROM Beverages WHERE is_organic = true AND category = 'juice';
SELECT SUM(transaction_value) as total_transaction_value, account_type FROM accounts WHERE transaction_date BETWEEN '2021-01-01' AND '2021-03-31' GROUP BY account_type;
SELECT COUNT(*) FROM CollectiveBargaining WHERE Sector = 'Healthcare' AND SignDate BETWEEN '2016-01-01' AND '2019-12-31';
SELECT AVG(budget) FROM Community_Education;
SELECT project_name, capacity FROM RenewableEnergy WHERE technology = 'Wind';
SELECT MAX(capacity) FROM landfill_capacity WHERE year = 2025 AND country IN ('Nigeria', 'South Africa', 'Egypt', 'Algeria', 'Morocco');
SELECT a.Name, COUNT(m.ID) as Successful_Missions FROM Astronauts a INNER JOIN Missions m ON a.ID = m.Astronaut_ID WHERE m.Status = 'Success' GROUP BY a.Name;
SELECT spacecraft_model FROM SpacecraftManufacturing ORDER BY cost ASC LIMIT 1;
SELECT location, COUNT(*) FROM MarineSpeciesObservations GROUP BY location HAVING COUNT(*) > 10;
SELECT AVG(engagement) FROM virtual_tours_oceania vt JOIN locations_oceania l ON vt.location = l.location WHERE l.region = 'Oceania' AND vt.month = 'January';
SELECT SUM(NumTests) FROM SafetyTestingCounts WHERE Manufacturer = 'FutureAutomobiles';
SELECT sector, COUNT(*) FROM projects WHERE program IN ('food_security', 'shelter') GROUP BY sector;
SELECT AlbumName, ReleaseYear, SUM(Sales) as TotalSales FROM Albums WHERE ReleaseYear < 2000 GROUP BY AlbumName, ReleaseYear;
SELECT AVG(Attendance) FROM Attendance WHERE MuseumName = 'Metropolitan Museum' AND MONTH(VisitDate) = 1;
SELECT MIN(start_date) FROM therapy WHERE patient_id IN (SELECT id FROM patients WHERE country = 'Australia');
SELECT MIN(salary) FROM reporters WHERE city = 'Chicago';
SELECT Country, WaterUsage FROM MiningWaterUsage ORDER BY WaterUsage DESC LIMIT 1; SELECT Country, WaterUsage FROM MiningWaterUsage ORDER BY WaterUsage ASC LIMIT 1;
SELECT SUM(quantity) FROM ingredients WHERE is_sustainable = TRUE;
SELECT c.CountryName, AVG(dsp.Budget) as AvgBudget FROM Countries c JOIN DisabilitySupportPrograms dsp ON c.CountryID = dsp.CountryID GROUP BY c.CountryName;
SELECT country FROM facility WHERE build_date < '2010-01-01';
SELECT * FROM equipment_maintenance WHERE MONTH(maintenance_date) = 6 AND YEAR(maintenance_date) = 2021;
SELECT activity, COUNT(DISTINCT member_id) AS participants FROM participation WHERE participation_date >= '2022-05-01' AND participation_date < '2022-06-01' GROUP BY activity ORDER BY participants DESC LIMIT 5;
SELECT companies.industry, COUNT(worker_salaries.company_id) FROM worker_salaries INNER JOIN companies ON worker_salaries.company_id = companies.company_id WHERE companies.industry = 'technology' GROUP BY companies.industry;
SELECT EXTRACT(MONTH FROM injury_date) as month, MAX(injury_count) as max_injuries FROM injuries WHERE YEAR(injury_date) = 2021 GROUP BY month;
SELECT year FROM Dali WHERE artwork = 'The Persistence of Memory';
SELECT race, ethnicity, COUNT(*) AS count FROM incarcerated GROUP BY race, ethnicity;
SELECT s.name, SUM(p.capacity) FROM projects p JOIN states s ON p.location = s.name GROUP BY s.name;
SELECT SUM(quantity) as total_quantity FROM FishCaught WHERE sea = 'Mediterranean Sea' AND year = 2021;
SELECT DISTINCT device FROM devices.unique_devices WHERE usage_date >= '2022-05-01' AND usage_date <= '2022-05-31';
SELECT DATE_PART('quarter', DonationDate) AS Quarter, COUNT(DISTINCT DonorID) AS NewDonors FROM Donations GROUP BY Quarter;
SELECT h.SiteName, l.Language FROM HeritageSites h JOIN Languages l ON h.Language = l.Language;
SELECT cuisine, COUNT(*) as total_dishes, SUM(is_vegetarian) as vegetarian_dishes FROM dishes GROUP BY cuisine;
SELECT medical_condition, medical_date FROM (SELECT medical_condition, medical_date, NTILE(4) OVER (ORDER BY medical_date) as medical_group FROM medical) AS subquery WHERE medical_group = 4;
SELECT SUM(quantity_sold) FROM menu_items WHERE item_name = 'Pizza';
SELECT SUM(s.duration * s.streaming_revenue) FROM Songs s WHERE s.release_year <= 2020 AND s.duration > 180;
SELECT MAX(inspection_date) FROM Bridges WHERE name = 'Suspension';
SELECT AVG(dissolved_oxygen) FROM atlantic_ocean_fish WHERE region = 'Atlantic Ocean' AND species LIKE 'tropical%' AND year = 2022;
SELECT Species, PollutionLevel FROM PollutionIncidents WHERE PollutionLevel = (SELECT MAX(PollutionLevel) FROM PollutionIncidents);
SELECT type, artist, COUNT(*) FROM ArtDistribution GROUP BY type, artist;
SELECT initiative_name FROM lending_initiatives WHERE YEAR(launch_date) < 2015;
SELECT species_name, population FROM Research.Species WHERE population > (SELECT AVG(population) FROM Research.Species);
SELECT name, location, depth FROM (SELECT name, location, depth, ROW_NUMBER() OVER (ORDER BY depth DESC) as rn FROM marine_protected_areas) t WHERE rn <= 3;
SELECT AVG(price) FROM ArtsAndCrafts WHERE location = 'Asia';
SELECT customer_id, COUNT(*) as num_purchases FROM CustomerOrders WHERE product = 'Sustainable T-Shirt' AND order_date >= DATEADD(year, -1, CURRENT_DATE) GROUP BY customer_id ORDER BY num_purchases DESC;
SELECT squadron, SUM(aircraft_count) as total_aircraft FROM AircraftSquadrons GROUP BY squadron;
SELECT SUM(sales.revenue) as total_revenue FROM sales JOIN products ON sales.product_id = products.product_id WHERE products.is_organic = TRUE AND sales.country = 'Asia' AND YEAR(sales.sale_date) = YEAR(CURDATE());
SELECT products.product_category, AVG(products.is_vegan) * 100.0 as percentage_vegan FROM products GROUP BY products.product_category;
SELECT material, production_cost FROM materials ORDER BY production_cost DESC LIMIT 1;
SELECT MAX(likes) FROM posts WHERE content LIKE '%fitness%' AND created_at > '2022-01-15' AND schema='social_media';
SELECT SUM(cost) FROM military_equipment WHERE vendor = 'Tactical Technologies';
SELECT name FROM rural_development.innovation_projects WHERE funding_source = 'Grant';
SELECT AVG(size) FROM AffordableHousing WHERE city = 'Seattle';
SELECT MI1.menu_item, MI1.menu_category FROM menu_items MI1 LEFT JOIN menu_items MI2 ON MI1.quantity_sold < MI2.quantity_sold WHERE MI2.menu_item IS NULL;
SELECT c.cause, SUM(d.amount) as total_donated FROM donations d JOIN causes c ON d.cause = c.cause WHERE c.created_at >= DATEADD(year, -1, CURRENT_TIMESTAMP) GROUP BY c.cause ORDER BY total_donated DESC;
SELECT dance_form FROM UNESCO_Intangible_Heritage WHERE year = 2010;
SELECT SUM(waste_kg) FROM waste_generation WHERE region = 'Beijing' AND year = 2018;
SELECT c.course_name, SUM(CASE WHEN p.pass_fail = 'PASS' THEN 1 ELSE 0 END) as num_passed, SUM(CASE WHEN p.pass_fail = 'FAIL' THEN 1 ELSE 0 END) as num_failed FROM courses c JOIN professional_development p ON c.course_id = p.course_id GROUP BY c.course_name ORDER BY num_passed DESC;
SELECT satellite_name, launch_year, launch_country FROM satellites WHERE launch_company IN ('SpaceX', 'OneWeb');
SELECT AVG(Price) FROM (SELECT Price FROM Artworks WHERE ArtCountry = 'India' AND GalleryID IN (SELECT GalleryID FROM Galleries WHERE EstablishDate < '1990-01-01')) AS art_gallery_data;
SELECT CourtName, CaseType, CaseStatus, Year, SUM(NumCases) FROM CourtCases WHERE City = 'Chicago' GROUP BY CourtName, CaseType, CaseStatus, Year;
SELECT name, provider FROM virtual_tours WHERE country = 'Japan';
SELECT citizen_id, service_id FROM feedback;
SELECT type, SUM(frequency) as total_frequency FROM threats WHERE ip_address = '192.168.0.1' GROUP BY type ORDER BY total_frequency DESC LIMIT 5;
SELECT instructor_id, COUNT(DISTINCT student_id) as total_students FROM enrollments GROUP BY instructor_id;
SELECT (COUNT(*) * 100.0 / (SELECT COUNT(*) FROM worker_union WHERE country IN ('Germany', 'France') AND sector = 'Retail')) AS unionization_percentage FROM worker_union WHERE is_unionized = true AND country IN ('Germany', 'France') AND sector = 'Retail';
SELECT routes.route_id, AVG(fare_segments.fare) FROM routes INNER JOIN fare_segments ON routes.route_id = fare_segments.route_id WHERE routes.low_income_neighborhood = TRUE GROUP BY routes.route_id;
SELECT AVG(mental_health_score) FROM students WHERE participated_in_open_pedagogy = TRUE;
SELECT artwork_name, creation_year FROM Artworks GROUP BY artwork_name, creation_year HAVING COUNT(*) = 1;
SELECT COUNT(DISTINCT employee_id) as num_changes FROM job_change JOIN employee ON job_change.employee_id = employee.id WHERE change_date >= '2021-01-01' AND change_date < '2022-01-01';
SELECT f.forest_id, f.region_id, SUM(tp.volume) as total_volume FROM forests f INNER JOIN timber_production tp ON f.forest_id = tp.forest_id GROUP BY f.forest_id, f.region_id;
SELECT region, SUM(incidents) as total_incidents FROM incident_regions WHERE timestamp >= '2022-02-01' GROUP BY region;
SELECT MAX(creation_year) FROM Artworks WHERE art_movement = 'Impressionism';
SELECT Region, SUM(Personnel) FROM Military_Personnel GROUP BY Region;
SELECT COUNT(*) FROM climate_communication WHERE region = 'Sub-Saharan Africa' AND target = 'Coastal Communities' AND year BETWEEN 2020 AND 2021;
SELECT author, SUM(word_count) AS total_word_count FROM investigative_journalism GROUP BY author ORDER BY total_word_count DESC LIMIT 3;
SELECT AVG(co2_emissions) FROM co2_emissions WHERE product_name IN ('Leather Jacket', 'Wool Sweater') AND country_of_origin = 'Germany';
SELECT c.price FROM co_ownership c JOIN (SELECT AVG(price) AS avg_price FROM property WHERE location = 'urban') AS p ON 1=1 WHERE c.price > p.avg_price;
SELECT StrainID, SaleDate, QuantitySold, QuantitySold - LAG(QuantitySold) OVER (PARTITION BY StrainID ORDER BY SaleDate) AS DailySalesChange FROM Sales WHERE SaleDate >= DATEADD(month, -1, GETDATE());
SELECT Station.name, SUM(CASE WHEN Employee.role = 'police officer' THEN 1 ELSE 0 END) as total_police, SUM(CASE WHEN Employee.role = 'firefighter' THEN 1 ELSE 0 END) as total_firefighters FROM Station INNER JOIN Employee ON Station.sid = Employee.sid GROUP BY Station.name;
SELECT COUNT(*) FROM Auto_Shows WHERE show_year = 2019 AND location = 'United States';
SELECT SUM(amount) FROM waste_generation WHERE sector = 'commercial' AND year = 2020;
SELECT * FROM worker INNER JOIN department ON worker.department_id = department.id WHERE department.name = 'metalworking' AND worker.salary > 4000;
SELECT AVG(cost) FROM production_costs WHERE item = 'linen pants';
SELECT client_id, name, SUM(investment) OVER (PARTITION BY client_id ORDER BY client_id) as total_investment FROM clients ORDER BY total_investment DESC;
SELECT * FROM humanitarian_operations WHERE organization = 'World Food Programme' AND location LIKE '%Middle East%';
SELECT MAX(price) FROM ev_prices;
SELECT AVG(risk_level) FROM investments WHERE sector = 'green_technology'
SELECT products.is_sustainable, SUM(inventory.quantity) FROM products INNER JOIN inventory ON products.product_id = inventory.product_id GROUP BY products.is_sustainable;
SELECT MIN(member_count) as min_members FROM UnionMembers WHERE country = 'Brazil';
SELECT gender, COUNT(*) as num_fans FROM fans WHERE last_attended_game >= DATEADD(year, -1, GETDATE()) GROUP BY gender;
SELECT MIN(launch_date) FROM spacex_missions WHERE launch_company = 'SpaceX';
SELECT DATE_FORMAT(donation_date, '%Y-%m') as month, AVG(donation_amount) as avg_donation FROM donations WHERE donation_date BETWEEN '2020-01-01' AND '2020-12-31' GROUP BY month;
SELECT V.VolunteerName, COUNT(DISTINCT VP.ProgramID) as ProgramsContributed, SUM(VP.Hours) as TotalHours FROM Volunteers V JOIN Volunteer_Programs VP ON V.VolunteerID = VP.VolunteerID GROUP BY V.VolunteerName;
SELECT region FROM DroughtImpact;
SELECT COUNT(*) FROM CasesByYear WHERE City = 'Texas' AND Year = 2021 AND Disease IN ('Cholera', 'Tuberculosis', 'Measles', 'Influenza');
SELECT name, location FROM pollution_control_initiatives WHERE location = 'Arctic';
SELECT r.region, (SUM(r.amount) / (SELECT SUM(wg.amount) FROM WasteGeneration wg WHERE wg.year = 2020 AND EXISTS (SELECT 1 FROM RecyclingCenters rc WHERE rc.region = wg.city)) * 100) FROM RecyclingAmount r WHERE r.year = 2020 GROUP BY r.region;
SELECT e.name, e.department FROM Employees e LEFT JOIN Training t ON e.id = t.employee WHERE t.completed IS NULL
SELECT Medium, COUNT(*) as ArtworkCount FROM Artwork WHERE Continent = 'Europe' GROUP BY Medium ORDER BY ArtworkCount DESC;
SELECT country, satellites FROM satellites_in_orbit WHERE last_update <= '2022-07-01' AND country IN ('China', 'India', 'Japan', 'South Korea', 'Australia', 'Indonesia', 'Malaysia', 'Thailand', 'Vietnam', 'Philippines', 'New Zealand') GROUP BY country ORDER BY satellites DESC;
SELECT SUM(price * quantity) FROM Sales WHERE product LIKE 'Organic%';
SELECT SUM(fundingAmount) FROM PerformingArtsPrograms WHERE communityType = 'Underserved';
SELECT COUNT(DISTINCT type) FROM bioprocess_engineering.bioreactor;
SELECT * FROM renewable_energy_projects WHERE location IN ('Middle East', 'North Africa') AND budget > 500000;
SELECT * FROM union_membership_statistics WHERE YEAR(union_joined_date) > 2018;
SELECT COUNT(DISTINCT startup_id) FROM startup_founders JOIN diversity_metrics ON startup_founders.id = diversity_metrics.startup_id WHERE age BETWEEN 20 AND 30 OR age BETWEEN 40 AND 50 OR age BETWEEN 60 AND 70;
SELECT SUM(price * order_quantity) AS total_revenue FROM materials WHERE eco_friendly = TRUE;
SELECT * FROM freight_forwarding WHERE customer_name = 'ABC Corp';
SELECT Context.Country, Context.SurveyInfo FROM GeologicalSurvey as Context WHERE Context.Year = 2017 AND Context.MiningType = 'Copper';
SELECT ingredient, SUM(quantity) as total_quantity FROM ingredient_sources WHERE country = 'India' GROUP BY ingredient;
SELECT YEAR(inspection_date) AS year, AVG(score) FROM Inspections GROUP BY year;
SELECT name, ROW_NUMBER() OVER (ORDER BY views DESC) as ranking FROM europe_hotels JOIN virtual_tour_stats ON europe_hotels.id = virtual_tour_stats.hotel_id;
SELECT AVG(rating) FROM movies WHERE production_country = 'USA' AND YEAR(release_date) BETWEEN 2010 AND 2015;
SELECT ArtistID, Genre, MAX(SellingPrice) as HighestSellingPrice FROM Artwork WHERE Continent = 'Africa' GROUP BY ArtistID, Genre;
SELECT name, rating FROM heritage_sites WHERE city = 'Rome' AND rating > 4;
SELECT condition, COUNT(patient_id) AS cases_count FROM patients WHERE has_disability = TRUE GROUP BY condition ORDER BY cases_count DESC;
SELECT SUM(data_usage) FROM eu_data_usage JOIN country ON eu_data_usage.country = country.country WHERE country.region = 'European' AND eu_data_usage.subscriber_type = 'mobile';
SELECT SUM(BillingAmount) FROM CaseBilling INNER JOIN Cases ON CaseBilling.CaseID = Cases.CaseID WHERE HasLegalPrecedent = TRUE;
SELECT SoilAnalysis.field_id FROM SoilAnalysis WHERE SoilAnalysis.organic_matter > 12 UNION SELECT SatelliteImagery.field_id FROM SatelliteImagery
SELECT country, COUNT(*) FROM heritage_sites GROUP BY country HAVING country IN ('Spain', 'Italy');
SELECT country, production_amount FROM iron_ore_production ORDER BY production_amount DESC LIMIT 3;
SELECT region, MAX(land_area) FROM agro_regions GROUP BY region;
SELECT AVG(speed) FROM wta_serves;
SELECT d.date, SUM(i.value) as total_value FROM date d JOIN investment i ON d.date = i.date WHERE i.type = 'buy' GROUP BY d.date;
SELECT AVG(capacity) FROM LandfillCapacityByCountry;
SELECT department, AVG(salary) FROM employee GROUP BY department;
SELECT state FROM state_energy WHERE rps_percentage >= 0.5;
SELECT SUM(a.artifact_count) as total_artifacts, e.name as expert_name FROM (SELECT analyzed_by, COUNT(id) as artifact_count FROM Artifacts WHERE analyzed_by IN (SELECT name FROM Experts WHERE expertise = 'Ceramics') GROUP BY analyzed_by) a JOIN (SELECT name, MAX(artifact_count) as max_artifacts FROM (SELECT analyzed_by, COUNT(id) as artifact_count FROM Artifacts WHERE analyzed_by IN (SELECT name FROM Experts WHERE expertise = 'Ceramics') GROUP BY analyzed_by) b GROUP BY name) c ON a.artifact_count = c.max_artifacts JOIN Experts e ON a.analyzed_by = e.name;
SELECT technique, SUM(usage) as total_usage FROM explainability_report GROUP BY technique;
SELECT AVG(CO2_Emission) FROM Fossil_Fuel_Vehicles_Japan;
SELECT city, SUM(revenue) AS total_revenue FROM Concerts GROUP BY city ORDER BY total_revenue DESC LIMIT 3;
SELECT cause_id, COUNT(DISTINCT id) as num_donors FROM donors WHERE first_donation_date BETWEEN DATEADD(day, -30, GETDATE()) AND GETDATE() GROUP BY cause_id;
SELECT DATE(post_date) AS post_date, COUNT(*) AS posts_per_day FROM socialdata.posts WHERE hashtags LIKE '%#sustainability%' GROUP BY post_date;
SELECT region, COUNT(*) FROM indigenous_communities GROUP BY region;
SELECT suppliers.supplier_name, suppliers.contact_name, suppliers.contact_email, products.product_name FROM suppliers JOIN supplier_products ON suppliers.supplier_id = supplier_products.supplier_id JOIN products ON supplier_products.product_id = products.product_id;
SELECT SUM(technology_accessibility) FROM patents WHERE inventor_gender = 'Female';
SELECT launch_agency, COUNT(*) as satellite_count FROM satellite_launches WHERE launch_year BETWEEN 2010 AND 2020 GROUP BY launch_agency;
SELECT AVG(price) as avg_price FROM sculpture_sales WHERE price > 100000 AND sculpture_name LIKE '%sculpture%';
SELECT AVG(DATEDIFF(YEAR, StartYear, GETDATE())) FROM AttorneyLocationYear WHERE Location = 'California';
SELECT MIN(hours), MAX(hours) FROM DigitalLiteracyTraining WHERE region IN ('Middle East', 'Southeast Asia');
SELECT date, quantity FROM chemical_production_5 WHERE chemical = 'F' ORDER BY date;
SELECT SUM(cost) FROM accommodations WHERE accommodation_type = 'mobility_aids';
SELECT AgeGroup, AVG(FoodAidAmount) as AvgFoodAidPerPerson FROM FoodAid GROUP BY AgeGroup;
SELECT AVG(cases_handled) FROM legal_aid_organizations WHERE cases_handled > 1000 AND year >= 2017 AND state = 'Florida';
SELECT COUNT(*) FROM highways WHERE location = 'Alberta' GROUP BY location HAVING COUNT(*) > 5;
SELECT SUM(digital + physical) FROM sales WHERE genre = 'Latin';
SELECT COUNT(*) FROM marine_species_indian WHERE population > 500000;
SELECT COUNT(*) FROM vulnerabilities WHERE department = 'HR' AND severity = 'high';
SELECT phase, AVG(DATEDIFF(end_date, start_date)) FROM Project_Timeline WHERE phase = 'Design' GROUP BY phase;
SELECT PlayerName, TotalPlaytime FROM Players ORDER BY TotalPlaytime DESC LIMIT 3;
SELECT artist FROM GalleryC WHERE type = 'Painting' INTERSECT SELECT artist FROM GalleryC WHERE type = 'Sculpture'; SELECT COUNT(*) FROM (SELECT artist FROM GalleryC WHERE type = 'Painting' INTERSECT SELECT artist FROM GalleryC WHERE type = 'Sculpture') AS subquery WHERE artist IN (SELECT artist FROM GalleryC);
SELECT launch_company, COUNT(*) as num_spacecraft FROM spacecraft GROUP BY launch_company;
SELECT COUNT(*) FROM ChargingStations WHERE Country = 'Canada' AND Year = 2022;
SELECT DISTINCT Medical_Condition FROM Astronaut_Medical_3 WHERE Mission_Duration > 100;
SELECT DISTINCT co_owners.owner_name FROM co_owners INNER JOIN properties ON co_owners.property_id = properties.id WHERE properties.city = 'GreenTown' AND properties.certification_type = 'GreenUrb';
SELECT MIN(Score) FROM Scores WHERE GameType = 'VR';
SELECT state, SUM(beds) FROM hospitals WHERE mental_health = TRUE GROUP BY state;
SELECT AVG(funding.amount) as avg_funding_pre_2018 FROM funding JOIN companies ON funding.company_id = companies.company_id WHERE companies.founding_year < 2018;
SELECT s.name, p.publication_date FROM students s INNER JOIN publications p ON s.student_id = p.student_id WHERE s.department = 'Mathematics' AND s.grant_recipient = TRUE AND s.first_grant_date >= DATEADD(year, -1, GETDATE());
SELECT SUM(area_ha) FROM wildlife_habitats;
SELECT COUNT(*) FROM ( (SELECT * FROM retail_union WHERE YEAR(dob) = 2020) UNION (SELECT * FROM transportation_union WHERE YEAR(dob) = 2020) ) AS all_unions;
SELECT Name, SUM(TotalDonation) AS TotalDonated FROM Donors GROUP BY Name ORDER BY TotalDonated DESC;
SELECT MIN(investment_amount) as min_investment, MAX(investment_amount) as max_investment FROM housing_investments;
SELECT COUNT(check_in_id) as daily_checkins FROM check_ins WHERE member_id = 0002 AND check_in_date BETWEEN '2021-06-01' AND '2021-06-30';
SELECT state, facility_count FROM wastewater_facilities WHERE state IN ('New York', 'New Jersey');
SELECT SUM(wins) FROM mlb_teams_mascots WHERE mascot LIKE 'C%';
SELECT products.name AS product_name, SUM(inventory.quantity) AS total_quantity FROM products INNER JOIN inventory ON products.id = inventory.product_id INNER JOIN stores ON inventory.store_id = stores.id WHERE stores.region = 'Asia' GROUP BY products.name HAVING total_quantity > 100;
SELECT AVG(player_age) FROM basketball_teams;
SELECT COUNT(*) FROM urban_agriculture WHERE yield > 2.5;
SELECT AVG(electric_scooters/population) FROM urban_transportation WHERE country = 'Japan';
SELECT vehicle_type, SUM(cost) as total_cost FROM vehicle_maintenance WHERE maintenance_date BETWEEN '2021-07-01' AND '2021-09-30' GROUP BY vehicle_type;
SELECT country, COUNT(project_name) as num_projects FROM climate_adaptation WHERE country IN ('USA', 'Canada', 'Mexico') GROUP BY country;
SELECT Date, LAG(Price) OVER (ORDER BY Date) AS PreviousDayPrice, Price, Price - LAG(Price) OVER (ORDER BY Date) AS CO2PriceChange FROM CO2Price;
SELECT AVG(Return) AS Avg_Return, InvestmentYear FROM Investments WHERE InvestmentType = 'Shariah Compliant' AND InvestorGender = 'Female' GROUP BY InvestmentYear;
SELECT BridgeType, MAX(ConstructionHeight) as MaxHeight FROM BridgeConstruction GROUP BY BridgeType ORDER BY BridgeType ASC;
SELECT COUNT(*) FROM medical_facilities m JOIN rural_areas r ON m.area_id = r.area_id WHERE r.area_name IN ('Rural A', 'Rural B') AND m.establishment_date >= DATEADD(year, -5, GETDATE());
SELECT MIN(cost) FROM Accommodations INNER JOIN Students ON Accommodations.student = Students.id WHERE disability = 'hearing impairment';
SELECT players.gender, AVG(players.age) FROM players INNER JOIN vr_adopters ON players.id = vr_adopters.player_id WHERE vr_adopters.adoption_date >= DATEADD(year, -1, GETDATE()) AND players.country IN ('Saudi Arabia', 'UAE', 'Qatar');
SELECT a.name, a.genre FROM artists a JOIN artist_concerts ac ON a.id = ac.artist_id WHERE ac.country = 'Brazil';
SELECT zip FROM community_health_workers WHERE consultations = (SELECT MAX(consultations) FROM community_health_workers);
SELECT country, RANK() OVER (ORDER BY COUNT(*) DESC) ranking FROM stories WHERE story_type = 'Political' GROUP BY country HAVING ranking <= 3;
SELECT COUNT(*) FROM hotels WHERE MONTH(added_date) = 1 AND YEAR(added_date) = 2023;
SELECT capacity FROM landfill_capacity_city_v2 WHERE location = 'New York' AND city = 'New York City';
SELECT name, DATEDIFF(end_date, start_date) as mission_duration FROM space_missions ORDER BY mission_duration ASC LIMIT 1;
SELECT name, creation_date FROM smart_contracts WHERE developer IN ('Aisha Abdalla', 'Kwame Opoku');
SELECT MAX(points) FROM highest_scores;
SELECT SUM(teams.wins) FROM teams WHERE teams.mascot LIKE 'B%';
SELECT EXTRACT(MONTH FROM PurchaseDate) AS Month, COUNT(DISTINCT CustomerID) FROM Purchases WHERE Organic = TRUE GROUP BY Month;
SELECT AVG(A.Price) FROM Artwork A JOIN Artists AR ON A.ArtistID = AR.ArtistID WHERE AR.Gender = 'female' AND A.Type = 'Sculpture';
SELECT State, COUNT(Complaint) as Complaints FROM MentalHealthParity WHERE Year = 2020 GROUP BY State;
SELECT COUNT(*) FROM energy_efficiency.energy_efficiency_programs;
SELECT violation_type, MIN(fine) as min_fine FROM TrafficViolations WHERE location LIKE '%Residential%' GROUP BY violation_type;
SELECT AVG(impact_score) FROM mining_operations WHERE location = 'Rocky Mountains';
SELECT SUM(Amount) FROM Budget WHERE Year = 2020 AND Category IN ('Education', 'Healthcare');
SELECT vehicle_id, maintenance_type, COUNT(*) AS num_requests FROM maintenance GROUP BY vehicle_id, maintenance_type;
SELECT region, AVG(veteran_unemployment_rate) as avg_veteran_unemployment_rate FROM veteran_employment GROUP BY region;
SELECT name FROM suppliers WHERE has_recycling_program = TRUE;
SELECT JobRole, AVG(Salary) as AvgSalary FROM Employees WHERE HireDate >= (CURRENT_DATE - INTERVAL '12 months') GROUP BY JobRole;
SELECT SUM(assets) FROM client WHERE address = 'New York';
SELECT COUNT(*) FROM urban_agriculture_initiatives WHERE location = 'Toronto';
SELECT AVG(water_consumption / household_size) FROM tokyo_water_consumption WHERE date >= DATEADD(year, -1, CURRENT_DATE) AND city = 'Tokyo';
SELECT country, mission_type, COUNT(*) as total FROM aid_missions GROUP BY country, mission_type;
SELECT SUM(Emission_Amount) FROM CO2_Emissions WHERE Country IN ('USA', 'China');
SELECT AVG(scores.score) FROM scores JOIN players ON scores.player_id = players.player_id JOIN tournaments ON scores.tournament_id = tournaments.tournament_id WHERE players.country = 'USA';
SELECT DISTINCT project_name, completion_status FROM rural_development.infra_diversification;
SELECT Warehouse.name, SUM(Shipment.cargo_weight) as total_cargo_weight FROM Warehouse INNER JOIN Shipment ON Warehouse.id = Shipment.warehouse_id WHERE Warehouse.region = 'North America' AND Shipment.delivery_status = 'Delayed' GROUP BY Warehouse.name;
SELECT production_rate FROM (SELECT well_id, well_type, location, production_rate, ROW_NUMBER() OVER (ORDER BY production_rate DESC) rn FROM wells) t WHERE rn = 2;
SELECT policy_name, policy_description, last_update FROM policies WHERE last_update >= DATEADD(year, -1, GETDATE());
SELECT species, (population_2021 - population_2019) as population_change FROM (SELECT species, MAX(CASE WHEN year = 2021 THEN population END) as population_2021, MAX(CASE WHEN year = 2019 THEN population END) as population_2019 FROM wildlife GROUP BY species) as population_changes;
SELECT SUM(trips) FROM autonomous_taxis WHERE city IN ('Singapore', 'Sydney');
SELECT SUM(revenue) FROM sales WHERE initiative_type = 'Upcycling' AND initiative_region = 'Europe' AND sale_date BETWEEN '2021-01-01' AND '2021-03-31';
SELECT AVG(engagement_count) FROM virtual_tours vt INNER JOIN hotels h ON vt.hotel_id = h.id WHERE h.city = 'Berlin' AND h.country = 'Germany' GROUP BY engagement_date;
SELECT MAX(cost) FROM defense_projects WHERE duration < 24;
SELECT country, COUNT(DISTINCT user_id) as unique_users FROM users WHERE timestamp BETWEEN '2022-01-01' AND '2022-12-31' GROUP BY country;
SELECT COUNT(*) FROM bioprocess.engineering_projects WHERE (location = 'RU' OR location = 'AU') AND type = 'Bioprocess';
SELECT MAX(production_cost) FROM RecycledMaterialsGarments WHERE production_date BETWEEN DATEADD(month, -3, GETDATE()) AND GETDATE();
SELECT name FROM Bridges WHERE location = 'California' AND built < '1960-01-01';
SELECT brand FROM recycled_polyester WHERE country = 'Taiwan' AND year = 2020;
SELECT C.CustomerName FROM Customers C LEFT JOIN Orders O ON C.CustomerID = O.CustomerID WHERE O.CustomerID IS NULL;
SELECT MONTH(signup_date), COUNT(DISTINCT id) FROM customer_month GROUP BY MONTH(signup_date);
SELECT city, SUM(views) as total_views FROM virtual_tours WHERE city IN ('CityA', 'CityB', 'CityC', 'CityD') GROUP BY city ORDER BY total_views DESC LIMIT 3;
SELECT d.name, d.sustainability_index FROM destinations d INNER JOIN (SELECT country_id, MAX(sustainability_index) as max_sustainability FROM destinations GROUP BY country_id) ds ON d.country_id = ds.country_id WHERE d.sustainability_index = max_sustainability;
SELECT Vehicle FROM SafetyTesting WHERE Organization = 'NHTSA';
SELECT SUM(SM.Quantity * SM.Unit::numeric) FROM Satellites S INNER JOIN SatelliteMaterials SM ON S.SatelliteID = SM.SatelliteID INNER JOIN Countries C ON S.Country = C.CountryCode WHERE C.Continent = 'Europe';
SELECT DonorName, LAG(DonationAmount, 1) OVER (PARTITION BY DonorID ORDER BY DonationDate) AS PreviousDonation, DonationAmount, DonationAmount - LAG(DonationAmount, 1) OVER (PARTITION BY DonorID ORDER BY DonationDate) AS DonationChange FROM Donations D JOIN Donors ON D.DonorID = Donors.DonorID ORDER BY DonationDate;
SELECT AVG(Citizens) FROM CommunityCenters;
SELECT AVG(Passengers) FROM BusTrips WHERE VehicleType = 'Bus' AND TripTime LIKE '06%' OR TripTime LIKE '07%';
SELECT COUNT(*) FROM accounts WHERE risk_level = 'high' AND region = 'Asia-Pacific';
SELECT SUM(Quantity) FROM IndianMines
SELECT fouls FROM Player_F;
SELECT age_range, (COUNT(*) / (SELECT COUNT(*) FROM users)) * 100.0 AS percentage FROM (SELECT users.age / 10 * 10 AS age_range, users.id FROM users) AS user_age JOIN user_likes ON user_age.id = user_likes.user_id JOIN articles ON user_likes.article_id = articles.id WHERE articles.category = 'sports' INTERSECT SELECT user_age.id FROM (SELECT users.age / 10 * 10 AS age_range, users.id FROM users) AS user_age JOIN user_likes ON user_age.id = user_likes.user_id JOIN articles ON user_likes.article_id = articles.id WHERE articles.category = 'entertainment' GROUP BY age_range;
SELECT Society, MAX(Depth) FROM Expeditions GROUP BY Society;
SELECT EXTRACT(MONTH FROM sale_date) AS month, made_in_usa, SUM(quantity) AS total_quantity FROM sales JOIN products ON sales.product_id = products.product_id WHERE made_in_usa = true GROUP BY month, made_in_usa;
SELECT R.RegionName, COUNT(HS.SiteID) AS TotalSites FROM Regions R JOIN HeritageSites HS ON R.RegionID = HS.RegionID GROUP BY R.RegionName;
SELECT destination, MAX(cargo_weight) FROM cargo_data GROUP BY destination;
SELECT MAX(DATEDIFF('day', start_date, end_date)) FROM project WHERE is_green = true AND state = 'Oregon';
SELECT City, SUM(Trips) FROM Trips WHERE City = 'Chicago' AND Month = 7 AND Year IN (2018, 2019) GROUP BY City;
SELECT DATE_FORMAT(VolunteerDate, '%Y-%m') as Month, SUM(VolunteerHours) as TotalHours FROM VolunteerHours INNER JOIN Volunteers ON VolunteerHours.VolunteerID = Volunteers.VolunteerID WHERE Program = 'Arts and Culture' AND Year(VolunteerDate) = 2022 GROUP BY Month;
SELECT ethnicity, COUNT(*) FROM patients GROUP BY ethnicity;
SELECT state, SUM(total_funding) as total_mental_health_funding FROM school_districts GROUP BY state;
SELECT SUM(savings) as total_savings FROM conservation_initiatives ci WHERE ci.country = 'US';
SELECT MIN(founding_year) FROM companies WHERE founder_gender = 'female';
SELECT COUNT(*) FROM building_permits WHERE building_type = 'Residential' AND city = 'Seattle';
SELECT type, SUM(quantity) FROM fabric WHERE sustainability_rating >= 10 GROUP BY type;
SELECT MIN(members), MAX(members) FROM union_finance WHERE industry = 'Finance';
SELECT MIN(cost) FROM disaster_mitigation;
SELECT AVG(years_experience) FROM teachers WHERE subject = 'Math';
SELECT Brand_Name, Ethical_Awareness_Score - LAG(Ethical_Awareness_Score) OVER (PARTITION BY Brand_Name ORDER BY Year) AS Score_Change FROM Brand_Scores;
SELECT name, movies_count FROM directors WHERE gender = 'Female' AND release_year >= 2015;
SELECT SUM(price) FROM inclusive_housing WHERE city = 'Oakland' AND inclusive_scheme = TRUE;
SELECT COUNT(*) as Total FROM MentalHealthProvider WHERE WorkerIdentity IN ('African American', 'Hispanic', 'Asian American', 'Native American');
SELECT COUNT(*) FROM sustainable_tourism WHERE country = 'Canada';
SELECT mission_name FROM SpaceExploration WHERE agency = 'National Space Agency' AND year >= (YEAR(CURRENT_DATE) - 10);
SELECT category, MAX(investment) FROM initiatives GROUP BY category;
SELECT Programs.program_name, Outcomes.outcome_name, Outcomes.outcome_description, Programs.total_volunteers FROM Programs INNER JOIN Outcomes ON Programs.id = Outcomes.program_id ORDER BY Programs.total_volunteers DESC;
SELECT threat, SUM(exploited) as total_exploited FROM vulnerabilities WHERE timestamp >= '2022-04-01' AND timestamp < '2022-07-01' GROUP BY threat ORDER BY total_exploited DESC LIMIT 5;
SELECT SUM(transaction_amount) FROM community_development.transactions WHERE account_number IN (SELECT account_number FROM community_development.accounts WHERE is_community_development = true) AND transaction_date < NOW() - INTERVAL '60 days';
SELECT * FROM infrastructure_projects WHERE completion_year BETWEEN 2019 AND 2021 AND location LIKE '%Rural Area, Africa%';
SELECT AVG(budget) FROM economic_diversification_efforts WHERE country = 'South Africa' AND year IN (2018, 2019);
SELECT amount FROM rd_expenditure WHERE company_name = 'PharmaCorp' AND expenditure_year = 2021;
SELECT SUM(Budget) FROM StateData.StateInfrastructure WHERE Year = 2024 AND Contractor = 'Private';
SELECT well_name, production_qty FROM wells WHERE start_date <= '2021-10-01' AND end_date >= '2021-01-01' ORDER BY production_qty DESC;
SELECT SUM(capacity) FROM Production WHERE location = 'Western';
SELECT COUNT(Artworks.ArtworkID), AVG(Artworks.CulturalImpactScore) FROM Artists INNER JOIN Artworks ON Artists.ArtistID = Artworks.ArtistID WHERE Artists.Gender = 'Female' AND Artists.BirthYear BETWEEN 1501 AND 1600;
SELECT AgeGroup, COUNT(*) OVER (PARTITION BY AgeGroup) AS TotalViolations FROM TrafficViolations;
SELECT vessel FROM SurveyLocations WHERE region = 'NorthPacific' INTERSECT SELECT vessel FROM SurveyLocations WHERE region = 'SouthAtlantic';
SELECT consumption FROM colorado_river_basin WHERE state NOT IN ('Colorado', 'New Mexico') AND sector = 'Commercial';
SELECT city, COUNT(campaign_id) as num_campaigns FROM campaigns WHERE start_date <= '2020-12-31' AND end_date >= '2020-01-01' GROUP BY city ORDER BY num_campaigns DESC LIMIT 3;
SELECT f.name, COUNT(l.institution_name) FROM financial_institutions f INNER JOIN loans l ON f.name = l.institution_name WHERE f.location LIKE 'Southeast%' AND l.socially_responsible = TRUE GROUP BY f.name;
SELECT sector, region FROM climate_finance WHERE region = 'Asia' AND sector = 'Mitigation' AND amount < 3000000;
SELECT animal_name, COUNT(*) FROM community_education GROUP BY animal_name;
SELECT MIN(Temperature) FROM TemperatureHistory WHERE Year BETWEEN 2017 AND 2022;
SELECT SUM(energy_efficiency_savings) FROM energy_efficiency_stats WHERE year = 2020;
SELECT station_name, daily_passengers FROM (SELECT station_name, daily_passengers, ROW_NUMBER() OVER (ORDER BY daily_passengers DESC) as rank FROM stations) AS subquery WHERE rank <= 2 OR rank >= (SELECT COUNT(*) FROM stations) - 1;
SELECT investment_id, COUNT(DISTINCT mobile_subscriber_id) FROM network_investments JOIN mobile_subscribers ON network_investments.served_subscribers >= mobile_subscribers.subscriber_id GROUP BY investment_id;
SELECT SUM(area_sqkm) FROM forest WHERE is_deforested = TRUE AND year_deforested BETWEEN (SELECT MAX(year) FROM forest) - 10 AND (SELECT MAX(year) FROM forest);
SELECT COUNT(*) FROM asia_events WHERE event_type = 'Sustainable Fashion' AND event_year = 2021;
SELECT AVG(bias_score) FROM ai_safety WHERE safety_rating > 0.8;
SELECT country, SUM(amount) as total_amount FROM climate_finance WHERE sector = 'mitigation' GROUP BY country ORDER BY total_amount DESC;
SELECT MIN(bikes_available) FROM bike_station_info WHERE city = 'Chicago';
SELECT MONTH(date) AS month, region, AVG(temperature) AS avg_temp FROM arctic_weather WHERE YEAR(date) = 2020 GROUP BY month, region;
SELECT AVG(donation_amount) FROM donors WHERE donor_name = 'Anna Lee' AND donation_date BETWEEN '2021-01-01' AND '2021-12-31';
SELECT MAX(savings) FROM customers WHERE region = 'North';
SELECT species, status, SUM(population) FROM endangered_species GROUP BY species, status;
SELECT COUNT(*) FROM investors i INNER JOIN regions r ON i.region_id = r.region_id WHERE r.region_name = 'Asia-Pacific' AND i.investor_id IN (SELECT investment_id FROM investments);
SELECT 100.0 * COUNT(CASE WHEN vehicle_type = 'electric' THEN 1 END) / COUNT(*) AS electric_market_share, 100.0 * COUNT(CASE WHEN vehicle_type = 'hybrid' THEN 1 END) / COUNT(*) AS hybrid_market_share FROM vehicles WHERE city = 'Tokyo';
SELECT Name, ConstructionCost FROM SustainableProjects WHERE CompletionDate < '2020-01-01';
SELECT sql.mineral, sql.country, sql.deposit_size FROM geological_survey sql WHERE sql.mineral = 'Copper' AND sql.country = 'Chile' AND sql.deposit_size = (SELECT MAX(deposit_size) FROM geological_survey WHERE mineral = 'Copper')
SELECT StudentName, COUNT(*) as NumPublications FROM Publications p JOIN GraduateStudents gs ON p.StudentID = gs.StudentID GROUP BY StudentName ORDER BY NumPublications DESC LIMIT 3;
SELECT country, AVG(num_beds) FROM rural_hospitals GROUP BY country;
SELECT COUNT(*) FROM Players WHERE ParticipatedInEsports = TRUE;
SELECT SUM(waste_kg) FROM waste_generation WHERE year = 2020;
SELECT COUNT(DISTINCT name) FROM professor WHERE gender = 'Female' AND department_id IN (SELECT id FROM department WHERE name = 'Engineering') AND grant_amount IS NOT NULL;
SELECT retailers.retailer_name FROM retailers JOIN inventory ON retailers.retailer_id = inventory.retailer_id JOIN products ON inventory.product_id = products.product_id JOIN suppliers ON products.supplier_id = suppliers.supplier_id GROUP BY retailers.retailer_name HAVING COUNT(DISTINCT suppliers.supplier_id) > 1;
SELECT EventType, COUNT(*) FROM Events WHERE EventAttendance < 100 AND EventDate BETWEEN '2018-01-01' AND '2018-12-31' GROUP BY EventType;
SELECT title FROM Art WHERE country = 'France' AND creation_date BETWEEN '1850-01-01' AND '1900-12-31';
SELECT AVG(g.price) as avg_price FROM games g JOIN regions r ON g.region_id = r.id JOIN sports s ON g.sport_id = s.id WHERE s.name = 'Football' AND r.name = 'Midwest';
SELECT digital_channel, age, gender, COUNT(*) FROM visitor_demographics GROUP BY digital_channel, age, gender;
SELECT EnergyType, SUM(Production) AS TotalProduction FROM TotalEnergyProduction GROUP BY EnergyType;
SELECT Quantity FROM MilitaryBases WHERE Country = 'France';
SELECT contractor, AVG(fine) AS avg_fine FROM labor_stats GROUP BY contractor;
SELECT region, COUNT(*) as program_count FROM education_programs GROUP BY region;
SELECT i.strategy_name, AVG(t.transaction_amount) as avg_transaction_amount FROM investment_strategies i JOIN transactions t ON i.id = t.strategy_id GROUP BY i.strategy_name;
SELECT (SUM(recycled_water) * 100.0 / SUM(total_water_used)) as percentage FROM water_usage WHERE year BETWEEN 2018 AND 2020 AND operation = 'mining';
SELECT SUM(amount) FROM budget WHERE item = 'Public Safety' AND area_id = (SELECT id FROM areas WHERE name = 'Urban');
SELECT AVG(rating) as avg_rating FROM products WHERE has_aloe_vera = true;
SELECT COUNT(*) FROM solar_installations WHERE state = 'California' AND year = 2020 AND installed = TRUE;
SELECT SUM(production) FROM well_production WHERE region = 'Nigeria' AND year = 2019;
SELECT COUNT(*) FROM charging_stations WHERE state = 'CA';
SELECT country, COUNT(*) as institution_count FROM shariah_compliant_finance GROUP BY country ORDER BY institution_count DESC LIMIT 3;
SELECT COUNT(*) FROM therapy_sessions WHERE country = 'France' AND therapy_type = 'group therapy' AND success = TRUE;
SELECT EXTRACT(MONTH FROM date) as month, MAX(do_value) as max_do_value FROM ocean_health_monitor WHERE date BETWEEN '2022-01-01' AND '2022-12-31' GROUP BY EXTRACT(MONTH FROM date);
SELECT mo.name, d.gender_diversity, d.cultural_diversity FROM mining_operations mo LEFT JOIN diversity d ON mo.id = d.operation_id WHERE mo.continent = 'Oceania';
SELECT AVG(price) as avg_price FROM carbon_prices WHERE year = 2021;
SELECT COUNT(*) * 100.0 / (SELECT COUNT(*) FROM cosmetics.lipstick_spf_data WHERE country = 'India') as percentage FROM cosmetics.lipstick_spf_data WHERE country = 'India' AND has_spf = true AND spf_level >= 15;
SELECT MAX(funding) FROM biotech.startups WHERE country = 'Canada';
SELECT initiative_name, district FROM Carbon_Offset_Initiatives WHERE district IN (SELECT district FROM Cities WHERE population > 500000);
SELECT country, COUNT(*) FROM circular_economy_companies GROUP BY country;
SELECT Retailers.retailer_name FROM Retailers JOIN Sales ON Retailers.country = Sales.country WHERE Sales.sale_date BETWEEN '2022-04-01' AND '2022-06-30' AND Sales.revenue > 500;
SELECT SUM(sale_value) FROM Military_Equipment_Sales WHERE country IN ('USA', 'Canada', 'Germany', 'France', 'UK', 'Italy', 'Spain');
SELECT COUNT(*) FROM biosensors.projects WHERE country = 'India';
SELECT user_account, AVG(failed_attempts) as avg_failed_attempts_per_day FROM (SELECT user_account, success, login_date, CASE WHEN success = false THEN 1 ELSE 0 END as failed_attempts FROM login_attempts) as subquery GROUP BY user_account;
SELECT project, sector FROM climate_adaptation_projects WHERE year IN (2019, 2020) GROUP BY project, sector;
SELECT Restaurants.RestaurantName, Restaurants.Region, Restaurants.FoodSafetyScore FROM Restaurants WHERE Restaurants.FoodSafetyScore = (SELECT MIN(FoodSafetyScore) FROM Restaurants AS T WHERE T.Region = Restaurants.Region) GROUP BY Restaurants.Region;
SELECT AVG(salary) FROM Factory_Workers WHERE region = 'Southeast Asia';
SELECT SUM(biomass) FROM marine_life_research;
SELECT AVG(Event_Attendance_agg.event_attendance) FROM (SELECT Visitors.id, COUNT(Event_Attendance.event_id) AS event_attendance FROM Visitors JOIN Countries ON Visitors.country_id = Countries.id JOIN Event_Attendance ON Visitors.id = Event_Attendance.visitor_id JOIN Events ON Event_Attendance.event_id = Events.id WHERE Countries.name = 'United States' GROUP BY Visitors.id) AS Event_Attendance_agg;
SELECT name, framework FROM blockchain_tech WHERE region = 'Europe';
SELECT material, rate FROM recycling_rates_oceania WHERE area = 'Oceania' AND year = 2020 AND material IN ('plastic', 'glass', 'metal');
SELECT MAX(Maximum) FROM Habitat WHERE Location = 'North America';
SELECT AVG(three_point_shots_made) FROM players WHERE country = 'Asia' GROUP BY country HAVING games_played > 75;
SELECT mission_name, launch_date FROM jupiter_missions WHERE destination = 'Jupiter';
SELECT AVG(Salary) FROM Workers WHERE Industry = 'Manufacturing' AND UnionMember = true;
SELECT supplier_id, country, material_type, quantity FROM suppliers WHERE country IN ('Kenya', 'Tanzania', 'Uganda', 'Ethiopia', 'Morocco') ORDER BY quantity DESC LIMIT 5;
SELECT SUM(fish_count) FROM freshwater_fish_farms WHERE region = 'Europe' AND stocking_density > 5000;
SELECT AVG(salary) FROM construction_workers WHERE state = 'Texas' AND gender = 'Female';
SELECT AVG(budget) FROM budgets WHERE city = 'Madrid' AND country = 'Spain' AND project_type = 'Wind' AND year >= 2015;
SELECT MAX(assists) FROM season_assists WHERE sport = 'Hockey' GROUP BY player_name, season;
SELECT country, COUNT(product_id) AS product_count FROM SkincareInventory GROUP BY country;
SELECT COUNT(*) FROM marine_mammals WHERE region = 'Arctic';
SELECT SUM(num_officers) FROM police_officers_tx WHERE state = 'Texas';
SELECT recycler_id, element, SUM(quantity) AS Total_Recycled FROM recycling_stats GROUP BY recycler_id, element;
SELECT COUNT(DISTINCT brand) FROM shoes WHERE is_vegan = true;
SELECT region, AVG(yield) as avg_yield FROM crops_table GROUP BY region ORDER BY avg_yield DESC LIMIT 1;
SELECT COUNT(MaintenanceID) FROM BusMaintenance WHERE MaintenanceDate >= DATEADD(YEAR, -1, GETDATE());
SELECT MIN(price) FROM coffee_prices WHERE product = 'Coffee Beans' AND country = 'Ethiopia';
SELECT district_id, COUNT(course_id) as num_courses FROM teacher_pd GROUP BY district_id;
SELECT maintenance_type, COUNT(*) as total_maintenance FROM NavalVessels WHERE owner = 'BAE Systems' AND region = 'Asia-Pacific' AND maintenance_date BETWEEN '2020-10-01' AND '2020-12-31' GROUP BY maintenance_type;
SELECT name, ranking FROM tennis_players;
SELECT heritage_sites.name, COUNT(events.id) AS total_events FROM heritage_sites INNER JOIN events ON heritage_sites.id = events.site_id WHERE events.event_type = 'Community Engagement' GROUP BY heritage_sites.id;
SELECT AVG(SafetyRating) FROM Vehicles WHERE Type = 'Electric';
SELECT station_name, SUM(entries) AS total_entries, SUM(exits) AS total_exits FROM subway_stations_seoul GROUP BY station_name;
SELECT COUNT(*) FROM products WHERE certification IN ('Fair Trade', 'Rainforest Alliance', 'organic');
SELECT FirstName, LastName, Salary FROM Employees e1 WHERE Salary > (SELECT AVG(Salary) FROM Employees e2 WHERE e1.Department = e2.Department);
SELECT pi.ingredient, AVG(p.price) as avg_price FROM products p JOIN product_ingredients pi ON p.product_id = pi.product_id WHERE p.organic = TRUE GROUP BY pi.ingredient;
SELECT MIN(size_ha) FROM agricultural_innovation_projects WHERE country = 'Egypt';
SELECT SUM(quantity) FROM sales JOIN products ON sales.product_id = products.product_id WHERE products.market = 'South America' AND products.material LIKE 'organic%';
SELECT COUNT(*) FROM artifacts WHERE artifact_period = 'Ancient Egyptian';
SELECT SUM(CO2_emissions) FROM flights WHERE (origin = 'US' AND destination = 'Australia') OR (origin = 'Australia' AND destination = 'US') AND year = 2021;
SELECT dn.donor_name, SUM(d.donation_amount) AS total_donated FROM community.donors dn INNER JOIN community.donations d ON dn.donor_id = d.donor_id GROUP BY dn.donor_name ORDER BY total_donated DESC;
SELECT SUM(ms.sale_amount) FROM MusicSales ms INNER JOIN Genres g ON ms.genre = g.genre WHERE g.genre = 'Pop' AND sale_date BETWEEN '2020-01-01' AND '2020-12-31';
SELECT industry, COUNT(*) FROM company WHERE founder LIKE '%Immigrant%' GROUP BY industry;
SELECT AVG(StreamsPerDay) as AvgStreamsPerDay FROM (SELECT EXTRACT(DAY FROM Date) as Day, EXTRACT(MONTH FROM Date) as Month, EXTRACT(YEAR FROM Date) as Year, SUM(Streams) as StreamsPerDay FROM DailyStreams JOIN Tracks ON DailyStreams.TrackID = Tracks.TrackID JOIN StreamingPlatforms ON DailyStreams.PlatformID = StreamingPlatforms.PlatformID WHERE Genre = 'Latin' AND PlatformName = 'Pandora' GROUP BY Day, Month, Year) as Subquery WHERE Year = EXTRACT(YEAR FROM CURRENT_DATE) - 1;
SELECT london.lines.line_name, COUNT(*) FROM london.lines INNER JOIN london.stations ON london.lines.id = london.stations.line_id WHERE london.stations.is_accessible = TRUE GROUP BY london.lines.line_name;
SELECT VolunteerName FROM Volunteers WHERE HoursDonated > 20 AND VolunteerYear = 2021;
SELECT program_name, location FROM community_engagement WHERE years_operating > 20 AND location LIKE '%%Europe%%';
SELECT SUM(amount) FROM MilitaryEquipmentSales WHERE country = 'Canada' AND sale_date BETWEEN '2021-04-01' AND '2021-06-30';
SELECT store_id, store_name, SUM(quantity_sold) as total_sold FROM Sales_2 JOIN Stores_2 ON Sales_2.store_id = Stores_2.store_id WHERE product_name = 'Vegan Leather Pants' GROUP BY store_id, store_name ORDER BY total_sold DESC LIMIT 5;
SELECT company, EXTRACT(YEAR FROM date) AS year, SUM(production_figures) AS total_production FROM wells GROUP BY company, year;
SELECT hotel_name, energy_consumption FROM (SELECT hotel_name, energy_consumption, energy_consumption - LAG(energy_consumption) OVER (PARTITION BY hotel_name ORDER BY year) as diff FROM hotels) where diff < 0;
SELECT country, year, SUM(quantity) FROM hybrid_sales WHERE year = 2020 GROUP BY country;
SELECT COUNT(DISTINCT type) FROM chemicals WHERE type = 'Pharma';
SELECT r.type, SUM(f.fare) as total_fare FROM route r JOIN fare_collection f ON r.id = f.route_id GROUP BY r.type;
SELECT state, COUNT(gb.building_name) + COUNT(rp.project_name) FROM green_buildings gb RIGHT JOIN renewable_projects rp ON gb.state = rp.state GROUP BY state;
SELECT AVG(sodium) FROM Dishes WHERE is_vegetarian = TRUE AND country = 'Australia';
SELECT SUM(goals) FROM games WHERE team IN (SELECT team FROM players WHERE position = 'Soccer Player');
SELECT MissionType, AVG(Cost) as AvgCost FROM SpaceExploration GROUP BY MissionType;
SELECT Accessible, SUM(Count) FROM Parks GROUP BY Accessible;
SELECT SUM(garment_quantity) AS total_quantity FROM Garments WHERE garment_material IN ('organic cotton', 'recycled polyester', 'hemp') AND garment_country = 'Vietnam';
SELECT Name, Facility FROM Inmates WHERE YearsIncarcerated > 5 AND Facility LIKE 'Federal%';
SELECT MAX(safety_rating) FROM safety_test_results WHERE make = 'Tesla';
SELECT local_economic_impact FROM cultural_heritage WHERE country = 'Spain' AND project_name = 'Ancient City Restoration';
SELECT transaction_product, SUM(transaction_amount) as total_transaction_amount FROM transactions WHERE transaction_date BETWEEN '2021-12-01' AND '2021-12-31' AND transaction_amount = 'USD' GROUP BY transaction_product;
SELECT AVG(Quantity) FROM SupplierFabric;
SELECT program_id, program_name, animals_covered FROM community_education WHERE region = 'South America';
SELECT AVG(founding_year) FROM startups WHERE founder_identity = 'Latinx';
SELECT MAX(runs) FROM ipl_runs;
SELECT * FROM storage_projects WHERE country = 'India' AND technology IN ('Batteries', 'Flywheels', 'Compressed Air') AND year_built BETWEEN 2015 AND 2017;
SELECT country, year, quantity FROM cerium_production WHERE country = 'Canada';
SELECT SUM(trees.volume) FROM trees JOIN biomes ON trees.biome_id = biomes.biome_id WHERE trees.family = 'Pinus' AND biomes.name = 'Boreal Forest';
SELECT COUNT(*) FROM volunteers WHERE signup_date BETWEEN '2019-04-01' AND '2019-04-30';
SELECT zone_id, MAX(max_dissolved_oxygen) as max_dissolved_oxygen_mg_l FROM aquaculture_zones WHERE year = 2023 GROUP BY zone_id;
SELECT SUM(offset_tons_co2) FROM carbon_offset_projects WHERE location = 'north_america' AND completion_date BETWEEN '2015-01-01' AND '2015-12-31';
SELECT name FROM species WHERE conservation_status = 'Endangered' AND ocean_basin = 'Pacific';
SELECT m.species_name, c.impacts FROM marine_species_arctic_ocean m FULL OUTER JOIN climate_change_impacts_arctic_ocean c ON m.species_name = c.species_name WHERE m.habitat = 'Arctic Ocean' OR c.species_name IS NOT NULL;
SELECT state, COUNT(*) as hospital_count FROM nigerian_hospitals GROUP BY state;
SELECT region, COUNT(*) * 100.0 / (SELECT COUNT(*) FROM donors_region) AS percentage FROM donors_region GROUP BY region;
SELECT COUNT(*) FROM Water_Treatment_Plant_Upgrades WHERE State = 'Florida' AND Upgrade_Date >= DATEADD(year, -5, GETDATE());
SELECT sport, AVG(price) as avg_price FROM tickets GROUP BY sport ORDER BY avg_price DESC LIMIT 5;
SELECT response_type, AVG(EXTRACT(EPOCH FROM response_time)) as avg_response_time FROM emergency_responses GROUP BY response_type;
SELECT construction_type, AVG(square_footage) as avg_square_footage FROM leed_buildings WHERE city = 'New York' AND state = 'NY' AND construction_type IN ('Steel', 'Concrete', 'Wood') GROUP BY construction_type;
SELECT mt.tech, COUNT(*) FROM tech_ops mt GROUP BY mt.tech;
SELECT origin_city, destination_city, AVG(DATEDIFF(day, etd, eta)) as avg_delivery_time FROM Routes WHERE origin_city IN (SELECT city FROM Warehouse WHERE country = 'Europe') GROUP BY origin_city, destination_city ORDER BY avg_delivery_time DESC LIMIT 10;
SELECT SUM(waste_generation.amount), COUNT(recycling_centers.name) FROM waste_generation INNER JOIN recycling_centers ON waste_generation.sector = recycling_centers.sector WHERE waste_generation.sector = 'industrial' AND waste_generation.location = 'Seoul';
SELECT d.name, MAX(mb.budget) FROM marketing_budgets mb JOIN destinations d ON mb.destination_id = d.id GROUP BY d.name;
SELECT SUM(1) FROM station_emergencies se JOIN station_crime_rates sc ON se.sid = sc.sid WHERE sc.rate > (SELECT AVG(rate) FROM (SELECT did, AVG(rate) AS rate FROM crime_rates GROUP BY did) cr);
SELECT species, COUNT(*) AS species_count, RANK() OVER (ORDER BY COUNT(*) DESC) AS species_rank FROM fish_species GROUP BY species;
SELECT DATE_FORMAT(transaction_date, '%W') as day_of_week, SUM(transaction_value) as total_value FROM transactions WHERE transaction_date BETWEEN '2021-01-01' AND '2021-06-30' GROUP BY day_of_week;
SELECT MIN(investment_amount) FROM investments WHERE round_number = 2;
SELECT AVG(energyConsumption) FROM GreenBuildings;
SELECT MIN(budget) FROM climate_finance WHERE location = 'Oceania';
SELECT state, COUNT(*) FROM HospitalLocations GROUP BY state;
SELECT AVG(age) FROM rural_clinics WHERE gender = 'Male';
SELECT m.category, SUM(s.quantity * s.sale_price) FROM Sales s JOIN Menu m ON s.item_sold = m.item_name WHERE s.sale_date = '2022-01-01' GROUP BY m.category;
SELECT Country, AVG(Salary) as AvgSalary FROM TextileWorkers WHERE ApprenticeshipProgram = TRUE GROUP BY Country;
SELECT COUNT(StudentID) FROM GraduateStudents WHERE Department = 'Mathematics' HAVING NumPapers > 3;
SELECT COUNT(*) FROM patients WHERE hiv = 'Positive' AND age > 50 AND city = 'Chicago';
SELECT name, opening_hours FROM culture.museums;
SELECT name FROM space_missions_2 WHERE cost > 500000000;
SELECT Artifacts.Description, HistoricalContexts.Era, HistoricalContexts.Culture FROM Artifacts INNER JOIN HistoricalContexts ON Artifacts.ArtifactID = HistoricalContexts.ArtifactID WHERE Artifacts.Material = 'gold';
SELECT name, biomass FROM fish_farms WHERE country = 'Indonesia' AND biomass > 1000;
SELECT GraduateStudents.Name FROM GraduateStudents LEFT JOIN ResearchGrants ON GraduateStudents.StudentID = ResearchGrants.StudentID WHERE ResearchGrants.GrantID IS NULL;
SELECT COUNT(*) FROM digital_assets WHERE issue_date BETWEEN '2022-01-01' AND '2022-03-31' AND country = 'Australia';
SELECT MIN(Playtime) FROM Players WHERE PlayerRegion = 'South America' AND GameName = 'Cybernetic Mayhem' AND PlayerID > 3;
SELECT w.name FROM wildlife_sanctuaries w INNER JOIN timber_production t ON ST_Intersects(w.location, t.location);
SELECT COUNT(*) FROM Attorneys WHERE LastName IN ('Garcia', 'Patel');
SELECT AVG(recycling_rate) FROM recycling_rates WHERE region = 'Europe' AND year IN (2018, 2019);
SELECT SUM(cost) FROM defense_contracts WHERE country IN ('UK', 'France');
SELECT COUNT(*) FROM brands WHERE region = 'Asia' AND sustainability_rating = 1;
SELECT name, network FROM regulatory_frameworks WHERE framework_id IN (SELECT framework_id FROM regulatory_frameworks GROUP BY framework_id HAVING COUNT(*) > 1);
SELECT SUM(quantity) FROM Cars WHERE type = 'Self-driving' AND state = 'California' AND year = 2021;
SELECT region, MIN(feedbacks) FROM Government.City WHERE region = 'Rural' GROUP BY region;
SELECT program_id, COUNT(*) AS num_volunteers FROM volunteers GROUP BY program_id;
SELECT COUNT(species) FROM marine_life_populations WHERE species LIKE '%fish%';
SELECT SUM(haircare_sales.sale_quantity) FROM haircare_sales INNER JOIN product_info ON haircare_sales.product_id = product_info.product_id INNER JOIN product_categories ON haircare_sales.product_id = product_categories.product_id WHERE haircare_sales.country = 'Canada' AND product_info.is_cruelty_free = TRUE AND product_categories.category_name = 'Haircare';
SELECT NAME, LOCATION FROM MARINE_PROTECTED_AREAS WHERE REGION = 'Arctic';
SELECT CustomerID FROM Investments WHERE Market = 'Canada' AND Value > 5000
SELECT name, accommodation FROM disability_services.staff WHERE department = 'accessibility_resources';
SELECT AVG(cnt) FROM (SELECT company_id, COUNT(*) as cnt FROM funding_rounds GROUP BY company_id) as subquery;
SELECT SUM(Budget) FROM HealthBudget WHERE Service = 'Healthcare' AND Year = 2020;
SELECT SUM(revenue) FROM q1_sales JOIN cosmetics ON q1_sales.product = cosmetics.product JOIN countries ON q1_sales.country = countries.country WHERE cosmetics.product_category = 'Lipsticks' AND countries.country = 'USA';
SELECT donation_category, AVG(donation_amount) as avg_donation FROM donations GROUP BY donation_category;
SELECT country, courier_id, state, SUM(weight) as total_weight FROM warehouse_shipments GROUP BY country, courier_id, state ORDER BY total_weight DESC;
SELECT COUNT(treatments.success) * 100.0 / (SELECT COUNT(*) FROM treatments WHERE patients.condition = 'Anxiety Disorder') FROM patients JOIN treatments ON patients.patient_id = treatments.patient_id WHERE patients.condition = 'Anxiety Disorder' AND treatments.success = TRUE;
SELECT ps.product_id, AVG(ps.sustainability_rating) FROM product_suppliers ps GROUP BY ps.product_id HAVING COUNT(DISTINCT ps.supplier_country) > 1;
SELECT Job_Title, COUNT(*) FROM CommunityHealthWorkers WHERE Ethnicity = 'Asian' GROUP BY Job_Title;
SELECT f.name FROM fleet f JOIN (SELECT country FROM port_office WHERE region = 'North America') AS po ON f.country = po.country;
SELECT ci.incident_type, ci.incident_date FROM cyber_incidents ci WHERE ci.region = 'Asia-Pacific';
SELECT program, COUNT(DISTINCT volunteer_id) FROM volunteer_programs GROUP BY program;
SELECT EXTRACT(MONTH FROM incident_date) AS month, MAX(COUNT(*)) AS max_incidents FROM algorithmic_fairness_incidents_monthly WHERE region = 'Asia' GROUP BY month;
SELECT region, SUM(incidents) as total_incidents FROM drought_data WHERE year = 2019 GROUP BY region;
SELECT COUNT(*) FROM clients WHERE financial_wellbeing_score < 70 AND savings < 5000;
SELECT name FROM rural_development.agriculture_projects WHERE name NOT LIKE '%livestock%';
SELECT name FROM SmartCityTech WHERE location = 'CityA';
SELECT program_name, num_published_articles FROM programs ORDER BY num_published_articles DESC LIMIT 3;
SELECT country, MAX(quantity) FROM mineral_extraction GROUP BY country;
SELECT gender, COUNT(*) FROM employees GROUP BY gender;
SELECT a.Name AS AttorneyName, SUM(cb.Billing) AS TotalBilling FROM Attorneys a JOIN CaseBilling cb ON a.AttorneyID = cb.AttorneyID GROUP BY a.Name ORDER BY TotalBilling DESC;
SELECT capacity FROM landfill_capacity WHERE year = 2022;
SELECT AVG(e.age) FROM employees e JOIN completed_training ct ON e.employee_id = ct.employee_id JOIN training_programs tp ON ct.program_id = tp.program_id WHERE e.department = 'IT';
SELECT AVG(capacity/population*1000000) FROM Population, LandfillCapacity WHERE Population.country IN ('Germany', 'France') AND LandfillCapacity.country = Population.country
SELECT museum_name, art_category, SUM(quantity) FROM MuseumArt GROUP BY museum_name, art_category;
SELECT SUM(funding.amount) FROM companies INNER JOIN funding ON companies.id = funding.company_id WHERE companies.founder_gender = 'Female' AND companies.industry = 'Technology';
SELECT COUNT(*) FROM Donations INNER JOIN Volunteers ON Donations.volunteer_id = Volunteers.id WHERE Volunteers.country = 'Canada';
SELECT AVG(avg_wage) FROM labor_statistics WHERE state = 'Oregon' AND year = 2020;
SELECT COUNT(*) FROM Visitors v JOIN Attendance a ON v.visitor_id = a.visitor_id JOIN Exhibitions e ON a.exhibition_id = e.exhibition_id WHERE v.country = 'USA' AND e.exhibition_year = 2021;
SELECT department, COUNT(*) as num_students FROM department_publications WHERE num_publications > 1 GROUP BY department;
SELECT AVG(consumption_rate) FROM fuel_consumption WHERE vessel_id = 'VES006';
SELECT product_id, SUM(incident_count) as total_incident_count FROM ProductSafety WHERE year = 2020 GROUP BY product_id;
SELECT DISTINCT make, model FROM EVSales WHERE country = 'USA';
SELECT COUNT(*) FROM VesselArrivals WHERE ArrivalPort = 'Dar es Salaam' AND ArrivalDate >= DATEADD(day, -90, GETDATE());
SELECT SUM(price * quantity) FROM SkincareSales WHERE category = 'Organic Skincare' AND country = 'USA';
SELECT SUM(attendees) FROM attendance WHERE event = 'Dance Event' AND country = 'Mexico' AND year = 2021;
SELECT year, AVG(production) FROM gas_production GROUP BY year;
SELECT COUNT(*) FROM public_schools WHERE county = 'Los Angeles' AND school_type != 'Charter';
SELECT AVG(age) as average_age FROM refugees WHERE organization = 'UNHCR' AND location = 'Africa' AND YEAR(assist_date) = 2018;
SELECT MAX(hours_spent) as max_hours_spent FROM teacher_pd_hours WHERE date >= DATEADD(month, -1, GETDATE()) GROUP BY MONTH(date), YEAR(date);
SELECT MAX(score) FROM financial_wellbeing WHERE country = 'USA';
SELECT OrgName, SUM(Amount) as TotalDonations FROM Donations JOIN Organizations ON Donations.OrgID = Organizations.OrgID WHERE DonationDate BETWEEN '2022-01-01' AND '2022-03-31' GROUP BY OrgName;
SELECT dapp_name, network, smart_contracts, COUNT(*) OVER (PARTITION BY dapp_name) as deployed_contracts FROM smart_contracts_table WHERE network = 'Polygon';
SELECT MAX(annual_carbon_offsets) FROM renewable_energy WHERE annual_carbon_offsets > 0;
SELECT site_name, MIN(visitors) FROM (SELECT site_name, year, quarter, SUM(visitors) AS visitors FROM cultural_sites INNER JOIN virtual_visitors ON cultural_sites.site_id = virtual_visitors.site_id WHERE country = 'India' AND year = 2021 GROUP BY site_name, year, quarter) AS t GROUP BY site_name;
SELECT AVG(temperature) FROM fish_farms WHERE country = 'Thailand' AND water_type = 'Tropical';
SELECT i.initiative_name, SUM(sc.co2_reduction) as total_reduction FROM smart_cities sc JOIN initiatives i ON sc.initiative_id = i.initiative_id GROUP BY i.initiative_name;
SELECT SUM(CargoShips.capacity) FROM CargoShips INNER JOIN Fleet ON CargoShips.fleet_id = Fleet.id;
SELECT name, feeding_habit, habitat FROM aquatic_species;
SELECT AVG(duration) FROM project_duration WHERE sustainable = true AND province = 'Quebec';
SELECT MIN(quantity) FROM tickets_3 WHERE sport = 'Basketball';
SELECT MineName, SUM(CoalQuantity) as TotalCoalQuantity, SUM(IronQuantity) as TotalIronQuantity, SUM(GoldQuantity) as TotalGoldQuantity FROM Mine LEFT JOIN Coal ON Mine.MineID = Coal.MineID LEFT JOIN Iron ON Mine.MineID = Iron.MineID LEFT JOIN Gold ON Mine.MineID = Gold.MineID GROUP BY MineName;
SELECT Country, SUM(Quantity) as TotalQuantitySold FROM ClothingSales GROUP BY Country;
SELECT rv.name, COUNT(pi.id) as num_initiatives FROM research_vessels rv INNER JOIN pollution_initiatives pi ON rv.id = pi.vessel_id GROUP BY rv.name;
SELECT SUM(tourists) FROM tourists WHERE country = 'Portugal' AND year IN (2020, 2021);
SELECT A.Country, SUM(AP.Price * S.Quantity) AS TotalRevenue FROM Artists A INNER JOIN ArtPieces AP ON A.ArtistID = AP.ArtistID INNER JOIN Sales S ON AP.ArtPieceID = S.ArtPieceID WHERE A.Ethnicity = 'Indigenous' AND A.Country IN ('USA', 'Canada', 'Mexico') GROUP BY A.Country;
SELECT AVG(price) FROM menus WHERE category = 'Lunch' AND is_vegan = FALSE;
SELECT member_id, AVG(duration) as avg_duration FROM member_activity GROUP BY member_id;
SELECT CategoryID, Country, SUM(DonationAmount) AS TotalDonations, RANK() OVER (PARTITION BY CategoryID ORDER BY SUM(DonationAmount) DESC) AS CountryRank FROM Donations JOIN Donors ON Donations.DonorID = Donors.DonorID JOIN DonationCategories ON Donations.CategoryID = DonationCategories.CategoryID WHERE DonationCategories.CategoryName = 'Health Awareness' GROUP BY CategoryID, Country;
SELECT AVG(production_cost) FROM OrganicCottonGarments JOIN FairTradeFactories ON OrganicCottonGarments.id = FairTradeFactories.factory_id WHERE OrganicCottonGarments.country = 'India';
SELECT destination, continent, visitors, RANK() OVER (PARTITION BY continent ORDER BY visitors DESC) as popularity_rank FROM african_tourism WHERE continent = 'Africa' AND popularity_rank <= 3;
SELECT AVG(salary) FROM Tech_Workers_Union WHERE safety_rating > 9;
SELECT SUM(population) FROM Habitat3 WHERE species IN (SELECT species FROM AnimalData WHERE order_class = 'Herbivora') AND habitat = 'Habitat3';
SELECT AVG(wellbeing_score) FROM customers WHERE age BETWEEN 30 AND 40 AND EXTRACT(YEAR FROM registration_date) = 2019;
SELECT brand FROM tencel_sources WHERE country = 'Germany' AND year = 2022;
SELECT life_expectancy FROM life_expectancy WHERE community_type = 'Indigenous' AND country = 'Canada';
SELECT AVG(number_of_vessels) FROM fleets;
SELECT COUNT(*) FROM circular_economy WHERE sector = 'Metals' AND circular = TRUE;
SELECT MAX(capacity) FROM energy_storage WHERE country = 'Australia';
SELECT launch_country FROM space_missions WHERE YEAR(launch_date) BETWEEN 1990 AND 2010 GROUP BY launch_country;
SELECT State, ParityStatus FROM MentalHealthParity ORDER BY State;
SELECT MAX(production_quantity) FROM production WHERE year = 2016 AND element = 'Ytterbium';
SELECT AVG(age) as avg_age FROM mental_health_providers WHERE completed_training = true;
SELECT CHW_ID, MAX(Score) FROM Trainings WHERE Training_Name = 'Mental Health Parity' GROUP BY CHW_ID;
SELECT ds.dispensary_id FROM DispensarySales ds JOIN OregonDispensaries od ON ds.dispensary_id = od.dispensary_id WHERE strain LIKE '%Indica%' INTERSECT SELECT ds.dispensary_id FROM DispensarySales ds JOIN OregonDispensaries od ON ds.dispensary_id = od.dispensary_id WHERE strain LIKE '%Sativa%';
SELECT SUM(hotels.revenue) FROM hotels INNER JOIN ai_recs ON hotels.hotel_id = ai_recs.hotel_id WHERE hotels.country = 'Canada' AND ai_recs.rec_engine = 'AI-powered';
SELECT county, avg_usage FROM az_drought_impact WHERE sector NOT IN ('residential') AND state = 'Arizona';
SELECT well_id, MAX(quantity) FROM production WHERE date >= DATEADD(month, -1, CURRENT_DATE) GROUP BY well_id ORDER BY MAX(quantity) DESC LIMIT 1;
SELECT vulnerability_name, COUNT(*) as occurrences, affected_system FROM vulnerabilities WHERE occurrence_time >= NOW() - INTERVAL '6 months' GROUP BY vulnerability_name, affected_system ORDER BY occurrences DESC LIMIT 5;
SELECT COUNT(*) FROM HaircareProducts WHERE ingredient_list LIKE '%Palm Oil%';
SELECT AVG(players.age) FROM players INNER JOIN esports_participants ON players.player_id = esports_participants.player_id INNER JOIN (SELECT event_id FROM esports_events WHERE location = 'Asia') AS asia_events ON esports_participants.player_id = asia_events.event_id WHERE players.vr_owner = TRUE;
SELECT city, COUNT(*) FROM research GROUP BY city;
SELECT language, topic, COUNT(*) as total FROM articles GROUP BY language, topic;
SELECT MAX(team_size) as max_team_size FROM disaster_response;
SELECT COUNT(DISTINCT ip_address) FROM security_incidents;
SELECT MIN(g.production_cost) FROM garments g;
SELECT AVG(price) FROM products WHERE cruelty_free = true AND launch_date >= '2022-01-01' AND launch_date <= '2022-03-31';
SELECT location, AVG(sustainability_rating) FROM restaurants GROUP BY location;
SELECT SUM(quantity) FROM food_production WHERE location = 'Global South';
SELECT COUNT(DISTINCT fans.fan_id) FROM fans JOIN (SELECT * FROM ticket_sales WHERE game_id IN (SELECT game_id FROM games WHERE game_type = 'Basketball')) AS basketball_ticket_sales ON fans.game_id = basketball_ticket_sales.game_id JOIN fans_merchandise ON fans.fan_id = fans_merchandise.fan_id;
SELECT name, location FROM national_security_agencies WHERE location IN ('Australia', 'Taiwan', 'South Korea');
SELECT industry, MAX(duration) as max_duration FROM cb_agreements WHERE industry = 'Education' AND state = 'Florida';
SELECT name, exhibitions FROM (SELECT name, exhibitions, ROW_NUMBER() OVER (ORDER BY exhibitions DESC) as rn FROM Artworks WHERE creation_date BETWEEN '1900-01-01' AND '1950-12-31') t WHERE rn <= 10;
SELECT AVG(members) FROM unions WHERE state = 'New York';
SELECT state, COUNT(*) FROM BuildingPermits WHERE YEAR(permit_date) = 2020 GROUP BY state;
SELECT SUM(quantity) FROM GarmentProduction WHERE material LIKE '%Recycled%' AND year = 2020;
SELECT city, community_involvement FROM CommunityPolicing WHERE city != 'SanFrancisco' AND community_involvement > (SELECT community_involvement FROM CommunityPolicing WHERE city = 'SanFrancisco');
SELECT AVG(age) FROM clinic_2022 WHERE therapy_type IS NOT NULL;
SELECT AVG(severity) FROM vulnerabilities WHERE region = 'North America';
SELECT COUNT(id) as total_mechanization_projects, SUM(budget) as total_budget FROM innovation_projects WHERE type = 'Mechanization' ORDER BY total_budget DESC;
SELECT COUNT(*) FROM marine_species;
SELECT MIN(capacity) FROM geothermal_power_plants WHERE location = 'Iceland';
SELECT * FROM open_pedagogy_resources;
SELECT w1.WellName, w1.ProductionRate FROM Wells w1 WHERE w1.ProductionRate < (SELECT w2.ProductionRate FROM Wells w2 WHERE w2.Country = w1.Country AND w2.WellID > w1.WellID ORDER BY w2.WellID ASC LIMIT 1);
SELECT a.name, SUM(d.drill_count) FROM agencies a JOIN drills d ON a.aid = d.agency_id GROUP BY a.name;
SELECT a.artistName, AVG(revenue) as avg_price FROM ArtWorkSales aws JOIN Artists a ON aws.artistID = a.artistID WHERE YEAR(aws.saleDate) = 2020 GROUP BY a.artistName;
SELECT country, SUM(loan_amount * interest_rate) FROM loans GROUP BY country;
SELECT c.Name, f.Name AS FacilityName, DATE_FORMAT(p.ProductionDate, '%Y-%m-%d') AS Date, SUM(p.QuantityProduced) AS TotalQuantityProduced FROM Production p JOIN Chemical c ON p.ChemicalId = c.Id JOIN Facility f ON p.FacilityId = f.Id GROUP BY c.Name, f.Name, Date;
SELECT COUNT(DISTINCT species_name) FROM marine_species_observations WHERE YEAR(observation_date) = 2019 AND ocean_name IN ('Southern Ocean', 'Antarctic Ocean');
SELECT SUM(investment) FROM community_development WHERE region = 'Gangetic Plains' AND completion_year = 2020;
SELECT TestTypes.TestType, COUNT(*) FROM TestTypes INNER JOIN SafetyTests ON TestTypes.Id = SafetyTests.TestTypeId GROUP BY TestTypes.TestType;
SELECT Department, COUNT(*) FROM Employees WHERE Salary > (SELECT AVG(Salary) FROM Employees) GROUP BY Department;
SELECT PolicyType, COUNT(*) as TotalClaims FROM Policy p INNER JOIN Claims c ON p.PolicyID = c.PolicyID GROUP BY PolicyType;
SELECT SUM(revenue) AS total_revenue FROM Sales WHERE sale_date BETWEEN DATEADD(day, -7, CURRENT_DATE) AND CURRENT_DATE;
SELECT LEAD(rent, 2) OVER (ORDER BY sustainability_rating DESC, rent DESC) as third_highest_rent FROM buildings WHERE city = 'London';
SELECT zone_name FROM water_distribution WHERE city = 'Toronto' AND water_shortage = true AND shortage_date BETWEEN '2020-06-01' AND '2020-09-01';
SELECT sector FROM traffic_violations WHERE date >= DATEADD(month, -1, CURRENT_DATE) GROUP BY sector HAVING COUNT(*) = 0;
SELECT COUNT(*) FROM menu_engineering WHERE restaurant_id = 2 AND change_date BETWEEN '2021-01-01' AND '2021-12-31';
SELECT COUNT(ClassID) FROM Classes WHERE ClassType = 'Yoga' AND ClassDate BETWEEN '2022-02-01' AND '2022-02-28';
SELECT date, deaths FROM opioid_overdoses WHERE location = 'West Virginia' ORDER BY date;
SELECT state, MAX(production_value) FROM agroecology.organic_farms GROUP BY state;
SELECT r.location, s.source FROM sourcing s JOIN seafood se ON s.item_id = se.item_id JOIN restaurants r ON s.restaurant_id = r.restaurant_id WHERE se.name LIKE '%seafood%';
SELECT MAX(power_watts) FROM renewable_power WHERE country IN ('India', 'Brazil', 'South Africa');
SELECT YEAR(project_date) AS year, COUNT(*) AS total_projects, COUNT(DISTINCT researcher) AS unique_researchers FROM projects GROUP BY year;
SELECT SUM(cost) FROM contracts WHERE company_name = 'ABC Tech' AND YEAR(award_date) = 2020;
SELECT type, installed_capacity FROM EcoPower.RenewableTypes;
SELECT name, country FROM HeritageSites WHERE annual_visitors > 5000;
SELECT initiative_name, cost FROM economic_diversification;
SELECT region, SUM(revenue) FROM sales_region WHERE revenue BETWEEN 0 AND 100000 AND EXTRACT(MONTH FROM timestamp) BETWEEN 1 AND 3 AND EXTRACT(YEAR FROM timestamp) = 2022 GROUP BY region;
SELECT COUNT(*) FROM Exhibitions WHERE ExhibitionCountry = 'France' AND PaintingCreationYear < 1900;
SELECT DATE_FORMAT(incident_date, '%Y-%m') AS Month, COUNT(*) as total FROM dallas_fire_incidents WHERE city = 'Dallas' AND incident_type = 'Fire' AND incident_date >= '2021-01-01' AND incident_date < '2022-01-01' GROUP BY Month;
SELECT Department, SUM(Cost) FROM Employees INNER JOIN Trainings ON Employees.EmployeeID = Trainings.EmployeeID WHERE Employees.HireYear = 2018 GROUP BY Department;
SELECT MAX(occupancy_rate) FROM eco_hotels WHERE country = 'Germany';
SELECT MAX(wins.wins) FROM wins JOIN players ON wins.player_id = players.player_id WHERE players.country = 'China' OR players.country = 'Japan';
SELECT SUM(area) FROM ocean_basins;
SELECT COUNT(*) FROM Streams JOIN Artists ON Streams.ArtistID = Artists.ArtistID WHERE Artists.Genre = 'R&B';
SELECT MAX(amount_wasted) FROM waste_production WHERE plant_location = 'California';
SELECT COUNT(*) FROM program_history WHERE state = 'Florida' AND start_year > 2015;
SELECT race_ethnicity, AVG(score) as avg_score FROM mental_health_scores GROUP BY race_ethnicity;
SELECT COUNT(*) FROM Certifications WHERE FairTrade = TRUE;
SELECT COUNT(*) FROM workouts WHERE country = 'Brazil';
SELECT (SUM(CASE WHEN region = 'Africa' THEN quantity ELSE 0 END) / SUM(quantity)) * 100 FROM production WHERE element = 'Dysprosium' AND year = 2019;
SELECT state, (employed_veterans/total_veterans) as employment_rate FROM veteran_occupations ORDER BY employment_rate DESC LIMIT 3;
SELECT COUNT(*) FROM shared_bicycles WHERE city = 'Madrid' AND dock_status = 'available';
SELECT MAX(Duration) FROM Workouts WHERE WorkoutType = 'Weightlifting';
SELECT rp.project, COUNT(DISTINCT f.funder) as funders_count, SUM(f.amount) as total_funding FROM ResearchProjects rp LEFT JOIN Funding f ON rp.project = f.project GROUP BY rp.project;
SELECT class, MIN(max_depth) FROM marine_species WHERE phylum = 'Cnidaria' GROUP BY class;
SELECT c1.region, COUNT(e1.program_name) as num_programs FROM education_programs e1 INNER JOIN countries c1 ON e1.country = c1.country GROUP BY c1.region;
SELECT AVG(Age) FROM EmployeeDemographics;
SELECT AVG(year) FROM pollution_control_initiatives WHERE location = 'Southern Ocean';
SELECT artist, COUNT(*) as song_count FROM music_streaming m INNER JOIN artist_info a ON m.artist_id = a.artist_id GROUP BY artist ORDER BY song_count DESC LIMIT 5;
SELECT AVG(age) FROM georgia_rural_residents WHERE rural_area IS NOT NULL AND diabetes = true;
SELECT AVG(Age) FROM Employees WHERE LeadershipTraining = TRUE;
SELECT COUNT(*) FROM Attendance a INNER JOIN Events e ON a.EventID = e.EventID WHERE e.Venue = 'Park' AND a.IsFirstAttendee = true;
SELECT category, COUNT(*) FROM arctic_vessels_arctic GROUP BY category;
SELECT EXTRACT(HOUR FROM start_time) as hour, COUNT(*) as session_count FROM workout_sessions GROUP BY hour ORDER BY session_count DESC;
SELECT SaleState, PolicyType, MAX(ClaimAmount) OVER (PARTITION BY SaleState) as MaxClaimAmount FROM Claims;
SELECT COUNT(ma_restaurants.restaurant_id) FROM ma_restaurants INNER JOIN ma_inspections ON ma_restaurants.restaurant_id = ma_inspections.restaurant_id WHERE ma_restaurants.state = 'MA' AND ma_inspections.result = 'Pass';
SELECT f.company, COUNT(v.fleet_id) as num_vessels FROM fleets f LEFT JOIN vessels v ON f.fleet_id = v.fleet_id GROUP BY f.company ORDER BY num_vessels DESC;
SELECT species, MAX(population) FROM animal_population GROUP BY species;
SELECT SUM(balance) FROM accounts a JOIN clients c ON a.client_id = c.id WHERE c.id IN (SELECT client_id FROM investments WHERE investment_date >= c.registered_date + INTERVAL '1 week');
SELECT building_name, certification_level FROM GreenBuildings WHERE country = 'USA' AND certification_level = 'Gold';
SELECT crop_type, SUM(amount_used) as total_amount_used FROM fertilizer_usage WHERE application_date >= DATEADD(year, -1, CURRENT_DATE) GROUP BY crop_type;
SELECT AVG(age) as avg_age FROM audience_demographics d INNER JOIN music_concerts m ON d.concert_id = m.concert_id WHERE m.concert_date >= DATEADD(year, -1, GETDATE());
SELECT name FROM species WHERE conservation_status = 'Least Concern';
SELECT AVG(Devices) FROM Users;
SELECT MAX(production_bopd) FROM Barnett_Shale WHERE well_id IS NOT NULL;
SELECT e.country, e.capacity, ee.efficiency FROM energy_storage e JOIN energy_efficiency ee ON e.country = ee.country;
SELECT SUM(initiatives) FROM conservation_initiatives WHERE country = 'Australia' AND year = 2019;
SELECT c.region, AVG(c.sessions / c.workers) FROM cultural_competency_training c INNER JOIN community_health_workers h ON c.region = h.region GROUP BY c.region;
SELECT COUNT(DISTINCT element) FROM production_rare_earth_elements WHERE year = 2019;
SELECT COUNT(*) FROM cosmetic_products cp JOIN cosmetic_formula cf ON cp.product_id = cf.product_id WHERE cp.is_cruelty_free = false AND cf.has_parabens = false;
SELECT city, SUM(labor_cost) as total_labor_cost FROM city_labor_cost WHERE project_type = 'Sustainable' AND year = 2021 GROUP BY city ORDER BY total_labor_cost DESC LIMIT 5;
SELECT region, trend, MIN(popularity) as min_popularity FROM trend_popularity WHERE region = 'South America' GROUP BY region, trend;
SELECT ContractNegotiations.country1, ContractNegotiations.country2, ContractNegotiations.date, RiskAssessments.risk_score FROM ContractNegotiations INNER JOIN RiskAssessments ON (ContractNegotiations.country1 = RiskAssessments.country OR ContractNegotiations.country2 = RiskAssessments.country) WHERE (ContractNegotiations.country1 = 'US' AND ContractNegotiations.country2 = 'Russia') OR (ContractNegotiations.country1 = 'Russia' AND ContractNegotiations.country2 = 'US');
SELECT MAX(arrival_time) FROM trips WHERE route_id = 3;
SELECT certification, criteria FROM certifications;
SELECT i.director, o.name FROM operation o JOIN intelligence_agency i ON o.agency_id = i.id ORDER BY o.success_level DESC LIMIT 3;
SELECT project FROM CybersecurityBudget WHERE budget > 500000;
SELECT t.name, t.cost FROM techniques t JOIN bioprocess_engineering be ON t.id = be.technique_id GROUP BY t.name, t.cost;
SELECT cargo_type, SUM(weight) FROM cargo_tracking GROUP BY cargo_type;
SELECT DATE_TRUNC('quarter', DonationDate) as Quarter, SUM(Amount) as TotalDonated FROM DonationDates JOIN Donations ON DonationDates.DonationId = Donations.Id GROUP BY Quarter;
SELECT EXTRACT(MONTH FROM issue_date) as month, country, COUNT(*) as num_advisories FROM travel_advisory GROUP BY month, country;
SELECT name FROM actors WHERE gender = 'Male' AND movies > 5;
SELECT state, AVG(participant_count) FROM public_participation GROUP BY state ORDER BY AVG(participant_count) DESC LIMIT 2;
SELECT d.district_name, COUNT(ci.incident_id) as total_incidents, COUNT(ec.call_id) as total_calls FROM districts d LEFT JOIN crime_incidents ci ON d.did = ci.did LEFT JOIN emergency_calls ec ON d.did = ec.did WHERE ci.incident_date BETWEEN '2022-01-01' AND '2022-01-03' AND ec.call_date BETWEEN '2022-01-01' AND '2022-01-03' GROUP BY d.district_name;
SELECT (COUNT(*) FILTER (WHERE is_organic)) * 100.0 / COUNT(*) FROM FieldD_Info WHERE crop_type = 'Organic';
SELECT program, COUNT(volunteer_name) as num_volunteers FROM volunteers WHERE signup_date >= '2021-01-01' AND signup_date < '2021-04-01' GROUP BY program;
SELECT farmer_name, SUM(funding) as total_funding FROM Agricultural_Innovation WHERE country = 'Africa' GROUP BY farmer_name ORDER BY total_funding DESC LIMIT 5;
SELECT org_id, AVG(donation_amount) AS avg_donation_amount FROM donation WHERE EXTRACT(MONTH FROM donation_date) = EXTRACT(MONTH FROM CURRENT_DATE) AND EXTRACT(YEAR FROM donation_date) = EXTRACT(YEAR FROM CURRENT_DATE) GROUP BY org_id;
SELECT COUNT(*) FROM fleets WHERE ship_type = 'Container Ship' AND build_year < 2010;
SELECT * FROM clinical_trials WHERE country = 'India' AND trial_status = 'In Progress';
SELECT state, COUNT(*) FROM hospitals GROUP BY state;
SELECT route_id, MAX(fare) as max_fare FROM route_fares GROUP BY route_id;
SELECT name FROM campaigns ORDER BY budget DESC LIMIT 1;
SELECT SUM(donation_amount) FROM events WHERE event_name = 'Fundraising Event' AND YEAR(event_date) = 2021;
SELECT surface_area FROM oceans WHERE name = 'Atlantic Ocean';
SELECT AVG(duration) FROM Sleep WHERE quality = 'good';
SELECT city, avg_income FROM us_cities ORDER BY avg_income DESC LIMIT 5;
SELECT AVG(size) FROM oil_spills WHERE location = 'Gulf of Mexico';
SELECT COUNT(DISTINCT donor_name) FROM donations WHERE donation_date >= DATEADD(quarter, -1, GETDATE());
SELECT MIN(word_count) as min_word_count FROM Articles WHERE title LIKE '%media%' OR content LIKE '%media%';
SELECT EventCategory, COUNT(*) as Popularity FROM CulturalEvents WHERE EventLocation LIKE '%%Asia' GROUP BY EventCategory ORDER BY Popularity DESC LIMIT 1;
SELECT country, AVG(production) as avg_production FROM production_data WHERE element = 'Promethium' AND country IN ('Nigeria', 'South Africa', 'Egypt') GROUP BY country;
SELECT AVG(Athletes.Salary) FROM Athletes INNER JOIN Awards ON Athletes.AthleteID = Awards.AthleteID WHERE Awards.Award = 'Finals MVP' AND Athletes.Sport = 'Basketball';
SELECT state, COUNT(*) FROM community_development WHERE completion_status = 'completed' AND state IN ('Uttar Pradesh', 'Maharashtra', 'West Bengal', 'Andhra Pradesh', 'Tamil Nadu', 'Karnataka', 'Gujarat', 'Rajasthan', 'Bihar', 'Madhya Pradesh') GROUP BY state;
SELECT project_type, SUM(installed_capacity) FROM renewable.projects GROUP BY project_type;
SELECT project_category, AVG(total_cost) OVER (PARTITION BY project_category) FROM AI_for_social_good;
SELECT OrganizationID, City, SUM(DonationAmount) OVER (PARTITION BY City) FROM Donations JOIN DonationRecipients ON Donations.DonationID = DonationRecipients.DonationID JOIN Organizations ON DonationRecipients.OrganizationID = Organizations.OrganizationID;
SELECT product_name, EXTRACT(QUARTER FROM incident_date) AS quarter, COUNT(incident_id) AS incident_count FROM safety_incident JOIN product ON safety_incident.product_id = product.product_id JOIN region ON product.region_id = region.region_id WHERE region_name = 'Asia' AND incident_date >= DATEADD(year, -1, CURRENT_DATE) GROUP BY product_name, EXTRACT(QUARTER FROM incident_date) ORDER BY incident_count DESC, quarter, product_name LIMIT 5;
SELECT AVG(consumption) FROM water_usage WHERE city = 'Nairobi' AND year BETWEEN 2015 AND 2018;
SELECT AVG(gas_price) FROM ethereum_contracts WHERE num_transactions > 1000;
SELECT date, revenue, ROW_NUMBER() OVER (ORDER BY revenue DESC) as ranking FROM daily_revenue WHERE date >= CURRENT_DATE - INTERVAL '7 days' ORDER BY date;
SELECT city_name, AVG(avg_speed) as avg_speed  FROM electric_buses eb JOIN cities c ON eb.city_id = c.city_id GROUP BY city_name ORDER BY avg_speed DESC LIMIT 3;
SELECT owner, COUNT(*) as total_satellites FROM satellites_in_orbit GROUP BY owner;
SELECT AVG(response_time) FROM police_emergencies WHERE district_id = 1 AND YEAR(incident_date) = 2021;
SELECT p.product, SUM(pi.weight) as total_india_weight FROM product_ingredients pi JOIN products p ON pi.product_id = p.product_id WHERE pi.source_country = 'India' GROUP BY p.product;
SELECT SUM(usage) FROM water_usage WHERE year = 2020;
SELECT subject, COUNT(*) as num_passed, AVG(score) as avg_mental_health_score FROM exam_results JOIN student_mental_health ON exam_results.student_id = student_mental_health.student_id WHERE passed = TRUE GROUP BY subject;
SELECT dish_name, cuisine, calorie_count FROM (SELECT dish_name, cuisine, calorie_count, RANK() OVER (PARTITION BY cuisine ORDER BY calorie_count ASC) rnk FROM dishes) t WHERE rnk = 1;
SELECT AVG(age) FROM restorative_justice;
SELECT COUNT(*) FROM contract_negotiations_un WHERE organization = 'United Nations';
SELECT DoctorsPer1000 FROM Doctors WHERE Country = 'Brazil';
SELECT name FROM project WHERE location = 'City B';
SELECT language, AVG(user_rating) as avg_rating, COUNT(*) as show_count, MIN(user_rating) as min_rating, MAX(user_rating) as max_rating FROM tv_shows WHERE language != 'English' GROUP BY language;
SELECT destination_name, country, awards, RANK() OVER (PARTITION BY country ORDER BY awards DESC) AS rank FROM Destinations;
SELECT a.name, COUNT(DISTINCT a.agency) as agency_count FROM Astronauts a INNER JOIN (SELECT agency FROM Astronauts GROUP BY agency HAVING COUNT(DISTINCT agency) > 1) b ON a.agency = b.agency GROUP BY a.id ORDER BY agency_count DESC;
SELECT AVG(doctor_count) FROM rural_clinics;
SELECT COUNT(DISTINCT users.id) AS attended_count FROM users JOIN concert_attendees ON users.id = concert_attendees.user_id WHERE users.country = 'Canada';
SELECT model, AVG(flight_distance/flight_hours) as avg_flight_speed FROM flights GROUP BY model;
SELECT o.OrgName, SUM(d.DonationAmount) FROM Organizations o CROSS JOIN OrgDonations d WHERE o.OrgID = d.OrgID AND d.DonationYear = 2020 GROUP BY o.OrgName;
SELECT * FROM Machines WHERE Type = 'Chemical';
SELECT country, 100.0 * SUM(CASE WHEN higher_education = true THEN citizens ELSE 0 END) / SUM(citizens) AS percentage FROM education GROUP BY country;
SELECT COUNT(DISTINCT e.employee_id) as num_employees FROM employees e JOIN trainings t ON e.sector = t.sector WHERE e.country = 'India' AND t.training_name = 'Solar Energy Training';
SELECT MAX(population) FROM animal_population;
SELECT COUNT(*) FROM sustainable_urbanism WHERE certification IN ('gold', 'platinum');
SELECT AVG(height) as avg_height FROM dams WHERE reservoir IN ('LakeA', 'LakeB');
SELECT program_category, COUNT(DISTINCT volunteer_id) as total_volunteers FROM Volunteers WHERE volunteer_date BETWEEN '2022-01-01' AND '2022-03-31' GROUP BY program_category;
SELECT p.Name FROM Policyholders p LEFT JOIN Claims c ON p.PolicyID = c.PolicyID WHERE c.PolicyID IS NULL;
SELECT * FROM SocialImpactInvestments WHERE Sector = 'Renewable Energy' AND ESGScore < 70 AND InvestorCountry = 'Canada' ORDER BY InvestmentDate, ESGScore ASC;
SELECT COUNT(*) FROM incidents WHERE sector = 'retail' AND risk_level = 3 AND date >= '2021-01-01' AND date < '2021-02-01';
SELECT country FROM public.forest_stats WHERE timber_volume > 5000;
SELECT COUNT(*) FROM Products WHERE FairTrade = true AND SupplierID = 5;
SELECT AVG(md.accuracy) FROM model_data md WHERE md.dataset_type = 'balanced'
SELECT region, AVG(broadband_speed) AS avg_broadband_speed FROM network_investments GROUP BY region;
SELECT SUM(tourists) FROM nz_tourism WHERE island IN ('North Island', 'South Island');
SELECT team_name, SUM(ticket_sales + sponsorships + merchandise) FROM team_revenue GROUP BY team_name;
SELECT students.country, AVG(students.mental_health_score) as avg_mental_health FROM students GROUP BY students.country;
SELECT MAX(num_chargers) FROM charging_stations;
SELECT AVG(age) FROM genetic_research.mouse;
SELECT COUNT(restaurants_tx.restaurant_id) FROM restaurants_tx INNER JOIN inspections_tx ON restaurants_tx.restaurant_id = inspections_tx.restaurant_id WHERE restaurants_tx.state = 'TX' AND inspections_tx.result = 'Fail';
SELECT author, COUNT(article_id) AS total_articles FROM articles GROUP BY author ORDER BY total_articles DESC;
SELECT name FROM expensive_space_missions WHERE cost > 1000000000;
SELECT type, COUNT(*) FROM fleet_management GROUP BY type;
SELECT COUNT(drug_name) FROM drug_approval INNER JOIN rd_expenditure ON drug_approval.drug_name = rd_expenditure.drug_name WHERE approval_body = 'EMA' AND rd_expenditure > 50000000 AND approval_year BETWEEN 2018 AND 2020;
SELECT ai_model, COUNT(*) OVER (PARTITION BY ai_model) AS incident_count FROM model_fairness;
SELECT AVG(water_consumption) FROM factory_water WHERE location = 'Africa';
SELECT m.name, SUM(mp.production_usage) FROM Material m INNER JOIN Material_Production mp ON m.id = mp.material_id WHERE m.eco_friendly = TRUE GROUP BY m.name ORDER BY SUM(mp.production_usage) DESC LIMIT 3;
SELECT SUM(CASE WHEN session_language IN ('Cree', 'Inuktitut', 'Ojibwe') THEN 1 ELSE 0 END) AS indigenous_sessions FROM therapy_session JOIN mental_health_center ON therapy_session.center_id = mental_health_center.center_id WHERE mental_health_center.location = 'Canada';
SELECT chemical_id, environmental_impact_score FROM (SELECT chemical_id, environmental_impact_score, RANK() OVER (ORDER BY environmental_impact_score DESC) as impact_rank FROM environmental_impact) WHERE impact_rank <= 3
SELECT location, material, SUM(cost) OVER (PARTITION BY EXTRACT(MONTH FROM order_date)) as total_cost FROM Midwest_Materials;
SELECT MediatorID, Name, COUNT(*) as NumCases FROM Mediators JOIN Cases ON Mediators.MediatorID = Cases.MediatorID WHERE Date >= DATEADD(year, -1, GETDATE()) GROUP BY MediatorID, Name ORDER BY NumCases DESC;
SELECT e.country, AVG(e.energy_consumption / t.tourists) AS avg_energy_consumption FROM energy_consumption e JOIN (SELECT country, SUM(tourists) AS tourists FROM energy_consumption GROUP BY country) t ON e.country = t.country GROUP BY e.country;
SELECT zone_name, MAX(dissolved_oxygen) FROM monitoring_zones GROUP BY zone_name;
SELECT MIN(size) FROM habitat WHERE location = 'South America';
SELECT cuisine_name, SUM(price) as total_revenue FROM cuisine JOIN dishes ON cuisine.cuisine_id = dishes.cuisine_id GROUP BY cuisine_name;
SELECT AVG(a.cost) FROM agri_innovations a JOIN rural_projects r ON a.project_id = r.id WHERE r.country LIKE 'Africa%';
SELECT program_name FROM support_programs WHERE disability_type = 'Physical';
SELECT MAX(animal_count) FROM SanctuaryAnimals WHERE sanctuary = 'Sanctuary A';
SELECT name FROM Canals WHERE location = 'Netherlands';
SELECT country, AVG(waste_kg / population) FROM country_waste_generation WHERE year = 2021 GROUP BY country;
SELECT SUM(income) FROM clients WHERE country = 'Philippines' AND age < 35;
SELECT Country.Name, COUNT(Country.ArtistID) as ArtistCount FROM Country GROUP BY Country.Name;
SELECT * FROM clients WHERE last_name LIKE 'S%';
SELECT severity, COUNT(*) as vulnerability_count FROM vulnerabilities WHERE discovered_date >= DATEADD(quarter, -1, GETDATE()) GROUP BY severity;
SELECT MAX(cost) FROM SustainableProduction WHERE material IN ('Organic Cotton', 'Recycled Polyester', 'Hemp');
SELECT SUM(capacity) FROM vessels WHERE company = 'Blue Whale Shipping';
SELECT name, digital_divide_score, RANK() OVER (ORDER BY digital_divide_score DESC) AS rank FROM countries;
SELECT COUNT(sm.id) FROM SpaceMissions sm JOIN Spacecraft s ON sm.spacecraft_id = s.id WHERE s.country = 'USA' AND sm.status = 'successful';
SELECT MAX(number_of_observations) FROM marine_species_observations WHERE ocean = 'Arabian Sea' AND observation_date BETWEEN '2000-01-01' AND '2022-12-31' GROUP BY ocean, DATE_TRUNC('day', observation_date);
SELECT State, AVG(Salary) AS AvgSalaryPerState FROM WorkerSalaries GROUP BY State;
SELECT home_team_id AS team_id, COUNT(*) AS games_won FROM nba_games WHERE home_team_points > away_team_points GROUP BY home_team_id UNION ALL SELECT away_team_id, COUNT(*) FROM nba_games WHERE away_team_points > home_team_points GROUP BY away_team_id;
SELECT EXTRACT(MONTH FROM issued_date) as month, COUNT(*) as num_permits FROM harvest_permits WHERE EXTRACT(YEAR FROM issued_date) = 2019 GROUP BY month;
SELECT DISTINCT category, description FROM bias_categories;
SELECT release_year, COUNT(*) as num_movies FROM movies WHERE studio_location = 'California' AND runtime > 120 GROUP BY release_year;
SELECT MIN(FuelConsumption) FROM Vessels WHERE FuelConsumption < (SELECT AVG(FuelConsumption) FROM Vessels);
SELECT country, MIN(dysprosium_prod) as least_dysprosium_prod FROM dysprosium_production WHERE year BETWEEN 2017 AND 2020 GROUP BY country ORDER BY least_dysprosium_prod ASC;
SELECT city, initiative, SUM(consumption) FROM water_consumption GROUP BY city, initiative;
SELECT name FROM companies WHERE founder_gender = 'Female' AND industry = 'Healthcare';
SELECT A.Name, SUM(T.Price) as TotalEarnings FROM Artists A INNER JOIN Concerts C ON A.ArtistID = C.ArtistID INNER JOIN Tickets T ON C.ConcertID = T.ConcertID GROUP BY A.Name HAVING TotalEarnings > 50000;
SELECT AVG(investment) FROM infrastructure_projects WHERE country IN ('Kenya', 'Nigeria', 'South Africa') AND year BETWEEN 2018 AND 2020;
SELECT SUM(*) FROM climate_communication WHERE location LIKE '%European Union%' AND launch_year >= 2015;
SELECT AVG(rating) FROM content WHERE country IN ('Australia', 'New Zealand');
SELECT COUNT(*) FROM green_buildings WHERE location = 'Islands' AND energy_efficiency_rating > 85;
SELECT AVG(operation_count) FROM defense.un_peacekeeping_operations WHERE year BETWEEN 2017 AND 2021;
SELECT country, avg_budget FROM latam_schema.education_budget WHERE (country = 'Mexico' OR country = 'Argentina') AND year = 2018;
SELECT c.initiative_id, c.score, a.avg_score FROM communication_scores c JOIN avg_communication_scores a ON c.region = a.region WHERE c.region = 'Asia' AND c.score > a.avg_score;
SELECT ProgramID, COUNT(DISTINCT VolunteerID) FROM Volunteers GROUP BY ProgramID;
SELECT Score FROM HealthcareAccess WHERE Location = 'Rural' AND Continent = 'Africa' AND Year = 2018;
SELECT country, MAX(no_farms) FROM organic_farms WHERE region = 'South America';
SELECT MAX(price) FROM products WHERE market = 'Asia' AND material IN ('organic cotton', 'sustainable wood', 'recycled polyester', 'organic linen');
SELECT sector, city, SUM(revenue) FROM museums WHERE city IN ('New York', 'London') AND sector = 'private' GROUP BY sector, city;
SELECT DISTINCT contractor_id FROM ContractorSales WHERE sale_year = 2019 AND sales_count = 0;
SELECT AVG(response_time) as avg_response_time FROM philadelphia_police_emergencies WHERE city = 'Philadelphia' AND incident_type = 'Police';
SELECT COUNT(*) / (SELECT COUNT(*) FROM bookings WHERE tour_type IN (SELECT type FROM tour_types WHERE category = 'Virtual')) AS ratio FROM bookings WHERE tour_type IN (SELECT type FROM tour_types WHERE category = 'Cultural Heritage');
SELECT SUM(amount) FROM WasteGeneration WHERE region = 'Asia-Pacific' AND year = 2021;
SELECT month, MIN(acidity_level) FROM ocean_acidity_records WHERE ocean = 'Caribbean Sea' GROUP BY month;
SELECT a.manufacturer_id, a.chemical_id, a.chemical_type, a.year, a.weight, b.weight, a.weight - b.weight as weight_difference FROM chemicals_annual a JOIN chemicals_annual b ON a.manufacturer_id = b.manufacturer_id AND a.chemical_id = b.chemical_id AND a.year = b.year + 1;
SELECT (COUNT(*) FILTER (WHERE gender = 'Female')) * 100.0 / COUNT(*) FROM fans WHERE game = '2023 FIFA Women''s World Cup';
SELECT d.contractor_name, SUM(m.sale_value) as total_sales FROM defense_contractors d INNER JOIN military_sales m ON d.contractor_id = m.contractor_id GROUP BY d.contractor_name;
SELECT species, MAX(sequestration_rate) FROM forest_species;
SELECT SUM(revenue) as total_revenue FROM sales WHERE sale_date BETWEEN '2021-10-01' AND '2021-12-31' AND is_organic = true;
SELECT SUM(cost) AS total_cost FROM MenuItems WHERE location = 'Toronto' AND ingredient = 'Chicken';
SELECT COUNT(species) FROM arctic_marine_species;
SELECT AVG(age) as avg_age, gender FROM readers GROUP BY gender;
SELECT SUM(investment) FROM clients INNER JOIN fund_investments ON clients.client_id = fund_investments.client_id WHERE clients.name LIKE '%Garcia%';
SELECT SUM(savings_percentage) FROM Conservation WHERE state = 'Texas' AND year = 2021;
SELECT IndigenousCommunities.name FROM IndigenousCommunities INNER JOIN Climate ON IndigenousCommunities.climate_id = Climate.id WHERE Climate.temperature = (SELECT MIN(temperature) FROM Climate);
SELECT Gender, AVG(MentalHealthScore) FROM Student GROUP BY Gender;
SELECT threat_actor_group, COUNT(*) as total_attacks FROM cyber_attacks WHERE attack_date >= DATEADD(year, -1, GETDATE()) GROUP BY threat_actor_group;
SELECT MIN(DonationAmount) FROM Donations2022 WHERE DonorType = 'Individual' AND FirstTimeDonor = 'Y';
SELECT SUM(duration) FROM user_workouts_march WHERE user_id IN (SELECT user_id FROM (SELECT user_id, EXTRACT(YEAR FROM timestamp) as birth_year FROM user_workouts_march) subquery WHERE subquery.birth_year BETWEEN EXTRACT(YEAR FROM timestamp) - 25 AND EXTRACT(YEAR FROM timestamp) - 20 AND EXTRACT(MONTH FROM timestamp) = 3);
SELECT b.type, COUNT(g.id) FROM biosensor b JOIN gene g ON b.id = g.biosensor_id GROUP BY b.type;
SELECT Donors.DonorName, Donors.Country FROM Donors INNER JOIN Contributions ON Donors.DonorID = Contributions.DonorID WHERE Contributions.Program = 'Education for All' AND Contributions.ContributionDate BETWEEN '2021-01-01' AND '2021-12-31';
SELECT a.supporter AS supporter1, b.supporter AS supporter2, a.donation_date FROM donations AS a INNER JOIN donations AS b ON a.donation_date = b.donation_date WHERE a.supporter <> b.supporter;
SELECT AVG(TicketPrice) FROM Exhibitions WHERE Category = 'Digital Art' AND Visitors > 1000;
select Location, AVG(Temperature) as AvgTemperature, DATE_PART('week', Timestamp) as Week from WeatherData group by Location, Week;
SELECT species, conservation_status FROM atlantic_marine_life;
SELECT field_id, SUM(rainfall) FROM field_rainfall WHERE reading_date BETWEEN '2021-09-01' AND '2021-09-30' GROUP BY field_id;
SELECT s.school_name, (COUNT(sc.student_id) * 100.0 / (SELECT COUNT(*) FROM students st JOIN student_courses sc ON st.student_id = sc.student_id WHERE sc.course_id IN (SELECT course_id FROM courses WHERE course_name LIKE '%open pedagogy%'))) AS percentage FROM schools s JOIN students st ON s.school_id = st.school_id JOIN student_courses sc ON st.student_id = sc.student_id GROUP BY s.school_id;
SELECT name, cost FROM carbon_offset_programs WHERE location = 'Ontario';
SELECT SUM(co2_emissions) FROM co2_emissions WHERE country IN ('Sweden', 'Norway', 'Denmark') ORDER BY co2_emissions ASC LIMIT 3;
SELECT AVG(p.age) FROM patients p JOIN treatments t ON p.id = t.patient_id WHERE t.type = 'therapy' AND t.community_center_id = 1;
SELECT recipient_id FROM donations WHERE donor_id = 1 AND donation_date BETWEEN '2021-01-01' AND '2021-12-31';
SELECT AVG(age) FROM media.reporters WHERE gender = 'Female';
SELECT category, title, hourly_wage, ROW_NUMBER() OVER (PARTITION BY category ORDER BY hourly_wage DESC) as wage_rank FROM labor_statistics;
SELECT MAX(price) FROM events WHERE category = 'theater';
SELECT program_id, COUNT(*) as num_volunteers FROM volunteers GROUP BY program_id;
SELECT * FROM Donations WHERE donation_date BETWEEN '2022-01-01' AND '2022-01-31'
SELECT SUM(Revenue) FROM GameRevenue WHERE GameType = 'Puzzle' AND Platform = 'Mobile' AND Year = 2021;
SELECT COUNT(*) FROM volunteers WHERE (activity = 'disaster response' AND location = 'Haiti') OR (activity = 'community development' AND location = 'India');
SELECT site_id, productivity FROM labor_productivity ORDER BY productivity ASC LIMIT 1;
SELECT genre, COUNT(*) FROM TV_Shows_Genre GROUP BY genre;
SELECT AVG(DATEDIFF(day, MISSION.assignment_date, LEAD(MISSION.assignment_date) OVER (PARTITION BY ASTRONAUT.id ORDER BY MISSION.assignment_date))) as average_duration FROM Astronauts ASTRONAUT JOIN Astronaut_Missions MISSION ON ASTRONAUT.id = MISSION.astronaut_id WHERE ASTRONAUT.mission_count > 3;
SELECT program_id, location, budget FROM Carbon_Offset_Programs WHERE budget > 1000000.0 AND location = 'United States';
SELECT COUNT(*) FROM soccer_teams WHERE sport = 'football';
SELECT total_sales FROM sales_by_quarter WHERE sales_year = 2024 AND sales_quarter = 1 AND category = 'Knit';
SELECT country, COUNT(*) FROM climate_monitoring_stations GROUP BY country;
SELECT d.name AS department, e.role, COUNT(e.id) AS employee_count FROM Employee e, MiningDepartment d WHERE e.department_id = d.id AND d.name = 'Mining Operations' GROUP BY e.role;
SELECT crop_name, SUM(yield) as total_production FROM crops WHERE system_type = 'Indigenous' GROUP BY crop_name;
SELECT COUNT(*) FROM (SELECT vessel_name FROM vessels_2 WHERE LENGTH(vessel_name) > 15) as temp;
SELECT AVG(depth) FROM ocean_floor WHERE ocean = 'Pacific';
SELECT Region, (SUM(CASE WHEN Language = 'Spanish' THEN Count ELSE 0 END) / SUM(Count)) * 100 AS Percentage FROM CulturalCompetencyTrainings GROUP BY Region;
SELECT ROUND(COUNT(*) * 100.0 / (SELECT COUNT(*) FROM Employees) , 1) AS PromotionPercentage FROM Employees WHERE PromotionDate >= DATEADD(day, -90, GETDATE());
SELECT AVG(count) FROM transportation_per_country;
SELECT location, COUNT(*) FROM humanitarian_assistance GROUP BY location;
SELECT SUBSTRING_INDEX(SUBSTRING_INDEX(content, ' ', n.n), ' ', -1) word, COUNT(*) count FROM posts JOIN users ON posts.user_id = users.id CROSS JOIN (SELECT 1 n UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5) n WHERE users.country = 'Germany' GROUP BY word ORDER BY count DESC LIMIT 1;
SELECT 100.0 * COUNT(CASE WHEN status = 'open' THEN 1 END) / COUNT(*) FROM open_data_initiatives WHERE sector = 'education';
SELECT schedule_date, COUNT(DISTINCT vehicle_id) as total_vehicles FROM maintenance_schedule ms JOIN vehicles v ON ms.vehicle_id = v.vehicle_id GROUP BY schedule_date;
SELECT SUM(capacity) FROM project WHERE (type = 'Geothermal' OR type = 'Wind');
SELECT city, COUNT(*) as num_games FROM game_results GROUP BY city;
SELECT * FROM investments WHERE fund_type = 'Real Estate' GROUP BY customer_id ORDER BY SUM(investment_amount) DESC LIMIT 3;
SELECT sector, initiative FROM circular_economy;
SELECT MIN(production_volume) FROM mines WHERE location = 'Europe' AND year = 2018;
SELECT brand, COUNT(DISTINCT model) as total_models FROM electric_vehicles GROUP BY brand;
SELECT driller, COUNT(*) as num_wells FROM wells WHERE driller NOT IN (SELECT driller FROM wells WHERE production_rate > 1200) GROUP BY driller;
SELECT f.location, f.name, f.ethical_manufacturing FROM factories f WHERE (f.location, f.ethical_manufacturing) IN (SELECT f1.location, MAX(f1.ethical_manufacturing) FROM factories f1 GROUP BY f1.location);
SELECT COUNT(*) FROM ConcertInfo WHERE year BETWEEN 2017 AND 2019 AND country = 'United States' AND sold_out = TRUE;
SELECT date_format(production_date, '%Y-%q') as quarter, sum(quantity) as total_quantity FROM production_quebec WHERE plant_location = 'Quebec chemical plant' GROUP BY quarter;
SELECT u.username, SUM(p.comment_count) as total_comments FROM users u JOIN posts p ON u.id = p.user_id WHERE p.category = 'travel' AND p.timestamp >= '2021-09-01' GROUP BY u.username ORDER BY total_comments DESC LIMIT 5;
SELECT AVG(Artworks.price) FROM Artworks INNER JOIN Artists ON Artworks.artist_id = Artists.artist_id WHERE Artists.country = 'India' AND Artists.birth_date BETWEEN '1880-01-01' AND '1900-12-31';
SELECT i.city, SUM(ll.ll_hours) as total_hours_lifelong_learning FROM individuals i JOIN lifelong_learning ll ON i.individual_id = ll.individual_id GROUP BY i.city;
SELECT trench_name, depth FROM (SELECT trench_name, depth, RANK() OVER (ORDER BY depth DESC) as trench_rank FROM underwater_trenches) t WHERE trench_rank <= 3;
SELECT COUNT(*) FROM austin_properties WHERE inclusive_housing_policy = TRUE;
SELECT well_id, date, type, quantity FROM daily_production WHERE region = 'Eastern';
SELECT AVG(num_courses) FROM educators WHERE indigenous = true;
SELECT COUNT(*) FROM whale_sightings WHERE species = 'whale' AND region = 'North Atlantic' AND year IN (2020, 2021);
SELECT SUM(num_volunteers) FROM (SELECT num_volunteers FROM volunteer_events WHERE year IN (2021, 2022)) subquery;
SELECT DATE_TRUNC('month', d.created_at) as month, SUM(o.price) as revenue FROM dishes d JOIN orders o ON d.dish_id = o.dish_id WHERE d.is_organic = TRUE AND d.created_at >= NOW() - INTERVAL '6 months' GROUP BY month ORDER BY month;
SELECT AVG(habitat_depth) FROM species WHERE ocean_basin = 'Pacific';
SELECT SUM(LandfillCapacity.capacity) FROM LandfillCapacity INNER JOIN Population ON LandfillCapacity.district = Population.district WHERE Population.population > 500000;
SELECT brand_name, fair_trade_items, PERCENT_RANK() OVER (ORDER BY fair_trade_items) as fair_trade_percent FROM fair_trade_brands;
SELECT City, AVG(Vendor_Count) FROM Vendor WHERE Department = 'Parks' AND City = 'CityC' GROUP BY City;
SELECT project_type, AVG(cost) as avg_cost FROM public_works_projects WHERE state IN ('New York', 'California') GROUP BY project_type;
SELECT Country, COUNT(DISTINCT AttendeeID) as NumberOfAttendees FROM EventAttendance JOIN Attendees ON EventAttendance.AttendeeID = Attendees.ID GROUP BY Country;
SELECT r.region_name, COUNT(wh.habitat_id) as total_habitats FROM regions r JOIN wildlife_habitats wh ON r.region_id = wh.region_id GROUP BY r.region_name;
SELECT p.category, SUM(i.quantity) as total_quantity FROM inventory i JOIN product p ON i.product = p.name GROUP BY p.category;
SELECT region, AVG(price) as avg_price FROM carbon_prices WHERE region = 'European Union' AND date BETWEEN '2022-01-01' AND '2022-06-30' GROUP BY region;
SELECT ProviderID, HealthEquityMetricScore FROM (SELECT ProviderID, HealthEquityMetricScore, ROW_NUMBER() OVER (ORDER BY HealthEquityMetricScore ASC) as Rank FROM MentalHealthProviders) as RankedData WHERE Rank <= 3;
SELECT MIN(content_rating) FROM TV_Shows WHERE genre = 'Anime';
SELECT (SUM(CASE WHEN source IN ('Wind', 'Solar') THEN production_mwh ELSE 0 END) / SUM(production_mwh)) * 100 AS renewable_percentage FROM energy_production WHERE state = 'Texas';
SELECT DISTINCT workout_name, SUM(calories) FROM Workouts JOIN Users ON Workouts.user_id = Users.id WHERE Users.age >= 40 GROUP BY workout_name;
SELECT Company, SUM(Revenue) FROM SalesRevenue WHERE Country = 'India' AND Year = 2020 GROUP BY Company;
SELECT MIN(capacity) FROM hydro_power WHERE country = 'Brazil';
SELECT * FROM customers c WHERE c.customer_id NOT IN (SELECT t.customer_id FROM transactions t WHERE t.transaction_date >= DATEADD(month, -1, GETDATE()));
SELECT student_name FROM students WHERE student_id NOT IN (SELECT student_id FROM enrollments);
SELECT name FROM Roads WHERE location = 'California' AND lanes > 3;
SELECT f.name as faculty_member, COUNT(p.id) as num_publications FROM Faculty f JOIN Publication p ON f.id = p.faculty_id WHERE YEAR(p.year) BETWEEN YEAR(CURDATE()) - 3 AND YEAR(CURDATE()) GROUP BY f.name;
SELECT country, AVG(capacity) as avg_capacity FROM pumped_hydro_storage GROUP BY country;
SELECT MAX(y.age) FROM patients y INNER JOIN vaccine_administered a ON y.patient_id = a.patient_id WHERE a.vaccine_name = 'Johnson & Johnson' AND a.state = 'New York';
SELECT SUM(Budget) FROM (SELECT Budget FROM Programs ORDER BY Budget DESC LIMIT 2) subquery;
SELECT COUNT(*) as component_count FROM Spacecraft_Components COMPONENT JOIN Spacecraft_Manufacturers MANUFACTURER ON COMPONENT.manufacturer = MANUFACTURER.manufacturer_name WHERE MANUFACTURER.location LIKE '%Africa%';
SELECT Employees.Name, Employees.Salary FROM Employees WHERE Employees.Department = 'Mining Operations';
SELECT p.name FROM programs p LEFT JOIN program_funding_2 f ON p.id = f.program_id WHERE f.program_id IS NULL;
SELECT City.name FROM City WHERE City.population > 1000000;
SELECT species, MIN(age) FROM mature_forest GROUP BY species;
SELECT City, MIN(Score) as MinScore FROM CommunityHealthWorkers GROUP BY City;
SELECT COUNT(*) FROM open_data_initiatives WHERE sector = 'Healthcare' AND num_datasets > 100;
SELECT country, MIN(total_sales) as lowest_q3_sales FROM HaircareSales WHERE product_name LIKE '%haircare%' AND sale_date BETWEEN '2022-07-01' AND '2022-09-30' GROUP BY country;
SELECT AVG(age) FROM patients WHERE condition = 'Anxiety' AND treatment = 'Medication' AND state = 'New York';
SELECT country, COUNT(*) FROM satellites_by_country WHERE launch_year >= 2010 GROUP BY country;
SELECT region, MIN(projects) as min_projects FROM military_innovation WHERE region = 'Asia' AND year = 2020 GROUP BY region;
SELECT location, COUNT(*) FROM community_health_workers GROUP BY location;
SELECT mobile_plans.name AS mobile_plan, AVG(subscribers.retention_rate) FROM subscribers JOIN mobile_plans ON subscribers.plan_id = mobile_plans.id JOIN regions ON mobile_plans.region = regions.name WHERE regions.name = 'Asia' GROUP BY mobile_plans.name;
SELECT ocean, MAX(max_depth) FROM ocean_depths;
SELECT name FROM MilitaryOperations WHERE location = 'South America' ORDER BY year DESC LIMIT 1;
SELECT region, SUM(timber_volume) as total_timber_volume FROM forests WHERE year = 2020 GROUP BY region;
SELECT r.name, COUNT(ts.id) num_protected_species FROM regions r JOIN tree_species ts ON r.id = ts.region_id WHERE ts.protected = 1 GROUP BY r.name;
SELECT location, MIN(installed_capacity) FROM GreenEnergy.RenewableProjects;
SELECT DISTINCT machinery_type FROM machinery m1 WHERE NOT EXISTS (SELECT 1 FROM machinery m2 WHERE m1.machinery_type = m2.machinery_type AND m2.department != 'Engineering');
SELECT MIN(start_date) FROM campaigns WHERE focus = 'self-care';
SELECT customer_id, RANK() OVER (ORDER BY SUM(transaction_value) DESC ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS customer_rank FROM customers WHERE transaction_date >= DATEADD(week, -1, CURRENT_DATE) GROUP BY customer_id HAVING COUNT(*) >= 7;
SELECT SUM(production_rate) FROM wells WHERE region = 'North Sea';
SELECT p.name, cp.preference_score FROM canada_cosmetics_preferences cp INNER JOIN products p ON cp.product_id = p.id WHERE cp.is_cruelty_free = false ORDER BY cp.preference_score DESC;
SELECT SUM(sqft) FROM green_buildings WHERE city = 'Chicago' AND certification IN ('LEED', 'GreenGlobes');
SELECT AVG(employees) FROM startups WHERE founders = 'Veterans' AND industry = 'Cybersecurity';
SELECT technology, COUNT(*) FROM storage_projects WHERE year >= 2016 GROUP BY technology;
SELECT Country, SUM(Waste) OVER (PARTITION BY Country ORDER BY WasteDate ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) AS TotalWaste, RANK() OVER (ORDER BY SUM(Waste) DESC) AS Rank FROM WasteGeneration WHERE WasteDate >= DATEADD(month, -1, CURRENT_TIMESTAMP) GROUP BY Country, WasteDate HAVING Rank <= 3
SELECT AVG(points_per_game) FROM players WHERE country = 'USA';
SELECT * FROM research_grants WHERE amount > 100000;
SELECT city_name, AVG(waste_generated/population) OVER (PARTITION BY city_name) as avg_waste_per_capita FROM city_waste_generation;
SELECT conservation_status, COUNT(*) FROM marine_species_status WHERE species_name IN (SELECT species_name FROM oceanography) GROUP BY conservation_status;
SELECT AVG(visitors) FROM tourists WHERE country = 'India' AND year IN (2018, 2019);
SELECT AVG(rating) FROM hotels WHERE city = 'Barcelona';
SELECT SUM(neodymium_prod) FROM (SELECT * FROM producers WHERE name IN ('China', 'USA', 'Australia', 'Myanmar', 'India') AND production_year = 2021 ORDER BY neodymium_prod DESC) WHERE rownum <= 5;
SELECT SUM(impact) FROM local_impact WHERE location = 'Brazil';
SELECT supplier_id, COUNT(DISTINCT id) FROM products GROUP BY supplier_id;
SELECT (COUNT(*) * 100.0 / (SELECT COUNT(*) FROM customers WHERE country = 'USA')) FROM customers WHERE size >= 16 AND country = 'USA';
SELECT COUNT(*) FROM Exhibitions WHERE Exhibitions.start_date BETWEEN '1900-01-01' AND '1950-12-31' AND Exhibitions.country = 'France';
SELECT SUM(enable_dm) as total_users_with_dm FROM privacy_settings;
SELECT SUM(art_pieces) FROM museums WHERE region = 'Europe';
SELECT COUNT(*) FROM multimodal_trips WHERE city = 'Chicago';
SELECT c.name, COUNT(cr.id) FROM cities c JOIN crimes cr ON c.id = cr.city_id WHERE cr.date >= DATEADD(month, -3, GETDATE()) GROUP BY c.id;
SELECT n.name, COUNT(c.id) FROM cities c JOIN neighborhoods n ON c.cid = n.city_id JOIN crimes ON n.nid = c.neighborhood_id WHERE c.name = 'CityName' GROUP BY n.name;
SELECT COUNT(*) FROM courts WHERE year = 2017 AND online_dispute_resolution = TRUE;
SELECT e.SiteName, COUNT(*) AS ArtifactCount FROM ExcavationSites e JOIN ArtifactCounts c ON e.SiteID = c.SiteID GROUP BY e.SiteName ORDER BY ArtifactCount DESC;
SELECT departments.name, COUNT(*) AS num_employees FROM hr.departments JOIN hr.employees ON departments.id = employees.department_id GROUP BY departments.name ORDER BY num_employees DESC LIMIT 1;
SELECT COUNT(DISTINCT program) FROM students;
SELECT SUM(gp.production) as total_production FROM gas_production gp JOIN wells w ON gp.well_id = w.id WHERE w.location = 'South China Sea' AND gp.year = 2020;
SELECT SUM(capacity) FROM wind_farms WHERE country IN ('Germany', 'France') AND year = 2020;
SELECT MIN(year) AS earliest_year FROM Artworks WHERE artist LIKE 'Latinx Artist%';
SELECT name, num_hotels FROM OTAs WHERE city = 'New York' ORDER BY num_hotels DESC LIMIT 3;
SELECT factories.name, factories.location FROM factories LEFT JOIN workforce_development ON factories.factory_id = workforce_development.factory_id WHERE workforce_development.factory_id IS NULL;
SELECT patient_count FROM clinical_trials WHERE trial_name = 'Trial-B' AND drug_name = 'DEF-789';
SELECT technology, MAX(capacity) AS max_capacity FROM energy_storage WHERE year = 2025 GROUP BY technology;
SELECT SUM(budget) as total_budget FROM departments d WHERE open_data = false AND (SELECT COUNT(*) FROM policies p WHERE d.id = p.department_id AND evidence_based = true) < 3;
SELECT f.name, f.department FROM faculty f LEFT JOIN publications p ON f.faculty_id = p.faculty_id WHERE p.year IS NULL;
SELECT mining_sites.site_name, extraction_methods.method_name, SUM(workers.num_workers) AS total_workers FROM mining_sites INNER JOIN extraction_methods ON mining_sites.site_id = extraction_methods.site_id INNER JOIN workers ON mining_sites.site_id = workers.site_id AND extraction_methods.method_id = workers.method_id GROUP BY mining_sites.site_name, extraction_methods.method_name;
SELECT state, AVG(daily_consumption/population) FROM WaterUsage INNER JOIN Population ON WaterUsage.date = Population.date GROUP BY state;
SELECT vessel_name FROM vessel_performance WHERE fuel_efficiency IN (SELECT DISTINCT fuel_efficiency FROM vessel_performance ORDER BY fuel_efficiency DESC LIMIT 3);
SELECT country, AVG(temperature - LAG(temperature) OVER (PARTITION BY country ORDER BY year)) AS avg_annual_temp_change FROM temperature_data WHERE country IN (SELECT DISTINCT country FROM temperature_data WHERE country LIKE 'Arctic%') GROUP BY country
SELECT MAX(Attendance), Borough FROM CommunityEvents GROUP BY Borough;
SELECT company, COUNT(*) as total, SUM(CASE WHEN result = 'success' THEN 1 ELSE 0 END) as success, (SUM(CASE WHEN result = 'success' THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) as success_rate FROM launches WHERE company = 'SpaceX' GROUP BY company;
SELECT AVG(media_literacy_score) FROM users WHERE country = 'USA';
SELECT year, AVG(biomass) AS avg_biomass FROM fish_biomass WHERE region = 'Indian Ocean' GROUP BY year;
SELECT f.name, f.department, COUNT(g.grant_id) as grant_count FROM faculty f INNER JOIN grants g ON f.faculty_id = g.faculty_id WHERE f.gender = 'Female' GROUP BY f.name, f.department ORDER BY grant_count DESC;
SELECT COUNT(*) FROM education_programs WHERE year IN (2021, 2022);
SELECT (LAG(SUM(units_sold)) OVER (PARTITION BY product_id ORDER BY year, quarter) - SUM(units_sold)) * 100.0 / LAG(SUM(units_sold)) OVER (PARTITION BY product_id ORDER BY year, quarter) AS pct_change FROM sales_by_quarter WHERE product_id = 2 AND year = 2022 AND quarter IN (1, 3);
SELECT department_id, COUNT(project_id) as num_projects_completed FROM op_projects WHERE completion_date >= DATEADD(month, -6, CURRENT_TIMESTAMP) AND completed = true GROUP BY department_id;
SELECT MAX(incident_date) FROM safety_records;
SELECT state, hospital_name, MIN(num_beds) as min_beds FROM hospitals GROUP BY state;
SELECT region, SUM(sales.revenue) as total_revenue FROM sales JOIN games ON sales.game_id = games.id GROUP BY region ORDER BY total_revenue DESC LIMIT 1;
SELECT AVG(duration) FROM songs WHERE genre = 'Rock';
SELECT COUNT(*) FROM threat_intelligence WHERE region = 'Middle East' AND YEAR(date) = 2021;
SELECT COUNT(DISTINCT um.union_id) FROM union_members um INNER JOIN unions u ON um.union_id = u.union_id WHERE u.focus = 'technology';
SELECT COUNT(*) FROM species WHERE conservation_status IN ('Endangered', 'Vulnerable', 'Critically Endangered');
SELECT DonorName, Amount FROM Donations d JOIN Donors don ON d.DonorID = don.DonorID WHERE Amount > 700;
SELECT trench_name, avg_depth FROM (SELECT trench_name, avg_depth, ROW_NUMBER() OVER (ORDER BY avg_depth DESC) as rn FROM Atlantic_plate) tmp WHERE rn <= 3;
SELECT COUNT(*) as TotalMembers   FROM UnionMembership   JOIN Unions ON UnionMembership.UnionID = Unions.UnionID   WHERE Unions.UnionName = 'Safety Advocates';
SELECT COUNT(*) FROM teacher_professional_development WHERE year = 2022 AND completed = TRUE;
SELECT artist, SUM(play_count) as total_plays FROM music GROUP BY artist ORDER BY total_plays DESC LIMIT 3;
SELECT AVG(adoption_rate) FROM agroecology_practices WHERE country IN ('Brazil', 'Argentina', 'Colombia');
SELECT SUM(wins) FROM teams_mascots WHERE mascot LIKE 'B%';
SELECT AVG(amount) FROM grants WHERE department = 'Sciences';
SELECT COUNT(*) FROM wastewater_treatment_plants WHERE state IN ('Texas', 'New York');
SELECT BrandName, (SUM(QuantityUsed) * 100.0 / (SELECT SUM(QuantityUsed) FROM Materials WHERE MaterialName IN ('Organic Cotton', 'Recycled Polyester', 'Recycled Cotton', 'Hemp'))) AS Percentage FROM Materials GROUP BY BrandName;
SELECT products.product_name FROM products INNER JOIN sales ON products.product_id = sales.product_id WHERE products.is_cruelty_free = true AND sales.region = 'US';
SELECT roaming_country, COUNT(DISTINCT subscriber_id) FROM mobile_subscribers_roaming WHERE roaming_country IN ('Canada', 'Mexico') GROUP BY roaming_country;
SELECT COUNT(*) FROM properties WHERE green_building_certified = true AND sustainability_rating > 70;
SELECT date, COUNT(*) as total_threats, AVG(category = 'malware'::int) as avg_malware FROM threat_intel WHERE source = 'African Threat Intelligence' GROUP BY date ORDER BY date;
SELECT team_id, SUM(num_fans) FROM events GROUP BY team_id;
SELECT industry, SUM(funding_amount) as total_funding FROM industry_funding GROUP BY industry ORDER BY total_funding DESC LIMIT 3;
SELECT artist, SUM(artworks) AS total_donations FROM donations GROUP BY artist ORDER BY total_donations DESC LIMIT 3;
SELECT AVG(property_price/size) FROM sustainable_buildings;
SELECT state, SUM(quantity) as total_vaccinations FROM vaccinations WHERE vaccine_type = 'Flu' AND age > 65 AND year = 2021 GROUP BY state;
SELECT AVG(Age) FROM Players WHERE Region = 'Africa';
SELECT AVG(age) as avg_age, SUM(transaction_fee) as total_fees FROM smart_contracts WHERE app_category = 'DeFi';
SELECT recipient, SUM(amount) AS total_climate_finance FROM climate_finance WHERE year = 2019 AND category = 'mitigation' GROUP BY recipient HAVING total_climate_finance > 5000000 ORDER BY total_climate_finance DESC LIMIT 3;
SELECT city, AVG(visitors) FROM Exhibitions GROUP BY city;
SELECT city, AVG(attendance) as avg_attendance FROM cultural_events GROUP BY city;
SELECT focus, continent, COUNT(id) as total_efforts FROM policy_advocacy WHERE year BETWEEN 2017 AND 2022 AND focus IN ('Accessibility', 'Education', 'Employment') GROUP BY focus, continent;
SELECT score FROM financial_wellbeing WHERE customer_id = 11121;
SELECT SUM(w.energy_generated) + SUM(s.energy_generated) AS total_energy, c.price FROM wind_energy w JOIN solar_energy s ON w.year = s.year JOIN carbon_pricing c ON w.region = c.region WHERE w.year = 2021 GROUP BY w.region;
SELECT name, manufacturer FROM satellites ORDER BY launch_date ASC LIMIT 1;
SELECT MIN(acidity) FROM ocean_acidity WHERE ocean = 'Arctic';
SELECT neighborhood_id, COUNT(DISTINCT property_id) as properties_sold FROM property_sales JOIN properties ON property_sales.property_id = properties.property_id WHERE sale_year BETWEEN 2018 AND 2020 GROUP BY neighborhood_id;
SELECT borough, COUNT(*) as event_count FROM Events WHERE event_date BETWEEN '2021-01-01' AND '2021-12-31' GROUP BY borough;
SELECT Program FROM RecyclingPrograms WHERE City = 'Toronto' AND StartYear BETWEEN 2015 AND 2020;
SELECT country, AVG(points_per_game) as avg_points FROM players GROUP BY country;
SELECT site_name, pollution_level FROM mining_sites WHERE pollution_level > (SELECT AVG(pollution_level) FROM mining_sites);
SELECT name, social_impact_score FROM Organizations WHERE social_impact_score > 80;
SELECT COUNT(*) FROM player_stats WHERE country = 'USA';
SELECT project, SUM(reduction) as total_co2_reduction FROM co2_emission_reduction WHERE reduction_unit = 'metric tons' GROUP BY project HAVING total_co2_reduction > 1000;
SELECT MAX(installed_capacity) FROM renewables.renewable_projects;
SELECT COUNT(*) FROM mars_rovers WHERE agency = 'NASA' AND (type = 'Rover' OR type = 'Orbiter');
SELECT SUM(cost) FROM economic_diversification WHERE country = 'Nigeria' AND (year = 2018 OR year = 2019);
SELECT funding_received FROM Programs WHERE location = 'New York';
SELECT w1.WellName, w1.ProductionRate FROM Wells w1 WHERE w1.ProductionRate > (SELECT w2.ProductionRate FROM Wells w2 WHERE w2.Country = w1.Country AND w2.WellID < w1.WellID ORDER BY w2.WellID DESC LIMIT 1);
SELECT EXTRACT(MONTH FROM production_date) AS month, operation_id, SUM(amount_waste) AS total_waste FROM waste_production JOIN mining_operations ON waste_production.operation_id = mining_operations.operation_id GROUP BY month, operation_id;
SELECT Region, SUM(Calories) as TotalCalories FROM Meals WHERE IsLocal = TRUE GROUP BY Region;
SELECT COUNT(*) FROM platform_production WHERE location = 'Sea of Okhotsk' AND production > 10000;
SELECT AVG(mass) FROM SpacecraftManufacturing WHERE manufacturer = 'SpaceForAll';
SELECT country, year, COUNT(*) as num_cases FROM flu_cases WHERE year = 2020 GROUP BY country, year;
SELECT COUNT(*) FROM agricultural_innovation_projects WHERE budget > 50000 AND country = 'India';
SELECT city, COUNT(DISTINCT s.id) as Total_Stops, COUNT(DISTINCT r.id) as Total_Routes FROM stops s JOIN routes r ON s.city = r.city GROUP BY city;
SELECT COUNT(*) FROM AuthenticationLogs WHERE username LIKE '%admin%' AND authentication_status = 'Failed';
SELECT city, AVG(amount) as avg_donation FROM Donations GROUP BY city;
SELECT COUNT(DISTINCT train_type) FROM trains;
SELECT COUNT(*) FROM security_incidents WHERE region = 'South America';
SELECT spectral_type, MIN(absolute_magnitude) as min_absolute_magnitude FROM Stars WHERE spectral_type = 'B1V' GROUP BY spectral_type;
SELECT extraction_state, SUM(extraction_amount) as total_extraction FROM mineral_extraction_us WHERE extraction_date >= DATEADD(year, -1, CURRENT_DATE) GROUP BY extraction_state;
SELECT p.ProgramID, p.ProgramName, COUNT(v.VolunteerID) * 100.0 / (SELECT COUNT(*) FROM Volunteers) AS Percentage FROM Programs p LEFT JOIN Volunteers v ON p.ProgramID = v.ProgramID WHERE p.StartDate >= '2018-01-01' GROUP BY p.ProgramID, p.ProgramName ORDER BY Percentage DESC;
SELECT s.name as student_name FROM Students s LEFT JOIN Student_Program_Mapping spm ON s.id = spm.student_id LEFT JOIN Support_Programs sp ON spm.program_id = sp.id WHERE sp.name = 'Special Ed' AND sp.id IS NULL;
SELECT COUNT(*) FROM Shipments WHERE country = 'Country X' AND EXTRACT(MONTH FROM shipment_date) = 1 AND EXTRACT(YEAR FROM shipment_date) = 2022;
SELECT SUM(loan_amount) FROM microfinance_clients WHERE country = 'Country X';
SELECT AVG(rating) FROM Products WHERE organic = TRUE AND launch_year = 2021;
SELECT country, COUNT(*) as count FROM articles WHERE category = 'politics' GROUP BY country ORDER BY count DESC, country ASC LIMIT 1; SELECT country, COUNT(*) as count FROM articles WHERE category = 'politics' GROUP BY country ORDER BY count ASC, country ASC LIMIT 1;
SELECT MAX(budget) FROM criminal_justice_reform_initiatives WHERE year >= 2018 AND state = 'Michigan';
SELECT COUNT(*) FROM companies INNER JOIN investment_rounds ON companies.id = investment_rounds.company_id WHERE founder_race IN ('African American', 'Hispanic') AND round_type = 'Series A';
SELECT name FROM initiatives WHERE country IN ('Spain', 'Italy') AND launch_year > 2010;
SELECT name, total_days_in_space FROM spacecraft ORDER BY total_days_in_space DESC LIMIT 1;
SELECT SUM(streams) FROM music_streaming WHERE artist_nationality LIKE '%Latin%';
SELECT year, COUNT(*), SUM(budget) FROM military_innovation WHERE year >= 2017 GROUP BY year;
SELECT COUNT(*) FROM WastewaterPlant WHERE State = 'New York';
SELECT AVG(recycling_rate) FROM recycling_rates WHERE year = 2019 AND organization_id IN (SELECT id FROM organizations WHERE sector = 'rural');
SELECT wg.country, SUM(wg.amount) as total_waste FROM waste_generation wg WHERE wg.year = 2021 GROUP BY wg.country;
SELECT COUNT(*) FROM strandings WHERE date >= (SELECT date FROM (SELECT date FROM strandings ORDER BY date DESC LIMIT 1) subquery) - INTERVAL '3 months';
SELECT State, MIN(Employment_Rate) FROM Veterans GROUP BY State;
SELECT SUM(fr.amount) FROM companies c JOIN funding_records fr ON c.company_id = fr.company_id WHERE c.industry = 'Sustainability' GROUP BY c.company_id HAVING COUNT(fr.round_number) >= 3;
SELECT operation_name FROM peacekeeping_operations ORDER BY start_date ASC LIMIT 1;
SELECT d.name FROM dishes d JOIN menus m ON d.menu_id = m.id WHERE d.type = 'Vegetarian' AND m.name = 'Lunch' INTERSECT SELECT d.name FROM dishes d JOIN menus m ON d.menu_id = m.id WHERE d.type = 'Vegetarian' AND m.name = 'Dinner' EXCEPT SELECT d.name FROM dishes d JOIN menus m ON d.menu_id = m.id WHERE d.type = 'Vegetarian' AND m.name = 'Breakfast';
SELECT AVG(end_speed - start_speed) as avg_speed FROM shared_scooters WHERE start_speed > 0 AND end_speed > 0;
SELECT COUNT(*) FROM Patents WHERE Company IN ('Waymo', 'Tesla') AND Patent LIKE '%Autonomous%'
SELECT MIN(EthicalAIBudget.Budget) AS MinBudget FROM EthicalAIBudget INNER JOIN Countries ON EthicalAIBudget.Country = Countries.Country WHERE Countries.Continent = 'Europe';
SELECT AVG(DATEDIFF(end_date, start_date))/365 FROM Defense_Project_Timelines WHERE contractor = 'STU Inc' AND region = 'Africa';
SELECT Platform, MAX(MaxPlayers) as MaxPlayers, GameName FROM GamePlatforms gp JOIN Games g ON gp.GameID = g.GameID GROUP BY Platform;
SELECT AVG(price) FROM menus WHERE menu_type = 'Non-vegetarian' AND carbon_footprint > 5;
SELECT medical_condition, COUNT(*) as num_treatments FROM treatments INNER JOIN clinics ON treatments.clinic_id = clinics.clinic_id WHERE clinics.clinic_name = 'rural health clinic A' AND YEAR(treatment_date) = 2022 GROUP BY medical_condition ORDER BY num_treatments DESC LIMIT 5;
SELECT m.country, AVG(p.production_cost) as avg_cost FROM producers p JOIN materials m ON p.country = m.country WHERE m.type = 'Organic Cotton' GROUP BY m.country;
SELECT filename FROM imagery_archive WHERE field_name IN ('central_field', 'eastern_field');
SELECT MIN(age) FROM players WHERE game_id = 1 AND hours_played_per_week > 20;
SELECT COUNT(*) AS num_festivals FROM festivals WHERE attendees > 50000;